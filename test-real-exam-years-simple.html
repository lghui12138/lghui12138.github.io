<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª çœŸé¢˜å¹´ä»½æ˜¾ç¤ºæµ‹è¯•</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        .year-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        .year-item {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #2196f3;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #2196f3;
            color: white;
        }
        .btn:hover {
            background: #1976d2;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .status.success {
            background: #c8e6c9;
            color: #2e7d32;
        }
        .status.error {
            background: #ffcdd2;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1>ğŸ§ª çœŸé¢˜å¹´ä»½æ˜¾ç¤ºæµ‹è¯•</h1>
            
            <div class="test-section">
                <h3>ğŸ“Š æ•°æ®çŠ¶æ€</h3>
                <p><strong>æ€»é¢˜ç›®æ•°:</strong> {{ totalQuestions }}</p>
                <p><strong>çœŸé¢˜æ¨¡å¼:</strong> {{ isRealExamMode ? 'æ˜¯' : 'å¦' }}</p>
                <p><strong>realExamYearsé•¿åº¦:</strong> {{ realExamYears.length }}</p>
                <p><strong>availableYearsé•¿åº¦:</strong> {{ availableYears.length }}</p>
            </div>

            <div class="test-section">
                <h3>ğŸ“… å¯ç”¨å¹´ä»½ (availableYears)</h3>
                <div v-if="availableYears.length > 0" class="year-list">
                    <div v-for="year in availableYears" :key="year" class="year-item">
                        {{ year }}å¹´
                    </div>
                </div>
                <div v-else class="status error">
                    æ²¡æœ‰æ‰¾åˆ°å¹´ä»½æ•°æ®
                </div>
            </div>

            <div class="test-section">
                <h3>ğŸ“… çœŸé¢˜å¹´ä»½ (realExamYears)</h3>
                <div v-if="realExamYears.length > 0" class="year-list">
                    <div v-for="yearInfo in realExamYears" :key="yearInfo.year" class="year-item">
                        {{ yearInfo.year }}å¹´ ({{ yearInfo.count }}é¢˜)
                    </div>
                </div>
                <div v-else class="status error">
                    æ²¡æœ‰æ‰¾åˆ°çœŸé¢˜å¹´ä»½æ•°æ®
                </div>
            </div>

            <div class="test-section">
                <h3>ğŸ”§ æ“ä½œ</h3>
                <button @click="loadData" class="btn">åŠ è½½çœŸé¢˜æ•°æ®</button>
                <button @click="setRealExamMode" class="btn">è®¾ç½®çœŸé¢˜æ¨¡å¼</button>
                <button @click="showStatus" class="btn">æ˜¾ç¤ºçŠ¶æ€</button>
            </div>

            <div v-if="status" class="status" :class="statusType">
                {{ status }}
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    allQuestions: [],
                    realExamYears: [],
                    isRealExamMode: false,
                    status: '',
                    statusType: 'success'
                }
            },

            computed: {
                totalQuestions() {
                    return this.allQuestions.length;
                },

                availableYears() {
                    // å¦‚æœæ˜¯çœŸé¢˜æ¨¡å¼ï¼Œä½¿ç”¨çœŸé¢˜å¹´ä»½
                    if (this.isRealExamMode && this.realExamYears.length > 0) {
                        return this.realExamYears.map(y => y.year);
                    }
                    
                    // å¦‚æœçœŸé¢˜æ•°æ®å·²åŠ è½½ä½†realExamYearsè¿˜æ²¡è®¾ç½®ï¼Œä»allQuestionsä¸­æå–
                    if (this.isRealExamMode && this.allQuestions.length > 0) {
                        const years = [...new Set(this.allQuestions.map(q => q.year))].sort((a, b) => b - a);
                        return years;
                    }
                    
                    return [];
                }
            },

            methods: {
                async loadData() {
                    try {
                        this.status = 'æ­£åœ¨åŠ è½½çœŸé¢˜æ•°æ®...';
                        this.statusType = 'success';
                        
                        const response = await fetch('question-banks/çœŸé¢˜_ä¸­å›½æµ·æ´‹å¤§å­¦_2000-2021_cleaned.json');
                        if (!response.ok) {
                            throw new Error('çœŸé¢˜æ–‡ä»¶åŠ è½½å¤±è´¥');
                        }
                        
                        this.allQuestions = await response.json();
                        this.realExamYears = this.getRealExamYears(this.allQuestions);
                        
                        this.status = `âœ… æ•°æ®åŠ è½½æˆåŠŸ: ${this.allQuestions.length}é¢˜ï¼Œ${this.realExamYears.length}ä¸ªå¹´ä»½`;
                        this.statusType = 'success';
                        
                    } catch (error) {
                        this.status = `âŒ åŠ è½½å¤±è´¥: ${error.message}`;
                        this.statusType = 'error';
                        console.error('åŠ è½½å¤±è´¥:', error);
                    }
                },

                getRealExamYears(questions) {
                    const years = [...new Set(questions.map(q => q.year))].sort((a, b) => b - a);
                    return years.map(year => ({
                        year,
                        count: questions.filter(q => q.year === year).length,
                        label: `${year}å¹´ (${questions.filter(q => q.year === year).length}é¢˜)`
                    }));
                },

                setRealExamMode() {
                    this.isRealExamMode = true;
                    this.status = 'âœ… å·²è®¾ç½®çœŸé¢˜æ¨¡å¼';
                    this.statusType = 'success';
                },

                showStatus() {
                    console.log('å½“å‰çŠ¶æ€:', {
                        totalQuestions: this.totalQuestions,
                        isRealExamMode: this.isRealExamMode,
                        realExamYears: this.realExamYears,
                        availableYears: this.availableYears
                    });
                    this.status = 'ğŸ“Š çŠ¶æ€å·²è¾“å‡ºåˆ°æ§åˆ¶å°';
                    this.statusType = 'success';
                }
            },

            mounted() {
                this.loadData();
            }
        }).mount('#app');
    </script>
</body>
</html> 