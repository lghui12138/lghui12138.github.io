<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>❓ 题库练习 - 流体力学海洋</title>
    
    <!-- 自动重定向到新版智能题库 -->
    <script>
        // 立即重定向到带有AI功能的新版题库
        window.location.replace('./practice-dynamic.html');
    </script>
    
    <!-- Font Awesome -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- 模块化样式 -->
    <link rel="stylesheet" href="question-bank-styles.css">
</head>
<body>
    <!-- 显示重定向信息，防止脚本失败 -->
    <div style="text-align: center; padding: 50px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
        <h2>🔄 页面升级中...</h2>
        <p>正在跳转到新版智能题库系统...</p>
        <p>如果页面没有自动跳转，请<a href="./practice-dynamic.html" style="color: #4dabf7;">点击这里</a></p>
    </div>
    <!-- 海洋背景 -->
    <div class="ocean-bg">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <!-- 导航栏 -->
    <nav class="nav-bar">
        <div class="nav-container">
            <a href="#" class="nav-brand">
                <i class="fas fa-question-circle"></i>
                题库练习
            </a>
            <a href="../index-modular.html" class="btn-back">
                <i class="fas fa-arrow-left"></i>
                返回主页
            </a>
        </div>
    </nav>

    <!-- 主要内容 -->
    <div class="main-content">
        <!-- 统计面板 -->
        <div id="questionBankStats" class="stats-panel" style="text-align:center;">
            <h2>🎯 学习统计</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalQuestions">0</div>
                    <div class="stat-label">总题数</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completedQuestions">0</div>
                    <div class="stat-label">已完成</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="correctRate">0%</div>
                    <div class="stat-label">正确率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="favoriteCount">0</div>
                    <div class="stat-label">收藏题库</div>
                </div>
            </div>
        </div>

        <!-- 搜索和筛选控制 -->
        <div style="text-align: center; margin: 20px 0;">
            <div style="margin-bottom: 15px;">
                <input id="questionBankSearch" type="text" placeholder="🔍 搜索题库名称/简介/标签" 
                       style="width:320px;padding:8px 16px;border-radius:8px;border:1px solid #ccc;font-size:1.1em;">
            </div>
            
            <div class="filter-buttons">
                <select id="difficultyFilter" style="margin-right:10px;padding:6px 12px;border-radius:6px;border:1px solid #ccc;">
                    <option value="">全部难度</option>
                    <option value="easy">简单</option>
                    <option value="medium">中等</option>
                    <option value="hard">困难</option>
                </select>
                
                <select id="tagFilter" style="margin-right:10px;padding:6px 12px;border-radius:6px;border:1px solid #ccc;">
                    <option value="">全部分类</option>
                </select>
                
                <select id="countFilter" style="margin-right:10px;padding:6px 12px;border-radius:6px;border:1px solid #ccc;">
                    <option value="">题目数量</option>
                    <option value="1-10">1-10题</option>
                    <option value="11-50">11-50题</option>
                    <option value="51-100">51-100题</option>
                    <option value="100+">100题以上</option>
                </select>
                
                <button id="clearFilters" class="btn btn-info">清除筛选</button>
            </div>
            
            <div class="filter-buttons">
                <button id="showFavorites" class="btn btn-danger">⭐ 我的收藏</button>
                <button id="showAll" class="btn btn-primary">📚 全部题库</button>
                <button id="showWrongQuestions" class="btn btn-warning">❌ 错题本</button>
                <button id="manageFavorites" class="btn btn-warning">📋 收藏管理</button>
                <button id="teacherPanel" class="btn" style="background: linear-gradient(135deg, #ff6b6b, #ff8e8e); color: white;" onclick="window.open('../teacher-panel.html', '_blank')" title="教师管理端">👨‍🏫 教师端</button>
                <button id="showHelp" class="btn btn-info" title="快捷键帮助">❓ 帮助</button>
            </div>
        </div>

        <!-- 增强功能卡片 -->
        <div class="enhanced-features">
            <h3 style="text-align: center; margin-bottom: 20px;">🚀 智能学习功能</h3>
            <div class="feature-grid">
                <div class="feature-card" onclick="showSmartSearch()">
                    <div class="feature-icon">🔍</div>
                    <div class="feature-title">智能搜索</div>
                    <div class="feature-desc">AI驱动的智能搜索，支持模糊匹配和语义搜索</div>
                </div>
                <div class="feature-card" onclick="showAdvancedFilters()">
                    <div class="feature-icon">⚙️</div>
                    <div class="feature-title">高级筛选</div>
                    <div class="feature-desc">多维度筛选，精确找到需要的题库</div>
                </div>
                <div class="feature-card" onclick="showStatsPanel()">
                    <div class="feature-icon">📊</div>
                    <div class="feature-title">学习统计</div>
                    <div class="feature-desc">详细的学习数据统计和分析</div>
                </div>
                <div class="feature-card" onclick="showRecommendationPanel()">
                    <div class="feature-icon">🎯</div>
                    <div class="feature-title">智能推荐</div>
                    <div class="feature-desc">基于学习进度智能推荐题库</div>
                </div>
            </div>
        </div>

        <!-- 智能搜索区域 -->
        <div id="smartSearchArea" class="smart-search" style="display: none;">
            <h4>🔍 智能搜索</h4>
            <input type="text" id="smartSearchInput" placeholder="输入关键词进行智能搜索..." 
                   style="width: 100%; padding: 12px; border: 2px solid var(--ocean-light); border-radius: 8px; font-size: 1em;">
            <div id="searchSuggestions" class="search-suggestions"></div>
        </div>

        <!-- 高级筛选区域 -->
        <div id="advancedFiltersArea" class="advanced-filters" style="display: none;">
            <h4>⚙️ 高级筛选</h4>
            <div class="filter-group">
                <div class="filter-item">
                    <label class="filter-label">难度等级</label>
                    <select id="advancedDifficultyFilter" class="filter-select">
                        <option value="">全部难度</option>
                        <option value="easy">简单</option>
                        <option value="medium">中等</option>
                        <option value="hard">困难</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="filter-label">题目类型</label>
                    <select id="advancedTypeFilter" class="filter-select">
                        <option value="">全部类型</option>
                        <option value="choice">选择题</option>
                        <option value="fill">填空题</option>
                        <option value="judge">判断题</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="filter-label">完成状态</label>
                    <select id="advancedStatusFilter" class="filter-select">
                        <option value="">全部状态</option>
                        <option value="completed">已完成</option>
                        <option value="incomplete">未完成</option>
                        <option value="favorite">已收藏</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 学习统计面板 -->
        <div id="statsPanel" class="stats-panel" style="display: none;">
            <h4>📊 详细统计</h4>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalQuestions">0</div>
                    <div class="stat-label">总题数</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completedQuestions">0</div>
                    <div class="stat-label">已完成</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="correctRate">0%</div>
                    <div class="stat-label">正确率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="studyTime">0h</div>
                    <div class="stat-label">学习时长</div>
                </div>
            </div>
        </div>

        <!-- 智能推荐面板 -->
        <div id="recommendationPanel" class="recommendation-panel" style="display: none;">
            <h4>🎯 智能推荐</h4>
            <div id="recommendationContent">
                <p>正在分析您的学习数据，为您推荐合适的题库...</p>
            </div>
        </div>

        <!-- 题库显示区域 -->
        <div id="questionBanksList">
            <div style="text-align: center; color: white; padding: 40px;">
                <div class="loading"></div>
                <p style="margin-top: 20px;">正在加载题库数据...</p>
            </div>
        </div>

        <!-- 分页控制 -->
        <div id="paginationControls" style="text-align: center; margin: 30px 0;"></div>

        <!-- 推导练习题 -->
        <div class="derivation-exercises">
            <div class="section-title">📐 公式推导练习题</div>
            
            <div class="exercise-card">
                <div class="exercise-title">练习1：推导静水压强分布</div>
                <div class="exercise-content">
                    <div class="question">
                        <p><strong>题目：</strong>从流体静力学基本方程 $\nabla p = \rho \vec{g}$ 出发，推导静水压强分布公式 $p = p_0 + \rho g h$。</p>
                    </div>
                    
                    <div class="solution">
                        <div class="solution-title">解答步骤：</div>
                        <div class="solution-steps">
                            <div class="step">步骤1：对于重力场，基本方程简化为</div>
                            <div class="formula">$$\frac{dp}{dz} = -\rho g$$</div>
                            
                            <div class="step">步骤2：积分得到</div>
                            <div class="formula">$$\int dp = -\rho g \int dz$$</div>
                            <div class="formula">$$p - p_0 = -\rho g(z - z_0)$$</div>
                            
                            <div class="step">步骤3：令 $h = z_0 - z$（深度）</div>
                            <div class="formula">$$p = p_0 + \rho g h$$</div>
                        </div>
                        
                        <div class="explanation">
                            <p><strong>物理意义：</strong>静水压强随深度线性增加，斜率为 $\rho g$。</p>
                            <p><strong>应用：</strong>水坝设计、潜水器设计、海洋工程。</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="exercise-card">
                <div class="exercise-title">练习2：推导层流管道速度分布</div>
                <div class="exercise-content">
                    <div class="question">
                        <p><strong>题目：</strong>从Navier-Stokes方程出发，推导圆管内层流的速度分布公式。</p>
                    </div>
                    
                    <div class="solution">
                        <div class="solution-title">解答步骤：</div>
                        <div class="solution-steps">
                            <div class="step">步骤1：对于轴对称流动，Navier-Stokes方程简化为</div>
                            <div class="formula">$$\mu \frac{1}{r} \frac{d}{dr}(r \frac{du}{dr}) = \frac{dp}{dx}$$</div>
                            
                            <div class="step">步骤2：第一次积分</div>
                            <div class="formula">$$r \frac{du}{dr} = \frac{r^2}{2\mu} \frac{dp}{dx} + C_1$$</div>
                            
                            <div class="step">步骤3：边界条件 $r = 0$ 时 $\frac{du}{dr} = 0$</div>
                            <div class="formula">$$C_1 = 0$$</div>
                            
                            <div class="step">步骤4：第二次积分</div>
                            <div class="formula">$$u = \frac{r^2}{4\mu} \frac{dp}{dx} + C_2$$</div>
                            
                            <div class="step">步骤5：边界条件 $r = R$ 时 $u = 0$</div>
                            <div class="formula">$$u(r) = \frac{R^2}{4\mu}(-\frac{dp}{dx})(1 - \frac{r^2}{R^2})$$</div>
                        </div>
                        
                        <div class="explanation">
                            <p><strong>物理意义：</strong>层流管道速度分布呈抛物线，中心速度最大。</p>
                            <p><strong>应用：</strong>管道流动分析、流量计算。</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="exercise-card">
                <div class="exercise-title">练习3：推导伯努利方程</div>
                <div class="exercise-content">
                    <div class="question">
                        <p><strong>题目：</strong>从欧拉方程出发，推导伯努利方程。</p>
                    </div>
                    
                    <div class="solution">
                        <div class="solution-title">解答步骤：</div>
                        <div class="solution-steps">
                            <div class="step">步骤1：欧拉方程</div>
                            <div class="formula">$$\frac{\partial \vec{v}}{\partial t} + (\vec{v} \cdot \nabla)\vec{v} = -\frac{1}{\rho}\nabla p + \vec{g}$$</div>
                            
                            <div class="step">步骤2：对于定常流动</div>
                            <div class="formula">$$\frac{\partial \vec{v}}{\partial t} = 0$$</div>
                            
                            <div class="step">步骤3：沿流线积分</div>
                            <div class="formula">$$\int [(\vec{v} \cdot \nabla)\vec{v}] \cdot d\vec{s} = \int [-\frac{1}{\rho}\nabla p + \vec{g}] \cdot d\vec{s}$$</div>
                            
                            <div class="step">步骤4：利用向量恒等式</div>
                            <div class="formula">$$(\vec{v} \cdot \nabla)\vec{v} = \nabla(\frac{v^2}{2}) - \vec{v} \times (\nabla \times \vec{v})$$</div>
                            
                            <div class="step">步骤5：对于无旋流动</div>
                            <div class="formula">$$\nabla \times \vec{v} = 0$$</div>
                            
                            <div class="step">步骤6：积分得到伯努利方程</div>
                            <div class="formula">$$\frac{v^2}{2} + \frac{p}{\rho} + gz = 常数$$</div>
                        </div>
                        
                        <div class="explanation">
                            <p><strong>物理意义：</strong>沿流线机械能守恒，总水头保持不变。</p>
                            <p><strong>应用：</strong>文丘里管、机翼升力、管道流动。</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="exercise-card">
                <div class="exercise-title">练习4：推导边界层厚度</div>
                <div class="exercise-content">
                    <div class="question">
                        <p><strong>题目：</strong>推导平板边界层厚度公式 $\delta(x) = 5.0\sqrt{\frac{\nu x}{U_\infty}}$。</p>
                    </div>
                    
                    <div class="solution">
                        <div class="solution-title">解答步骤：</div>
                        <div class="solution-steps">
                            <div class="step">步骤1：边界层厚度定义为 $u = 0.99U_\infty$ 时的 $y$ 值</div>
                            
                            <div class="step">步骤2：对于平板边界层，相似性解给出</div>
                            <div class="formula">$$\eta = y\sqrt{\frac{U_\infty}{\nu x}}$$</div>
                            
                            <div class="step">步骤3：当 $\eta = 5.0$ 时，$u = 0.99U_\infty$</div>
                            
                            <div class="step">步骤4：因此边界层厚度为</div>
                            <div class="formula">$$\delta(x) = 5.0\sqrt{\frac{\nu x}{U_\infty}}$$</div>
                        </div>
                        
                        <div class="explanation">
                            <p><strong>物理意义：</strong>边界层厚度随距离的平方根增长，与来流速度的平方根成反比。</p>
                            <p><strong>应用：</strong>机翼设计、壁面效应分析。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 实际应用题目 -->
        <div class="application-exercises">
            <div class="section-title">🔧 实际应用题目</div>
            
            <div class="exercise-card">
                <div class="exercise-title">应用1：管道流动计算</div>
                <div class="exercise-content">
                    <div class="question">
                        <p><strong>题目：</strong>已知圆管直径 $D = 0.02 \text{ m}$，长度 $L = 10 \text{ m}$，粘性系数 $\mu = 0.001 \text{ Pa·s}$，压力差 $\Delta p = 1000 \text{ Pa}$。计算层流流量和平均速度。</p>
                    </div>
                    
                    <div class="solution">
                        <div class="solution-title">解答：</div>
                        <div class="solution-steps">
                            <div class="step">步骤1：计算半径</div>
                            <div class="formula">$$R = \frac{D}{2} = 0.01 \text{ m}$$</div>
                            
                            <div class="step">步骤2：计算压力梯度</div>
                            <div class="formula">$$-\frac{dp}{dx} = \frac{\Delta p}{L} = \frac{1000}{10} = 100 \text{ Pa/m}$$</div>
                            
                            <div class="step">步骤3：使用哈根-泊肃叶定律计算流量</div>
                            <div class="formula">$$Q = \frac{\pi R^4}{8\mu}(-\frac{dp}{dx}) = \frac{\pi \times 0.01^4}{8 \times 0.001} \times 100 = 3.93 \times 10^{-6} \text{ m}^3/\text{s}$$</div>
                            
                            <div class="step">步骤4：计算平均速度</div>
                            <div class="formula">$$\bar{u} = \frac{Q}{\pi R^2} = \frac{3.93 \times 10^{-6}}{\pi \times 0.01^2} = 0.0125 \text{ m/s}$$</div>
                        </div>
                        
                        <div class="explanation">
                            <p><strong>结果：</strong>流量为3.93 mL/s，平均速度为1.25 cm/s。</p>
                            <p><strong>验证：</strong>这种低流速确保了层流状态。</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="exercise-card">
                <div class="exercise-title">应用2：文丘里管流量测量</div>
                <div class="exercise-content">
                    <div class="question">
                        <p><strong>题目：</strong>文丘里管入口直径 $D_1 = 0.1 \text{ m}$，喉部直径 $D_2 = 0.05 \text{ m}$，入口速度 $v_1 = 2 \text{ m/s}$，入口压力 $p_1 = 100 \text{ kPa}$。计算喉部压力和流量。</p>
                    </div>
                    
                    <div class="solution">
                        <div class="solution-title">解答：</div>
                        <div class="solution-steps">
                            <div class="step">步骤1：计算面积比</div>
                            <div class="formula">$$\frac{A_1}{A_2} = \frac{D_1^2}{D_2^2} = \frac{0.1^2}{0.05^2} = 4$$</div>
                            
                            <div class="step">步骤2：连续性方程</div>
                            <div class="formula">$$A_1v_1 = A_2v_2$$</div>
                            <div class="formula">$$v_2 = \frac{A_1}{A_2}v_1 = 4 \times 2 = 8 \text{ m/s}$$</div>
                            
                            <div class="step">步骤3：伯努利方程</div>
                            <div class="formula">$$\frac{v_1^2}{2g} + \frac{p_1}{\rho g} = \frac{v_2^2}{2g} + \frac{p_2}{\rho g}$$</div>
                            
                            <div class="step">步骤4：计算喉部压力</div>
                            <div class="formula">$$\frac{p_2}{\rho g} = \frac{p_1}{\rho g} + \frac{v_1^2 - v_2^2}{2g}$$</div>
                            <div class="formula">$$p_2 = p_1 + \frac{\rho(v_1^2 - v_2^2)}{2} = 100 + \frac{1000(4 - 64)}{2} = 70 \text{ kPa}$$</div>
                            
                            <div class="step">步骤5：计算流量</div>
                            <div class="formula">$$Q = A_1v_1 = \pi \times 0.05^2 \times 2 = 0.0157 \text{ m}^3/\text{s}$$</div>
                        </div>
                        
                        <div class="explanation">
                            <p><strong>结果：</strong>喉部压力为70 kPa，流量为15.7 L/s。</p>
                            <p><strong>伯努利效应：</strong>流速增加，压力降低。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 通知容器 -->
    <div id="notification-container" style="position: fixed; top: 20px; right: 20px; z-index: 1000;"></div>

    <!-- 模块化JavaScript -->
    <script src="question-bank-data.js"></script>
    <script src="question-bank-ui.js"></script>
    <script src="question-bank-user.js"></script>
    <script src="question-bank-stats.js"></script>
    <script src="question-bank-practice.js"></script>
    <script src="question-bank-ai.js"></script>
    
    <!-- 主初始化脚本 -->
    <script>
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // 初始化各个模块
                if (typeof QuestionBankData !== 'undefined') {
                    QuestionBankData.init();
                }
                if (typeof QuestionBankUI !== 'undefined') {
                    QuestionBankUI.init();
                }
                if (typeof QuestionBankUser !== 'undefined') {
                    QuestionBankUser.init();
                }
                if (typeof QuestionBankStats !== 'undefined') {
                    QuestionBankStats.init();
                }
                
                console.log('题库模块初始化完成');
            } catch (error) {
                console.error('题库模块初始化失败:', error);
                showNotification('题库加载失败，请刷新页面重试', 'error');
            }
        });
        
        // 基础函数
        function showNotification(message, type = 'info', duration = 3000) {
            const container = document.getElementById('notification-container');
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, duration);
        }
        
        // 功能面板显示/隐藏
        function showSmartSearch() {
            const area = document.getElementById('smartSearchArea');
            area.style.display = area.style.display === 'none' ? 'block' : 'none';
        }
        
        function showAdvancedFilters() {
            const area = document.getElementById('advancedFiltersArea');
            area.style.display = area.style.display === 'none' ? 'block' : 'none';
        }
        
        function showStatsPanel() {
            const panel = document.getElementById('statsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            if (panel.style.display === 'block' && typeof QuestionBankStats !== 'undefined') {
                QuestionBankStats.updateStats();
            }
        }
        
        function showRecommendationPanel() {
            const panel = document.getElementById('recommendationPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }
    </script>
</body>
</html> 