<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ è€ƒè¯•æ¨¡æ‹Ÿ - æµä½“åŠ›å­¦å­¦ä¹ å¹³å°</title>
    
    <!-- å¤–éƒ¨ä¾èµ– -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- å…±äº«ç»„ä»¶åº“ -->
    <script src="../js/shared-components.js"></script>
    
    <style>
        body {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            margin: 0;
            font-family: 'SF Pro Display', sans-serif;
            color: white;
        }

        .exam-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .exam-setup {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            color: #333;
            text-align: center;
        }

        .setup-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .setup-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .setup-card:hover, .setup-card.selected {
            border-color: #e74c3c;
            background: #ffeaea;
            transform: translateY(-5px);
        }

        .exam-paper {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            color: #333;
        }

        .exam-header {
            text-align: center;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }

        .exam-timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #e74c3c;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
            z-index: 1000;
        }

        .question-counter {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            color: #333;
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .question-item {
            background: #f8f9fa;
            border-left: 5px solid #e74c3c;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .question-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 25px;
            color: #2c3e50;
        }

        .option-grid {
            display: grid;
            gap: 15px;
        }

        .option-item {
            background: white;
            border: 3px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option-item:hover {
            border-color: #e74c3c;
            background: #ffeaea;
        }

        .option-item.selected {
            border-color: #e74c3c;
            background: linear-gradient(135deg, #ffeaea, #ffd6d6);
            color: #c0392b;
            font-weight: bold;
        }

        .option-label {
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
            line-height: 1.6;
        }

        .exam-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 1000;
        }

        .control-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }

        .control-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .nav-item {
            aspect-ratio: 1;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            border-color: #e74c3c;
        }

        .nav-item.answered {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .nav-item.current {
            background: #e74c3c;
            border-color: #c0392b;
            color: white;
        }

        .exam-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            color: #856404;
            text-align: center;
        }

        .time-warning {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }

        .exam-result {
            text-align: center;
            padding: 60px 40px;
        }

        .result-score {
            font-size: 4em;
            font-weight: bold;
            margin: 30px 0;
        }

        .result-grade {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .result-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .setup-option {
            margin: 10px 0;
        }

        .setup-label {
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .setup-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="examApp">
        <!-- æµ·æ´‹èƒŒæ™¯ -->
        <ocean-background></ocean-background>

        <!-- é€šçŸ¥ç»„ä»¶ -->
        <notification-component :notification="notification" @close="notification = ''"></notification-component>

        <!-- åŠ è½½åŠ¨ç”» -->
        <loading-spinner :show="loading" text="æ­£åœ¨ç”Ÿæˆè¯•å·..."></loading-spinner>

        <div class="exam-container" v-if="!loading">
            <!-- è€ƒè¯•è®¾ç½®é¡µé¢ -->
            <div v-if="examState === 'setup'" class="exam-setup">
                <h1><i class="fas fa-clipboard-check"></i> è€ƒè¯•æ¨¡æ‹Ÿè®¾ç½®</h1>
                <p>é…ç½®æ‚¨çš„æ¨¡æ‹Ÿè€ƒè¯•å‚æ•°</p>

                <div class="setup-grid">
                    <div 
                        v-for="mode in examModes" 
                        :key="mode.id"
                        class="setup-card"
                        :class="{ selected: selectedMode === mode.id }"
                        @click="selectedMode = mode.id"
                    >
                        <div style="font-size: 3em; margin-bottom: 15px;">{{ mode.icon }}</div>
                        <h3>{{ mode.name }}</h3>
                        <p>{{ mode.description }}</p>
                        <div style="margin-top: 15px; font-weight: bold; color: #e74c3c;">
                            {{ mode.questions }}é¢˜ Â· {{ mode.duration }}åˆ†é’Ÿ
                        </div>
                    </div>
                </div>

                <div class="setup-option">
                    <label class="setup-label">é¢˜ç›®ç±»å‹ï¼š</label>
                    <select v-model="examSettings.questionType" class="setup-select">
                        <option value="mixed">ç»¼åˆé¢˜å‹</option>
                        <option value="basic">åŸºç¡€æ¦‚å¿µ</option>
                        <option value="calculation">è®¡ç®—åº”ç”¨</option>
                        <option value="analysis">åˆ†æè®ºè¿°</option>
                    </select>
                </div>

                <div class="setup-option">
                    <label class="setup-label">éš¾åº¦ç­‰çº§ï¼š</label>
                    <select v-model="examSettings.difficulty" class="setup-select">
                        <option value="easy">ç®€å•</option>
                        <option value="medium">ä¸­ç­‰</option>
                        <option value="hard">å›°éš¾</option>
                        <option value="mixed">æ··åˆéš¾åº¦</option>
                    </select>
                </div>

                <button class="control-btn" @click="startExam" :disabled="!selectedMode">
                    <i class="fas fa-play"></i> å¼€å§‹è€ƒè¯•
                </button>
            </div>

            <!-- è€ƒè¯•è¿›è¡Œä¸­ -->
            <div v-if="examState === 'inProgress'">
                <!-- è®¡æ—¶å™¨ -->
                <div class="exam-timer" :class="{ 'time-warning': timeRemaining <= 300 }">
                    <i class="fas fa-clock"></i> {{ formatTime(timeRemaining) }}
                </div>

                <!-- é¢˜ç›®è®¡æ•°å™¨ -->
                <div class="question-counter">
                    é¢˜ç›® {{ currentQuestionIndex + 1 }} / {{ examQuestions.length }}
                </div>

                <!-- æ—¶é—´è­¦å‘Š -->
                <div v-if="timeRemaining <= 300" class="exam-warning time-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>æ—¶é—´è­¦å‘Šï¼š</strong>è€ƒè¯•æ—¶é—´è¿˜å‰© {{ Math.floor(timeRemaining / 60) }} åˆ†é’Ÿï¼Œè¯·æŠ“ç´§æ—¶é—´å®Œæˆç­”é¢˜ï¼
                </div>

                <div class="exam-paper">
                    <div class="exam-header">
                        <h1>æµä½“åŠ›å­¦æ¨¡æ‹Ÿè€ƒè¯•</h1>
                        <p>{{ getCurrentModeInfo().name }} | å…± {{ examQuestions.length }} é¢˜</p>
                        <div class="exam-warning">
                            <i class="fas fa-info-circle"></i>
                            <strong>è€ƒè¯•è¯´æ˜ï¼š</strong>è¯·è®¤çœŸä½œç­”ï¼Œè€ƒè¯•æœŸé—´ä¸å…è®¸åˆ‡æ¢çª—å£ã€‚æ—¶é—´åˆ°è‡ªåŠ¨æäº¤ã€‚
                        </div>
                    </div>

                    <!-- é¢˜ç›®å¯¼èˆª -->
                    <div class="nav-grid">
                        <div 
                            v-for="(question, index) in examQuestions"
                            :key="index"
                            class="nav-item"
                            :class="{
                                answered: answers[index] !== null,
                                current: currentQuestionIndex === index
                            }"
                            @click="jumpToQuestion(index)"
                        >
                            {{ index + 1 }}
                        </div>
                    </div>

                    <!-- å½“å‰é¢˜ç›® -->
                    <div v-if="currentQuestion" class="question-item">
                        <div class="question-title">
                            {{ currentQuestionIndex + 1 }}. {{ currentQuestion.title }}
                        </div>
                        
                        <div class="option-grid">
                            <div 
                                v-for="(option, index) in currentQuestion.options"
                                :key="index"
                                class="option-item"
                                :class="{ selected: answers[currentQuestionIndex] === index }"
                                @click="selectAnswer(index)"
                            >
                                <div class="option-label">{{ String.fromCharCode(65 + index) }}</div>
                                <div class="option-text">{{ option }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è€ƒè¯•æ§åˆ¶æŒ‰é’® -->
                <div class="exam-controls">
                    <button 
                        class="control-btn" 
                        @click="previousQuestion"
                        :disabled="currentQuestionIndex === 0"
                    >
                        <i class="fas fa-chevron-left"></i> ä¸Šä¸€é¢˜
                    </button>
                    
                    <button class="control-btn" @click="submitExam">
                        <i class="fas fa-paper-plane"></i> æäº¤è¯•å·
                    </button>
                    
                    <button 
                        class="control-btn" 
                        @click="nextQuestion"
                        :disabled="currentQuestionIndex === examQuestions.length - 1"
                    >
                        ä¸‹ä¸€é¢˜ <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <!-- è€ƒè¯•ç»“æœ -->
            <div v-if="examState === 'completed'" class="exam-paper">
                <div class="exam-result">
                    <h1><i class="fas fa-trophy"></i> è€ƒè¯•å®Œæˆ</h1>
                    
                    <div class="result-score" :style="{ color: getGradeColor(examResult.score) }">
                        {{ examResult.score }}åˆ†
                    </div>
                    
                    <div class="result-grade" :style="{ color: getGradeColor(examResult.score) }">
                        {{ getGradeText(examResult.score) }}
                    </div>
                    
                    <div class="result-details">
                        <div class="result-item">
                            <div style="font-size: 2em; color: #28a745;">{{ examResult.correct }}</div>
                            <div>ç­”å¯¹é¢˜æ•°</div>
                        </div>
                        <div class="result-item">
                            <div style="font-size: 2em; color: #dc3545;">{{ examResult.wrong }}</div>
                            <div>ç­”é”™é¢˜æ•°</div>
                        </div>
                        <div class="result-item">
                            <div style="font-size: 2em; color: #6c757d;">{{ examResult.unanswered }}</div>
                            <div>æœªç­”é¢˜æ•°</div>
                        </div>
                        <div class="result-item">
                            <div style="font-size: 2em; color: #007bff;">{{ examResult.timeUsed }}</div>
                            <div>ç”¨æ—¶(åˆ†é’Ÿ)</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px;">
                        <button class="control-btn" @click="reviewAnswers">
                            <i class="fas fa-eye"></i> æŸ¥çœ‹è§£æ
                        </button>
                        <button class="control-btn" @click="restartExam" style="background: #28a745;">
                            <i class="fas fa-redo"></i> é‡æ–°è€ƒè¯•
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            mixins: [SharedMixin],
            components: {
                'ocean-background': OceanBackground,
                'notification-component': NotificationComponent,
                'loading-spinner': LoadingSpinner
            },
            data() {
                return {
                    examState: 'setup', // setup, inProgress, completed
                    selectedMode: null,
                    currentQuestionIndex: 0,
                    answers: [],
                    timeRemaining: 0,
                    examStartTime: null,
                    examTimer: null,
                    examModes: [
                        {
                            id: 'quick',
                            name: 'å¿«é€Ÿæµ‹è¯•',
                            description: 'é€‚åˆæ—¥å¸¸ç»ƒä¹ å’ŒçŸ¥è¯†ç‚¹æ£€æµ‹',
                            questions: 10,
                            duration: 15,
                            icon: 'âš¡'
                        },
                        {
                            id: 'standard',
                            name: 'æ ‡å‡†è€ƒè¯•',
                            description: 'æ¨¡æ‹ŸçœŸå®è€ƒè¯•ç¯å¢ƒå’Œéš¾åº¦',
                            questions: 30,
                            duration: 45,
                            icon: 'ğŸ“'
                        },
                        {
                            id: 'comprehensive',
                            name: 'ç»¼åˆæµ‹è¯„',
                            description: 'å…¨é¢æ£€æµ‹å­¦ä¹ æˆæœå’ŒçŸ¥è¯†æŒæ¡',
                            questions: 50,
                            duration: 75,
                            icon: 'ğŸ¯'
                        },
                        {
                            id: 'final',
                            name: 'æœŸæœ«æ¨¡æ‹Ÿ',
                            description: 'æœŸæœ«è€ƒè¯•æ ‡å‡†ï¼Œä¸¥æ ¼è®¡æ—¶',
                            questions: 80,
                            duration: 120,
                            icon: 'ğŸ†'
                        }
                    ],
                    examSettings: {
                        questionType: 'mixed',
                        difficulty: 'medium'
                    },
                    examQuestions: [],
                    examResult: {}
                }
            },
            computed: {
                currentQuestion() {
                    return this.examQuestions[this.currentQuestionIndex];
                }
            },
            methods: {
                startExam() {
                    if (!this.selectedMode) return;
                    
                    this.setLoading(true);
                    
                    setTimeout(() => {
                        this.generateExamQuestions();
                        this.initializeExam();
                        this.setLoading(false);
                        this.examState = 'inProgress';
                        this.showNotification('è€ƒè¯•å¼€å§‹ï¼è¯·è®¤çœŸä½œç­”', 'success');
                    }, 2000);
                },
                
                generateExamQuestions() {
                    const mode = this.examModes.find(m => m.id === this.selectedMode);
                    const questionCount = mode.questions;
                    
                    // åŸºç¡€é¢˜åº“
                    const baseQuestions = [
                        {
                            title: "æµä½“é™åŠ›å­¦ä¸­ï¼Œé™æ­¢æµä½“å†…éƒ¨ä»»æ„ä¸€ç‚¹çš„å‹å¼ºå¤§å°",
                            options: [
                                "ä¸è¯¥ç‚¹æ‰€åœ¨æ·±åº¦æˆæ­£æ¯”",
                                "ä¸è¯¥ç‚¹æ‰€åœ¨æ·±åº¦æˆåæ¯”", 
                                "ä¸æµä½“å¯†åº¦æ— å…³",
                                "åªå–å†³äºå¤§æ°”å‹å¼º"
                            ],
                            answer: 0,
                            explanation: "æ ¹æ®æµä½“é™åŠ›å­¦åŸºæœ¬æ–¹ç¨‹ï¼Œé™æ­¢æµä½“å†…éƒ¨å‹å¼ºéšæ·±åº¦çº¿æ€§å¢åŠ ã€‚"
                        },
                        {
                            title: "ç†æƒ³æµä½“çš„ç‰¹å¾åŒ…æ‹¬",
                            options: [
                                "æœ‰ç²˜æ€§ã€ä¸å¯å‹ç¼©",
                                "æ— ç²˜æ€§ã€å¯å‹ç¼©",
                                "æ— ç²˜æ€§ã€ä¸å¯å‹ç¼©", 
                                "æœ‰ç²˜æ€§ã€å¯å‹ç¼©"
                            ],
                            answer: 2,
                            explanation: "ç†æƒ³æµä½“æ˜¯æ— ç²˜æ€§ã€ä¸å¯å‹ç¼©çš„ç†è®ºæµä½“ã€‚"
                        },
                        {
                            title: "è¿ç»­æ€§æ–¹ç¨‹çš„ç‰©ç†æ„ä¹‰æ˜¯",
                            options: [
                                "èƒ½é‡å®ˆæ’",
                                "åŠ¨é‡å®ˆæ’",
                                "è´¨é‡å®ˆæ’",
                                "è§’åŠ¨é‡å®ˆæ’"
                            ],
                            answer: 2,
                            explanation: "è¿ç»­æ€§æ–¹ç¨‹åæ˜ äº†æµä½“æµåŠ¨è¿‡ç¨‹ä¸­è´¨é‡å®ˆæ’çš„åŸºæœ¬åŸç†ã€‚"
                        },
                        {
                            title: "ä¼¯åŠªåˆ©æ–¹ç¨‹é€‚ç”¨äº",
                            options: [
                                "ä»»æ„æµä½“çš„æµåŠ¨",
                                "ç†æƒ³æµä½“çš„å®šå¸¸æµåŠ¨",
                                "ç²˜æ€§æµä½“çš„éå®šå¸¸æµåŠ¨",
                                "å¯å‹ç¼©æµä½“çš„æµåŠ¨"
                            ],
                            answer: 1,
                            explanation: "ä¼¯åŠªåˆ©æ–¹ç¨‹é€‚ç”¨äºç†æƒ³æµä½“çš„å®šå¸¸æµåŠ¨ã€‚"
                        },
                        {
                            title: "é›·è¯ºæ•°çš„ç‰©ç†æ„ä¹‰æ˜¯è¡¨ç¤º",
                            options: [
                                "æµä½“çš„å¯†åº¦",
                                "æµä½“çš„ç²˜åº¦", 
                                "æƒ¯æ€§åŠ›ä¸ç²˜æ€§åŠ›çš„æ¯”å€¼",
                                "å‹åŠ›ä¸é€Ÿåº¦çš„å…³ç³»"
                            ],
                            answer: 2,
                            explanation: "é›·è¯ºæ•°è¡¨ç¤ºæƒ¯æ€§åŠ›ä¸ç²˜æ€§åŠ›çš„æ¯”å€¼ï¼Œç”¨äºåˆ¤æ–­æµåŠ¨çŠ¶æ€ã€‚"
                        }
                    ];
                    
                    // æ ¹æ®é¢˜ç›®æ•°é‡ç”Ÿæˆè¯•å·
                    this.examQuestions = [];
                    for (let i = 0; i < questionCount; i++) {
                        const questionIndex = i % baseQuestions.length;
                        const question = { ...baseQuestions[questionIndex] };
                        question.id = i + 1;
                        this.examQuestions.push(question);
                    }
                    
                    // åˆå§‹åŒ–ç­”æ¡ˆæ•°ç»„
                    this.answers = new Array(questionCount).fill(null);
                },
                
                initializeExam() {
                    const mode = this.examModes.find(m => m.id === this.selectedMode);
                    this.timeRemaining = mode.duration * 60; // è½¬æ¢ä¸ºç§’
                    this.examStartTime = Date.now();
                    this.currentQuestionIndex = 0;
                    
                    // å¼€å§‹è®¡æ—¶
                    this.examTimer = setInterval(() => {
                        this.timeRemaining--;
                        if (this.timeRemaining <= 0) {
                            this.submitExam(true); // è‡ªåŠ¨æäº¤
                        }
                    }, 1000);
                },
                
                selectAnswer(optionIndex) {
                    this.$set(this.answers, this.currentQuestionIndex, optionIndex);
                },
                
                jumpToQuestion(index) {
                    this.currentQuestionIndex = index;
                },
                
                nextQuestion() {
                    if (this.currentQuestionIndex < this.examQuestions.length - 1) {
                        this.currentQuestionIndex++;
                    }
                },
                
                previousQuestion() {
                    if (this.currentQuestionIndex > 0) {
                        this.currentQuestionIndex--;
                    }
                },
                
                submitExam(autoSubmit = false) {
                    if (!autoSubmit) {
                        const unanswered = this.answers.filter(a => a === null).length;
                        if (unanswered > 0) {
                            if (!confirm(`è¿˜æœ‰ ${unanswered} é¢˜æœªä½œç­”ï¼Œç¡®å®šè¦æäº¤å—ï¼Ÿ`)) {
                                return;
                            }
                        } else {
                            if (!confirm('ç¡®å®šè¦æäº¤è¯•å·å—ï¼Ÿæäº¤åæ— æ³•ä¿®æ”¹ã€‚')) {
                                return;
                            }
                        }
                    }
                    
                    // åœæ­¢è®¡æ—¶
                    if (this.examTimer) {
                        clearInterval(this.examTimer);
                        this.examTimer = null;
                    }
                    
                    // è®¡ç®—æˆç»©
                    this.calculateResult();
                    this.examState = 'completed';
                    
                    const message = autoSubmit ? 'æ—¶é—´åˆ°ï¼Œè¯•å·å·²è‡ªåŠ¨æäº¤ï¼' : 'è¯•å·æäº¤æˆåŠŸï¼';
                    this.showNotification(message, 'success');
                },
                
                calculateResult() {
                    let correct = 0;
                    let wrong = 0;
                    let unanswered = 0;
                    
                    this.answers.forEach((answer, index) => {
                        if (answer === null) {
                            unanswered++;
                        } else if (answer === this.examQuestions[index].answer) {
                            correct++;
                        } else {
                            wrong++;
                        }
                    });
                    
                    const score = Math.round((correct / this.examQuestions.length) * 100);
                    const timeUsed = Math.round((Date.now() - this.examStartTime) / 60000);
                    
                    this.examResult = {
                        score,
                        correct,
                        wrong,
                        unanswered,
                        timeUsed,
                        total: this.examQuestions.length
                    };
                    
                    // ä¿å­˜æˆç»©
                    this.saveResult();
                },
                
                saveResult() {
                    const results = this.loadFromStorage('examResults', []);
                    results.unshift({
                        ...this.examResult,
                        mode: this.selectedMode,
                        date: new Date().toISOString(),
                        settings: this.examSettings
                    });
                    this.saveToStorage('examResults', results);
                },
                
                getGradeColor(score) {
                    if (score >= 90) return '#28a745';
                    if (score >= 80) return '#007bff';
                    if (score >= 70) return '#ffc107';
                    if (score >= 60) return '#fd7e14';
                    return '#dc3545';
                },
                
                getGradeText(score) {
                    if (score >= 90) return 'ä¼˜ç§€';
                    if (score >= 80) return 'è‰¯å¥½';
                    if (score >= 70) return 'ä¸­ç­‰';
                    if (score >= 60) return 'åŠæ ¼';
                    return 'ä¸åŠæ ¼';
                },
                
                getCurrentModeInfo() {
                    return this.examModes.find(m => m.id === this.selectedMode) || {};
                },
                
                reviewAnswers() {
                    this.showNotification('ç­”æ¡ˆè§£æåŠŸèƒ½å¼€å‘ä¸­...', 'info');
                },
                
                restartExam() {
                    this.examState = 'setup';
                    this.selectedMode = null;
                    this.currentQuestionIndex = 0;
                    this.answers = [];
                    this.timeRemaining = 0;
                    this.examQuestions = [];
                    this.examResult = {};
                    
                    if (this.examTimer) {
                        clearInterval(this.examTimer);
                        this.examTimer = null;
                    }
                }
            },
            
            mounted() {
                console.log('ğŸ“ è€ƒè¯•æ¨¡æ‹Ÿæ¨¡å—å¯åŠ¨ï¼');
                this.setLoading(true);
                
                setTimeout(() => {
                    this.setLoading(false);
                    this.showNotification('è€ƒè¯•ç³»ç»Ÿå‡†å¤‡å°±ç»ªï¼', 'success');
                }, 1000);
            },
            
            beforeUnmount() {
                if (this.examTimer) {
                    clearInterval(this.examTimer);
                }
            }
        }).mount('#examApp');
    </script>
</body>
</html> 