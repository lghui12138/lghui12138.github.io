<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìù ËÄÉËØïÊ®°Êãü - ÊµÅ‰ΩìÂäõÂ≠¶Â≠¶‰π†Âπ≥Âè∞</title>
    
    <!-- Â§ñÈÉ®‰æùËµñ -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- ÂÖ±‰∫´ÁªÑ‰ª∂Â∫ì -->
    <script src="../js/shared-components.js"></script>
    
    <style>
        body {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            margin: 0;
            font-family: 'SF Pro Display', sans-serif;
            color: white;
        }

        .exam-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .exam-setup {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            color: #333;
            text-align: center;
        }

        .setup-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .setup-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .setup-card:hover, .setup-card.selected {
            border-color: #e74c3c;
            background: #ffeaea;
            transform: translateY(-5px);
        }

        .exam-paper {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            color: #333;
        }

        .exam-header {
            text-align: center;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }

        .exam-timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #e74c3c;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
            z-index: 1000;
        }

        .question-counter {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            color: #333;
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .question-item {
            background: #f8f9fa;
            border-left: 5px solid #e74c3c;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .question-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 25px;
            color: #2c3e50;
        }

        .option-grid {
            display: grid;
            gap: 15px;
        }

        .option-item {
            background: white;
            border: 3px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option-item:hover {
            border-color: #e74c3c;
            background: #ffeaea;
        }

        .option-item.selected {
            border-color: #e74c3c;
            background: linear-gradient(135deg, #ffeaea, #ffd6d6);
            color: #c0392b;
            font-weight: bold;
        }

        .option-label {
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
            line-height: 1.6;
        }

        .exam-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 1000;
        }

        .control-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }

        .control-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .nav-item {
            aspect-ratio: 1;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            border-color: #e74c3c;
        }

        .nav-item.answered {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .nav-item.current {
            background: #e74c3c;
            border-color: #c0392b;
            color: white;
        }

        .exam-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            color: #856404;
            text-align: center;
        }

        .time-warning {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }

        .exam-result {
            text-align: center;
            padding: 60px 40px;
        }

        .result-score {
            font-size: 4em;
            font-weight: bold;
            margin: 30px 0;
        }

        .result-grade {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .result-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .setup-option {
            margin: 10px 0;
        }

        .setup-label {
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .setup-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="examApp">
        <!-- Êµ∑Ê¥ãËÉåÊôØ -->
        <ocean-background></ocean-background>

        <!-- ÈÄöÁü•ÁªÑ‰ª∂ -->
        <notification-component :notification="notification" @close="notification = ''"></notification-component>

        <!-- Âä†ËΩΩÂä®Áîª -->
        <loading-spinner :show="loading" text="Ê≠£Âú®ÁîüÊàêËØïÂç∑..."></loading-spinner>

        <div class="exam-container" v-if="!loading">
            <!-- ËÄÉËØïËÆæÁΩÆÈ°µÈù¢ -->
            <div v-if="examState === 'setup'" class="exam-setup">
                <h1><i class="fas fa-clipboard-check"></i> ËÄÉËØïÊ®°ÊãüËÆæÁΩÆ</h1>
                <p>ÈÖçÁΩÆÊÇ®ÁöÑÊ®°ÊãüËÄÉËØïÂèÇÊï∞</p>

                <div class="setup-grid">
                    <div 
                        v-for="mode in examModes" 
                        :key="mode.id"
                        class="setup-card"
                        :class="{ selected: selectedMode === mode.id }"
                        @click="selectedMode = mode.id"
                    >
                        <div style="font-size: 3em; margin-bottom: 15px;">{{ mode.icon }}</div>
                        <h3>{{ mode.name }}</h3>
                        <p>{{ mode.description }}</p>
                        <div style="margin-top: 15px; font-weight: bold; color: #e74c3c;">
                            {{ mode.questions }}È¢ò ¬∑ {{ mode.duration }}ÂàÜÈíü
                        </div>
                    </div>
                </div>

                <div class="setup-option">
                    <label class="setup-label">È¢òÁõÆÁ±ªÂûãÔºö</label>
                    <select v-model="examSettings.questionType" class="setup-select">
                        <option value="mixed">ÁªºÂêàÈ¢òÂûã</option>
                        <option value="basic">Âü∫Á°ÄÊ¶ÇÂøµ</option>
                        <option value="calculation">ËÆ°ÁÆóÂ∫îÁî®</option>
                        <option value="analysis">ÂàÜÊûêËÆ∫Ëø∞</option>
                    </select>
                </div>

                <div class="setup-option">
                    <label class="setup-label">ÈöæÂ∫¶Á≠âÁ∫ßÔºö</label>
                    <select v-model="examSettings.difficulty" class="setup-select">
                        <option value="easy">ÁÆÄÂçï</option>
                        <option value="medium">‰∏≠Á≠â</option>
                        <option value="hard">Âõ∞Èöæ</option>
                        <option value="mixed">Ê∑∑ÂêàÈöæÂ∫¶</option>
                    </select>
                </div>

                <button class="control-btn" @click="startExam" :disabled="!selectedMode">
                    <i class="fas fa-play"></i> ÂºÄÂßãËÄÉËØï
                </button>
            </div>

            <!-- ËÄÉËØïËøõË°å‰∏≠ -->
            <div v-if="examState === 'inProgress'">
                <!-- ËÆ°Êó∂Âô® -->
                <div class="exam-timer" :class="{ 'time-warning': timeRemaining <= 300 }">
                    <i class="fas fa-clock"></i> {{ formatTime(timeRemaining) }}
                </div>

                <!-- È¢òÁõÆËÆ°Êï∞Âô® -->
                <div class="question-counter">
                    È¢òÁõÆ {{ currentQuestionIndex + 1 }} / {{ examQuestions.length }}
                </div>

                <!-- Êó∂Èó¥Ë≠¶Âëä -->
                <div v-if="timeRemaining <= 300" class="exam-warning time-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Êó∂Èó¥Ë≠¶ÂëäÔºö</strong>ËÄÉËØïÊó∂Èó¥ËøòÂâ© {{ Math.floor(timeRemaining / 60) }} ÂàÜÈíüÔºåËØ∑ÊäìÁ¥ßÊó∂Èó¥ÂÆåÊàêÁ≠îÈ¢òÔºÅ
                </div>

                <div class="exam-paper">
                    <div class="exam-header">
                        <h1>ÊµÅ‰ΩìÂäõÂ≠¶Ê®°ÊãüËÄÉËØï</h1>
                        <p>{{ getCurrentModeInfo().name }} | ÂÖ± {{ examQuestions.length }} È¢ò</p>
                        <div class="exam-warning">
                            <i class="fas fa-info-circle"></i>
                            <strong>ËÄÉËØïËØ¥ÊòéÔºö</strong>ËØ∑ËÆ§Áúü‰ΩúÁ≠îÔºåËÄÉËØïÊúüÈó¥‰∏çÂÖÅËÆ∏ÂàáÊç¢Á™óÂè£„ÄÇÊó∂Èó¥Âà∞Ëá™Âä®Êèê‰∫§„ÄÇ
                        </div>
                    </div>

                    <!-- È¢òÁõÆÂØºËà™ -->
                    <div class="nav-grid">
                        <div 
                            v-for="(question, index) in examQuestions"
                            :key="index"
                            class="nav-item"
                            :class="{
                                answered: answers[index] !== null,
                                current: currentQuestionIndex === index
                            }"
                            @click="jumpToQuestion(index)"
                        >
                            {{ index + 1 }}
                        </div>
                    </div>

                    <!-- ÂΩìÂâçÈ¢òÁõÆ -->
                    <div v-if="currentQuestion" class="question-item">
                        <div class="question-title">
                            {{ currentQuestionIndex + 1 }}. {{ currentQuestion.title }}
                        </div>
                        
                        <div class="option-grid">
                            <div 
                                v-for="(option, index) in currentQuestion.options"
                                :key="index"
                                class="option-item"
                                :class="{ selected: answers[currentQuestionIndex] === index }"
                                @click="selectAnswer(index)"
                            >
                                <div class="option-label">{{ String.fromCharCode(65 + index) }}</div>
                                <div class="option-text">{{ option }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ËÄÉËØïÊéßÂà∂ÊåâÈíÆ -->
                <div class="exam-controls">
                    <button 
                        class="control-btn" 
                        @click="previousQuestion"
                        :disabled="currentQuestionIndex === 0"
                    >
                        <i class="fas fa-chevron-left"></i> ‰∏ä‰∏ÄÈ¢ò
                    </button>
                    
                    <button class="control-btn" @click="submitExam">
                        <i class="fas fa-paper-plane"></i> Êèê‰∫§ËØïÂç∑
                    </button>
                    
                    <button 
                        class="control-btn" 
                        @click="nextQuestion"
                        :disabled="currentQuestionIndex === examQuestions.length - 1"
                    >
                        ‰∏ã‰∏ÄÈ¢ò <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <!-- ËÄÉËØïÁªìÊûú -->
            <div v-if="examState === 'completed'" class="exam-paper">
                <div class="exam-result">
                    <h1><i class="fas fa-trophy"></i> ËÄÉËØïÂÆåÊàê</h1>
                    
                    <div class="result-score" :style="{ color: getGradeColor(examResult.score) }">
                        {{ examResult.score }}ÂàÜ
                    </div>
                    
                    <div class="result-grade" :style="{ color: getGradeColor(examResult.score) }">
                        {{ getGradeText(examResult.score) }}
                    </div>
                    
                    <div class="result-details">
                        <div class="result-item">
                            <div style="font-size: 2em; color: #28a745;">{{ examResult.correct }}</div>
                            <div>Á≠îÂØπÈ¢òÊï∞</div>
                        </div>
                        <div class="result-item">
                            <div style="font-size: 2em; color: #dc3545;">{{ examResult.wrong }}</div>
                            <div>Á≠îÈîôÈ¢òÊï∞</div>
                        </div>
                        <div class="result-item">
                            <div style="font-size: 2em; color: #6c757d;">{{ examResult.unanswered }}</div>
                            <div>Êú™Á≠îÈ¢òÊï∞</div>
                        </div>
                        <div class="result-item">
                            <div style="font-size: 2em; color: #007bff;">{{ examResult.timeUsed }}</div>
                            <div>Áî®Êó∂(ÂàÜÈíü)</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px;">
                        <button class="control-btn" @click="reviewAnswers">
                            <i class="fas fa-eye"></i> Êü•ÁúãËß£Êûê
                        </button>
                        <button class="control-btn" @click="restartExam" style="background: #28a745;">
                            <i class="fas fa-redo"></i> ÈáçÊñ∞ËÄÉËØï
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            mixins: [SharedMixin],
            components: {
                'ocean-background': OceanBackground,
                'notification-component': NotificationComponent,
                'loading-spinner': LoadingSpinner
            },
            data() {
                return {
                    examState: 'setup', // setup, inProgress, completed
                    selectedMode: null,
                    currentQuestionIndex: 0,
                    answers: [],
                    timeRemaining: 0,
                    examStartTime: null,
                    examTimer: null,
                    examModes: [
                        {
                            id: 'quick',
                            name: 'Âø´ÈÄüÊµãËØï',
                            description: 'ÈÄÇÂêàÊó•Â∏∏ÁªÉ‰π†ÂíåÁü•ËØÜÁÇπÊ£ÄÊµã',
                            questions: 10,
                            duration: 15,
                            icon: '‚ö°'
                        },
                        {
                            id: 'standard',
                            name: 'Ê†áÂáÜËÄÉËØï',
                            description: 'Ê®°ÊãüÁúüÂÆûËÄÉËØïÁéØÂ¢ÉÂíåÈöæÂ∫¶',
                            questions: 30,
                            duration: 45,
                            icon: 'üìù'
                        },
                        {
                            id: 'comprehensive',
                            name: 'ÁªºÂêàÊµãËØÑ',
                            description: 'ÂÖ®Èù¢Ê£ÄÊµãÂ≠¶‰π†ÊàêÊûúÂíåÁü•ËØÜÊéåÊè°',
                            questions: 50,
                            duration: 75,
                            icon: 'üéØ'
                        },
                        {
                            id: 'final',
                            name: 'ÊúüÊú´Ê®°Êãü',
                            description: 'ÊúüÊú´ËÄÉËØïÊ†áÂáÜÔºå‰∏•Ê†ºËÆ°Êó∂',
                            questions: 80,
                            duration: 120,
                            icon: 'üèÜ'
                        }
                    ],
                    examSettings: {
                        questionType: 'mixed',
                        difficulty: 'medium'
                    },
                    examQuestions: [],
                    examResult: {}
                }
            },
            computed: {
                currentQuestion() {
                    return this.examQuestions[this.currentQuestionIndex];
                }
            },
            methods: {
                startExam() {
                    if (!this.selectedMode) return;
                    
                    this.setLoading(true);
                    
                    setTimeout(() => {
                        this.generateExamQuestions();
                        this.initializeExam();
                        this.setLoading(false);
                        this.examState = 'inProgress';
                        this.showNotification('ËÄÉËØïÂºÄÂßãÔºÅËØ∑ËÆ§Áúü‰ΩúÁ≠î', 'success');
                    }, 2000);
                },
                
                generateExamQuestions() {
                    const mode = this.examModes.find(m => m.id === this.selectedMode);
                    const questionCount = mode.questions;
                    
                    // Âü∫Á°ÄÈ¢òÂ∫ì
                    const baseQuestions = [
                        {
                            title: "ÊµÅ‰ΩìÈùôÂäõÂ≠¶‰∏≠ÔºåÈùôÊ≠¢ÊµÅ‰ΩìÂÜÖÈÉ®‰ªªÊÑè‰∏ÄÁÇπÁöÑÂéãÂº∫Â§ßÂ∞è",
                            options: [
                                "‰∏éËØ•ÁÇπÊâÄÂú®Ê∑±Â∫¶ÊàêÊ≠£ÊØî",
                                "‰∏éËØ•ÁÇπÊâÄÂú®Ê∑±Â∫¶ÊàêÂèçÊØî", 
                                "‰∏éÊµÅ‰ΩìÂØÜÂ∫¶Êó†ÂÖ≥",
                                "Âè™ÂèñÂÜ≥‰∫éÂ§ßÊ∞îÂéãÂº∫"
                            ],
                            answer: 0,
                            explanation: "Ê†πÊçÆÊµÅ‰ΩìÈùôÂäõÂ≠¶Âü∫Êú¨ÊñπÁ®ãÔºåÈùôÊ≠¢ÊµÅ‰ΩìÂÜÖÈÉ®ÂéãÂº∫ÈöèÊ∑±Â∫¶Á∫øÊÄßÂ¢ûÂä†„ÄÇ"
                        },
                        {
                            title: "ÁêÜÊÉ≥ÊµÅ‰ΩìÁöÑÁâπÂæÅÂåÖÊã¨",
                            options: [
                                "ÊúâÁ≤òÊÄß„ÄÅ‰∏çÂèØÂéãÁº©",
                                "Êó†Á≤òÊÄß„ÄÅÂèØÂéãÁº©",
                                "Êó†Á≤òÊÄß„ÄÅ‰∏çÂèØÂéãÁº©", 
                                "ÊúâÁ≤òÊÄß„ÄÅÂèØÂéãÁº©"
                            ],
                            answer: 2,
                            explanation: "ÁêÜÊÉ≥ÊµÅ‰ΩìÊòØÊó†Á≤òÊÄß„ÄÅ‰∏çÂèØÂéãÁº©ÁöÑÁêÜËÆ∫ÊµÅ‰Ωì„ÄÇ"
                        },
                        {
                            title: "ËøûÁª≠ÊÄßÊñπÁ®ãÁöÑÁâ©ÁêÜÊÑè‰πâÊòØ",
                            options: [
                                "ËÉΩÈáèÂÆàÊÅí",
                                "Âä®ÈáèÂÆàÊÅí",
                                "Ë¥®ÈáèÂÆàÊÅí",
                                "ËßíÂä®ÈáèÂÆàÊÅí"
                            ],
                            answer: 2,
                            explanation: "ËøûÁª≠ÊÄßÊñπÁ®ãÂèçÊò†‰∫ÜÊµÅ‰ΩìÊµÅÂä®ËøáÁ®ã‰∏≠Ë¥®ÈáèÂÆàÊÅíÁöÑÂü∫Êú¨ÂéüÁêÜ„ÄÇ"
                        },
                        {
                            title: "‰ºØÂä™Âà©ÊñπÁ®ãÈÄÇÁî®‰∫é",
                            options: [
                                "‰ªªÊÑèÊµÅ‰ΩìÁöÑÊµÅÂä®",
                                "ÁêÜÊÉ≥ÊµÅ‰ΩìÁöÑÂÆöÂ∏∏ÊµÅÂä®",
                                "Á≤òÊÄßÊµÅ‰ΩìÁöÑÈùûÂÆöÂ∏∏ÊµÅÂä®",
                                "ÂèØÂéãÁº©ÊµÅ‰ΩìÁöÑÊµÅÂä®"
                            ],
                            answer: 1,
                            explanation: "‰ºØÂä™Âà©ÊñπÁ®ãÈÄÇÁî®‰∫éÁêÜÊÉ≥ÊµÅ‰ΩìÁöÑÂÆöÂ∏∏ÊµÅÂä®„ÄÇ"
                        },
                        {
                            title: "Èõ∑ËØ∫Êï∞ÁöÑÁâ©ÁêÜÊÑè‰πâÊòØË°®Á§∫",
                            options: [
                                "ÊµÅ‰ΩìÁöÑÂØÜÂ∫¶",
                                "ÊµÅ‰ΩìÁöÑÁ≤òÂ∫¶", 
                                "ÊÉØÊÄßÂäõ‰∏éÁ≤òÊÄßÂäõÁöÑÊØîÂÄº",
                                "ÂéãÂäõ‰∏éÈÄüÂ∫¶ÁöÑÂÖ≥Á≥ª"
                            ],
                            answer: 2,
                            explanation: "Èõ∑ËØ∫Êï∞Ë°®Á§∫ÊÉØÊÄßÂäõ‰∏éÁ≤òÊÄßÂäõÁöÑÊØîÂÄºÔºåÁî®‰∫éÂà§Êñ≠ÊµÅÂä®Áä∂ÊÄÅ„ÄÇ"
                        }
                    ];
                    
                    // Ê†πÊçÆÈ¢òÁõÆÊï∞ÈáèÁîüÊàêËØïÂç∑
                    this.examQuestions = [];
                    for (let i = 0; i < questionCount; i++) {
                        const questionIndex = i % baseQuestions.length;
                        const question = { ...baseQuestions[questionIndex] };
                        question.id = i + 1;
                        this.examQuestions.push(question);
                    }
                    
                    // ÂàùÂßãÂåñÁ≠îÊ°àÊï∞ÁªÑ
                    this.answers = new Array(questionCount).fill(null);
                },
                
                initializeExam() {
                    const mode = this.examModes.find(m => m.id === this.selectedMode);
                    this.timeRemaining = mode.duration * 60; // ËΩ¨Êç¢‰∏∫Áßí
                    this.examStartTime = Date.now();
                    this.currentQuestionIndex = 0;
                    
                    // ÂºÄÂßãËÆ°Êó∂
                    this.examTimer = setInterval(() => {
                        this.timeRemaining--;
                        if (this.timeRemaining <= 0) {
                            this.submitExam(true); // Ëá™Âä®Êèê‰∫§
                        }
                    }, 1000);
                },
                
                selectAnswer(optionIndex) {
                    this.$set(this.answers, this.currentQuestionIndex, optionIndex);
                },
                
                jumpToQuestion(index) {
                    this.currentQuestionIndex = index;
                },
                
                nextQuestion() {
                    if (this.currentQuestionIndex < this.examQuestions.length - 1) {
                        this.currentQuestionIndex++;
                    }
                },
                
                previousQuestion() {
                    if (this.currentQuestionIndex > 0) {
                        this.currentQuestionIndex--;
                    }
                },
                
                submitExam(autoSubmit = false) {
                    if (!autoSubmit) {
                        const unanswered = this.answers.filter(a => a === null).length;
                        if (unanswered > 0) {
                            if (!confirm(`ËøòÊúâ ${unanswered} È¢òÊú™‰ΩúÁ≠îÔºåÁ°ÆÂÆöË¶ÅÊèê‰∫§ÂêóÔºü`)) {
                                return;
                            }
                        } else {
                            if (!confirm('Á°ÆÂÆöË¶ÅÊèê‰∫§ËØïÂç∑ÂêóÔºüÊèê‰∫§ÂêéÊó†Ê≥ï‰øÆÊîπ„ÄÇ')) {
                                return;
                            }
                        }
                    }
                    
                    // ÂÅúÊ≠¢ËÆ°Êó∂
                    if (this.examTimer) {
                        clearInterval(this.examTimer);
                        this.examTimer = null;
                    }
                    
                    // ËÆ°ÁÆóÊàêÁª©
                    this.calculateResult();
                    this.examState = 'completed';
                    
                    const message = autoSubmit ? 'Êó∂Èó¥Âà∞ÔºåËØïÂç∑Â∑≤Ëá™Âä®Êèê‰∫§ÔºÅ' : 'ËØïÂç∑Êèê‰∫§ÊàêÂäüÔºÅ';
                    this.showNotification(message, 'success');
                },
                
                calculateResult() {
                    let correct = 0;
                    let wrong = 0;
                    let unanswered = 0;
                    
                    this.answers.forEach((answer, index) => {
                        if (answer === null) {
                            unanswered++;
                        } else if (answer === this.examQuestions[index].answer) {
                            correct++;
                        } else {
                            wrong++;
                        }
                    });
                    
                    const score = Math.round((correct / this.examQuestions.length) * 100);
                    const timeUsed = Math.round((Date.now() - this.examStartTime) / 60000);
                    
                    this.examResult = {
                        score,
                        correct,
                        wrong,
                        unanswered,
                        timeUsed,
                        total: this.examQuestions.length
                    };
                    
                    // ‰øùÂ≠òÊàêÁª©
                    this.saveResult();
                },
                
                saveResult() {
                    const results = this.loadFromStorage('examResults', []);
                    results.unshift({
                        ...this.examResult,
                        mode: this.selectedMode,
                        date: new Date().toISOString(),
                        settings: this.examSettings
                    });
                    this.saveToStorage('examResults', results);
                },
                
                getGradeColor(score) {
                    if (score >= 90) return '#28a745';
                    if (score >= 80) return '#007bff';
                    if (score >= 70) return '#ffc107';
                    if (score >= 60) return '#fd7e14';
                    return '#dc3545';
                },
                
                getGradeText(score) {
                    if (score >= 90) return '‰ºòÁßÄ';
                    if (score >= 80) return 'ËâØÂ•Ω';
                    if (score >= 70) return '‰∏≠Á≠â';
                    if (score >= 60) return 'ÂèäÊ†º';
                    return '‰∏çÂèäÊ†º';
                },
                
                getCurrentModeInfo() {
                    return this.examModes.find(m => m.id === this.selectedMode) || {};
                },
                
                reviewAnswers() {
                    this.showNotification('Á≠îÊ°àËß£ÊûêÂäüËÉΩÂºÄÂèë‰∏≠...', 'info');
                },
                
                restartExam() {
                    this.examState = 'setup';
                    this.selectedMode = null;
                    this.currentQuestionIndex = 0;
                    this.answers = [];
                    this.timeRemaining = 0;
                    this.examQuestions = [];
                    this.examResult = {};
                    
                    if (this.examTimer) {
                        clearInterval(this.examTimer);
                        this.examTimer = null;
                    }
                }
            },
            
            mounted() {
                console.log('üìù ËÄÉËØïÊ®°ÊãüÊ®°ÂùóÂêØÂä®ÔºÅ');
                this.setLoading(true);
                
                setTimeout(() => {
                    this.setLoading(false);
                    this.showNotification('ËÄÉËØïÁ≥ªÁªüÂáÜÂ§áÂ∞±Áª™ÔºÅ', 'success');
                }, 1000);
            },
            
            beforeUnmount() {
                if (this.examTimer) {
                    clearInterval(this.examTimer);
                }
            }
        }).mount('#examApp');
    </script>
</body>
</html> 