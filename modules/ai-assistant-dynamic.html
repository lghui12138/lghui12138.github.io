<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– AIå­¦ä¹ åŠ©æ‰‹ - å…¨å±æ”¯æŒ</title>
    
    <!-- å¤–éƒ¨ä¾èµ– - æ·»åŠ é”™è¯¯å¤„ç† -->
    <script>
        // èµ„æºåŠ è½½é”™è¯¯å¤„ç†
        window.resourceErrors = [];
        window.addEventListener('error', function(e) {
            if (e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK') {
                console.warn('èµ„æºåŠ è½½å¤±è´¥:', e.target.src || e.target.href);
                window.resourceErrors.push(e.target.src || e.target.href);
            }
        });
    </script>
    
    <!-- Vue.js - ä¸»è¦CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js" 
            onerror="loadVueFallback()"></script>
    <script>
        function loadVueFallback() {
            console.log('Vue.jsåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDN...');
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js';
            script.onerror = function() {
                console.error('Vue.jsæ‰€æœ‰CDNéƒ½å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°å¤‡ç”¨æ–¹æ¡ˆ');
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æœ¬åœ°Vue.jsæ–‡ä»¶
            };
            document.head.appendChild(script);
        }
    </script>
    
    <!-- Font Awesome - ä¸»è¦CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" 
          rel="stylesheet" 
          onerror="loadFontAwesomeFallback()">
    <script>
        function loadFontAwesomeFallback() {
            console.log('Font AwesomeåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨Unicodeå›¾æ ‡');
            // æ·»åŠ CSSæ¥ä½¿ç”¨Unicodeå›¾æ ‡ä½œä¸ºå¤‡ç”¨
            const style = document.createElement('style');
            style.textContent = `
                .fas.fa-circle::before { content: "â—"; }
                .fas.fa-arrow-up::before { content: "â†‘"; }
                .fas.fa-home::before { content: "ğŸ "; }
                .fas.fa-expand::before { content: "â›¶"; }
                .fas.fa-compress::before { content: "â›¶"; }
            `;
            document.head.appendChild(style);
        }
    </script>
    
    <!-- Google Fonts - ä¸»è¦CDN -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" 
          rel="stylesheet" 
          onerror="loadFontFallback()">
    <script>
        function loadFontFallback() {
            console.log('Google FontsåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨ç³»ç»Ÿå­—ä½“');
            const style = document.createElement('style');
            style.textContent = `
                body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
            `;
            document.head.appendChild(style);
        }
    </script>
    
    <!-- æ™ºèƒ½AIç³»ç»Ÿ - æœ¬åœ°æ–‡ä»¶ -->
    <script src="../js/core/config.js" onerror="console.warn('config.jsåŠ è½½å¤±è´¥')"></script>
    <script src="../js/core/smart-model-selector.js" onerror="console.warn('smart-model-selector.jsåŠ è½½å¤±è´¥')"></script>
    
    <!-- ç®€åŒ–çš„æ•°å­¦å…¬å¼å¤„ç† - çº¯CSSæ–¹æ¡ˆ -->
    <script>
        // ç®€å•çš„æ•°å­¦å…¬å¼å¤„ç†å‡½æ•°
        function processMathFormulas() {
            console.log('ğŸ”¢ å¤„ç†æ•°å­¦å…¬å¼ - ä½¿ç”¨CSSæ–¹æ¡ˆ');

            document.querySelectorAll('.math-formula').forEach(el => {
                let content = el.innerHTML;

                // å¤„ç†å¸¸è§çš„LaTeXç¬¦å· - å®Œæ•´ç‰ˆæœ¬
                content = content
                    // åˆ†æ•°
                    .replace(/\\frac\{([^}]+)\}\{([^}]+)\}/g, '<span class="fraction"><span class="numerator">$1</span><span class="denominator">$2</span></span>')
                    // å¹³æ–¹æ ¹
                    .replace(/\\sqrt\{([^}]+)\}/g, '<span class="sqrt">âˆš<span class="sqrt-content">$1</span></span>')
                    // ä¸Šä¸‹æ ‡
                    .replace(/\^{([^}]+)}/g, '<sup>$1</sup>')
                    .replace(/_{([^}]+)}/g, '<sub>$1</sub>')
                    .replace(/\^(\w+)/g, '<sup>$1</sup>')
                    .replace(/_(\w+)/g, '<sub>$1</sub>')
                    // å¸Œè…Šå­—æ¯ - å°å†™
                    .replace(/\\alpha/g, 'Î±')
                    .replace(/\\beta/g, 'Î²')
                    .replace(/\\gamma/g, 'Î³')
                    .replace(/\\delta/g, 'Î´')
                    .replace(/\\epsilon/g, 'Îµ')
                    .replace(/\\varepsilon/g, 'Îµ')
                    .replace(/\\zeta/g, 'Î¶')
                    .replace(/\\eta/g, 'Î·')
                    .replace(/\\theta/g, 'Î¸')
                    .replace(/\\vartheta/g, 'Ï‘')
                    .replace(/\\iota/g, 'Î¹')
                    .replace(/\\kappa/g, 'Îº')
                    .replace(/\\lambda/g, 'Î»')
                    .replace(/\\mu/g, 'Î¼')
                    .replace(/\\nu/g, 'Î½')
                    .replace(/\\xi/g, 'Î¾')
                    .replace(/\\pi/g, 'Ï€')
                    .replace(/\\varpi/g, 'Ï–')
                    .replace(/\\rho/g, 'Ï')
                    .replace(/\\varrho/g, 'Ï±')
                    .replace(/\\sigma/g, 'Ïƒ')
                    .replace(/\\varsigma/g, 'Ï‚')
                    .replace(/\\tau/g, 'Ï„')
                    .replace(/\\upsilon/g, 'Ï…')
                    .replace(/\\phi/g, 'Ï†')
                    .replace(/\\varphi/g, 'Ï†')
                    .replace(/\\chi/g, 'Ï‡')
                    .replace(/\\psi/g, 'Ïˆ')
                    .replace(/\\omega/g, 'Ï‰')
                    // å¸Œè…Šå­—æ¯ - å¤§å†™
                    .replace(/\\Gamma/g, 'Î“')
                    .replace(/\\Delta/g, 'Î”')
                    .replace(/\\Theta/g, 'Î˜')
                    .replace(/\\Lambda/g, 'Î›')
                    .replace(/\\Xi/g, 'Î')
                    .replace(/\\Pi/g, 'Î ')
                    .replace(/\\Sigma/g, 'Î£')
                    .replace(/\\Upsilon/g, 'Î¥')
                    .replace(/\\Phi/g, 'Î¦')
                    .replace(/\\Psi/g, 'Î¨')
                    .replace(/\\Omega/g, 'Î©')
                    // æ•°å­¦ç¬¦å·
                    .replace(/\\nabla/g, 'âˆ‡')
                    .replace(/\\partial/g, 'âˆ‚')
                    .replace(/\\infty/g, 'âˆ')
                    .replace(/\\approx/g, 'â‰ˆ')
                    .replace(/\\neq/g, 'â‰ ')
                    .replace(/\\leq/g, 'â‰¤')
                    .replace(/\\geq/g, 'â‰¥')
                    .replace(/\\ll/g, 'â‰ª')
                    .replace(/\\gg/g, 'â‰«')
                    .replace(/\\cdot/g, 'Â·')
                    .replace(/\\times/g, 'Ã—')
                    .replace(/\\otimes/g, 'âŠ—')
                    .replace(/\\oplus/g, 'âŠ•')
                    .replace(/\\div/g, 'Ã·')
                    .replace(/\\pm/g, 'Â±')
                    .replace(/\\mp/g, 'âˆ“')
                    .replace(/\\equiv/g, 'â‰¡')
                    .replace(/\\sim/g, 'âˆ¼')
                    .replace(/\\simeq/g, 'â‰ƒ')
                    .replace(/\\cong/g, 'â‰…')
                    .replace(/\\propto/g, 'âˆ')
                    // ç‚¹ç¬¦å·
                    .replace(/\\dot\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">Ë™</span></span>')
                    .replace(/\\ddot\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">Â¨</span></span>')
                    .replace(/\\hat\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">^</span></span>')
                    .replace(/\\tilde\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">~</span></span>')
                    .replace(/\\bar\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.3em;left:0;right:0;height:1px;background:currentColor;"></span></span>')
                    // ç§¯åˆ†ç¬¦å·
                    .replace(/\\int/g, 'âˆ«')
                    .replace(/\\iint/g, 'âˆ¬')
                    .replace(/\\iiint/g, 'âˆ­')
                    .replace(/\\oint/g, 'âˆ®')
                    // æ±‚å’Œç¬¦å·
                    .replace(/\\sum/g, 'âˆ‘')
                    .replace(/\\prod/g, 'âˆ')
                    .replace(/\\coprod/g, 'âˆ')
                    // æé™ç¬¦å·
                    .replace(/\\lim/g, 'lim')
                    .replace(/\\limsup/g, 'lim sup')
                    .replace(/\\liminf/g, 'lim inf')
                    .replace(/\\max/g, 'max')
                    .replace(/\\min/g, 'min')
                    .replace(/\\sup/g, 'sup')
                    .replace(/\\inf/g, 'inf')
                    // ä¸‰è§’å‡½æ•°
                    .replace(/\\sin/g, 'sin')
                    .replace(/\\cos/g, 'cos')
                    .replace(/\\tan/g, 'tan')
                    .replace(/\\cot/g, 'cot')
                    .replace(/\\sec/g, 'sec')
                    .replace(/\\csc/g, 'csc')
                    .replace(/\\arcsin/g, 'arcsin')
                    .replace(/\\arccos/g, 'arccos')
                    .replace(/\\arctan/g, 'arctan')
                    .replace(/\\sinh/g, 'sinh')
                    .replace(/\\cosh/g, 'cosh')
                    .replace(/\\tanh/g, 'tanh')
                    // å¯¹æ•°å‡½æ•°
                    .replace(/\\log/g, 'log')
                    .replace(/\\ln/g, 'ln')
                    .replace(/\\lg/g, 'lg')
                    .replace(/\\exp/g, 'exp')
                    // ç®­å¤´
                    .replace(/\\rightarrow/g, 'â†’')
                    .replace(/\\leftarrow/g, 'â†')
                    .replace(/\\leftrightarrow/g, 'â†”')
                    .replace(/\\Rightarrow/g, 'â‡’')
                    .replace(/\\Leftarrow/g, 'â‡')
                    .replace(/\\Leftrightarrow/g, 'â‡”')
                    .replace(/\\uparrow/g, 'â†‘')
                    .replace(/\\downarrow/g, 'â†“')
                    .replace(/\\updownarrow/g, 'â†•')
                    .replace(/\\nearrow/g, 'â†—')
                    .replace(/\\searrow/g, 'â†˜')
                    .replace(/\\swarrow/g, 'â†™')
                    .replace(/\\nwarrow/g, 'â†–')
                    .replace(/\\top/g, 'áµ€')
                    // é›†åˆç¬¦å·
                    .replace(/\\in/g, 'âˆˆ')
                    .replace(/\\notin/g, 'âˆ‰')
                    .replace(/\\subset/g, 'âŠ‚')
                    .replace(/\\supset/g, 'âŠƒ')
                    .replace(/\\subseteq/g, 'âŠ†')
                    .replace(/\\supseteq/g, 'âŠ‡')
                    .replace(/\\cap/g, 'âˆ©')
                    .replace(/\\cup/g, 'âˆª')
                    .replace(/\\setminus/g, 'âˆ–')
                    .replace(/\\emptyset/g, 'âˆ…')
                    .replace(/\\varnothing/g, 'âˆ…')
                    // é€»è¾‘ç¬¦å·
                    .replace(/\\forall/g, 'âˆ€')
                    .replace(/\\exists/g, 'âˆƒ')
                    .replace(/\\nexists/g, 'âˆ„')
                    .replace(/\\land/g, 'âˆ§')
                    .replace(/\\lor/g, 'âˆ¨')
                    .replace(/\\lnot/g, 'Â¬')
                    .replace(/\\neg/g, 'Â¬')
                    // å‘é‡å’ŒçŸ©é˜µ
                    .replace(/\\vec\{([^}]+)\}/g, '<span class="vector-perfect">$1</span>')
                    .replace(/\\mathbf\{([^}]+)\}/g, '<strong>$1</strong>')
                    .replace(/\\boldsymbol\{([^}]+)\}/g, '<strong>$1</strong>')
                    .replace(/\\mathbb\{([^}]+)\}/g, '<span style="font-weight:bold;font-family:serif;">$1</span>')
                    .replace(/\\mathcal\{([^}]+)\}/g, '<span style="font-family:cursive;font-style:italic;">$1</span>')
                    .replace(/\\mathfrak\{([^}]+)\}/g, '<span style="font-family:serif;font-weight:bold;">$1</span>')
                    // å¾®åˆ†ç¬¦å·
                    .replace(/\\mathrm\{d\}/g, 'd')
                    .replace(/\\,\s*d/g, ' d')
                    // å¸¸ç”¨å¸¸æ•°
                    .replace(/\\mathbf\{I\}/g, '<strong>I</strong>')
                    .replace(/\\mathbf\{0\}/g, '<strong>0</strong>')
                    // æ›´å¤šè¿ç®—ç¬¦
                    .replace(/\\ast/g, 'âˆ—')
                    .replace(/\\star/g, 'â‹†')
                    .replace(/\\circ/g, 'âˆ˜')
                    .replace(/\\bullet/g, 'â€¢')
                    .replace(/\\diamond/g, 'â‹„')
                    .replace(/\\triangle/g, 'â–³')
                    .replace(/\\triangledown/g, 'â–½')
                    .replace(/\\square/g, 'â–¡')
                    .replace(/\\blacksquare/g, 'â– ')
                    .replace(/\\bigcirc/g, 'â—‹')
                    .replace(/\\bigtriangleup/g, 'â–³')
                    .replace(/\\bigtriangledown/g, 'â–½')
                    // å…³ç³»ç¬¦å·
                    .replace(/\\parallel/g, 'âˆ¥')
                    .replace(/\\perp/g, 'âŠ¥')
                    .replace(/\\angle/g, 'âˆ ')
                    .replace(/\\sphericalangle/g, 'âˆ¢')
                    .replace(/\\measuredangle/g, 'âˆ¡')
                    // å…¶ä»–ç¬¦å·
                    .replace(/\\hbar/g, 'â„')
                    .replace(/\\ell/g, 'â„“')
                    .replace(/\\wp/g, 'â„˜')
                    .replace(/\\Re/g, 'â„œ')
                    .replace(/\\Im/g, 'â„‘')
                    .replace(/\\aleph/g, 'â„µ')
                    .replace(/\\beth/g, 'â„¶')
                    .replace(/\\gimel/g, 'â„·')
                    .replace(/\\daleth/g, 'â„¸')
                    // å¤„ç† \left å’Œ \right å‘½ä»¤
                    .replace(/\\left\s*\(/g, '(')
                    .replace(/\\right\s*\)/g, ')')
                    .replace(/\\left\s*\[/g, '[')
                    .replace(/\\right\s*\]/g, ']')
                    .replace(/\\left\s*\{/g, '{')
                    .replace(/\\right\s*\}/g, '}')
                    .replace(/\\left\s*\|/g, '|')
                    .replace(/\\right\s*\|/g, '|')
                    .replace(/\\left\s*\\langle/g, 'âŸ¨')
                    .replace(/\\right\s*\\rangle/g, 'âŸ©')
                    .replace(/\\left\s*\\lceil/g, 'âŒˆ')
                    .replace(/\\right\s*\\rceil/g, 'âŒ‰')
                    .replace(/\\left\s*\\lfloor/g, 'âŒŠ')
                    .replace(/\\right\s*\\rfloor/g, 'âŒ‹')
                    // å¤„ç†å•ç‹¬çš„ \left å’Œ \rightï¼ˆç§»é™¤å®ƒä»¬ï¼‰
                    .replace(/\\left\s*/g, '')
                    .replace(/\\right\s*/g, '')
                    // ç§»é™¤$$ç¬¦å·
                    .replace(/\$\$/g, '');

                el.innerHTML = content;
                el.style.display = 'block';
                el.style.visibility = 'visible';
            });

            console.log('âœ… æ•°å­¦å…¬å¼å¤„ç†å®Œæˆ');
        }

        // é¡µé¢åŠ è½½å®Œæˆåå¤„ç†å…¬å¼
        document.addEventListener('DOMContentLoaded', processMathFormulas);
    </script>


    <!-- æ•°å­¦å…¬å¼CSSæ ·å¼ -->
    <style>
        .math-display {
            text-align: center;
            margin: 15px 0;
            font-size: 1.2em;
            font-family: 'Times New Roman', serif;
        }

        .math-inline {
            font-family: 'Times New Roman', serif;
            font-style: italic;
        }

        .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
        }

        .numerator {
            display: block;
            border-bottom: 1px solid currentColor;
            padding-bottom: 2px;
        }

        .denominator {
            display: block;
            padding-top: 2px;
        }

        .sqrt {
            position: relative;
        }

        .sqrt-content {
            border-top: 1px solid currentColor;
            padding-left: 2px;
        }
    </style>

    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #4facfe;
            --success-color: #43e97b;
            --warning-color: #feca57;
            --error-color: #ff6b6b;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            animation: gradientFlow 25s ease infinite;
            line-height: 1.6;
        }

        @keyframes gradientFlow {
            0%, 100% { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
            20% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
            40% { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
            60% { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
            80% { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        }

        /* å…¨å±æ¨¡å¼æ ·å¼ */
        .ai-container {
            position: relative;
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .ai-container.is-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 10000;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        }

        /* å…¨å±æ§åˆ¶æŒ‰é’® */
        .fullscreen-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10001;
            display: flex;
            gap: 10px;
            opacity: 0.9;
            transition: all 0.3s ease;
        }

        .fullscreen-controls:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .fullscreen-btn, .back-btn, .advanced-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .fullscreen-btn:hover, .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        }

        .fullscreen-btn.active {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            border-color: var(--accent-color);
        }

        /* ä¸»è¦å†…å®¹ */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 20px 40px;
            position: relative;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .is-fullscreen .main-content {
            max-width: 100%;
            padding: 80px 40px 40px;
            height: 100vh;
            overflow-y: auto;
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page-title {
            text-align: center;
            font-size: clamp(2.5rem, 5vw, 3.8rem);
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #fff, #f0f8ff, #e6f3ff, #fff);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleShine 4s ease-in-out infinite;
            text-shadow: 0 0 50px rgba(255,255,255,0.3);
        }

        @keyframes titleShine {
            0%, 100% { background-position: 0% 50%; filter: brightness(1); }
            50% { background-position: 100% 50%; filter: brightness(1.3); }
        }

        .page-subtitle {
            text-align: center;
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 40px;
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 0.9;
                transform: translateY(0);
            }
        }

        /* èŠå¤©å®¹å™¨ */
        .chat-container {
            background: rgba(255,255,255,0.95);
            border-radius: 25px;
            padding: 0;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            overflow: hidden;
            transition: all 0.5s ease;
            animation: chatSlideIn 0.8s ease-out both;
            border: 2px solid transparent;
        }

        @keyframes chatSlideIn {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .chat-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 80px rgba(0,0,0,0.2);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .chat-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 30px;
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-header .ai-icon {
            animation: aiPulse 2s ease-in-out infinite;
        }

        @keyframes aiPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .chat-messages {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            color: #333;
            background: white;
        }

        .is-fullscreen .chat-messages {
            height: 50vh;
        }

        .message {
            margin-bottom: 20px;
            animation: messageSlideIn 0.3s ease-out;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .message.user {
            text-align: right;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
            margin-left: auto;
        }

        .message.ai .message-content {
            background: #f8f9fa;
            color: #333;
            margin-right: auto;
        }

        .message-content {
            display: inline-block;
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 20px;
            line-height: 1.6;
            word-wrap: break-word;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .message-content:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .message-time {
            font-size: 0.8em;
            opacity: 0.6;
            margin-top: 5px;
        }

        /* è¾“å…¥åŒºåŸŸ */
        .chat-input {
            padding: 20px;
            background: white;
            border-top: 1px solid #eee;
        }

        .input-container {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        .input-tools {
            position: absolute;
            right: 10px;
            bottom: 10px;
            display: flex;
            gap: 5px;
            z-index: 10;
        }

        .voice-btn, .math-btn, .template-btn {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
            color: var(--accent-color);
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .voice-btn:hover, .math-btn:hover, .template-btn:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: scale(1.1);
        }

        .voice-btn.active {
            background: var(--error-color);
            color: white;
            animation: pulse 1s infinite;
        }

        .math-btn.active {
            background: var(--accent-color);
            color: white;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .message-input {
            width: 100%;
            padding: 15px 60px 15px 20px; /* å³ä¾§ç•™ç©ºé—´ç»™å·¥å…·æŒ‰é’® */
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1em;
            resize: none;
            min-height: 50px;
            max-height: 150px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .message-input:focus {
            outline: none;
            border-color: var(--accent-color);
            background: white;
            box-shadow: 0 5px 20px rgba(79, 172, 254, 0.2);
        }

        .send-btn {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 20px rgba(79, 172, 254, 0.3);
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(79, 172, 254, 0.5);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* æ•°å­¦è¾“å…¥é¢æ¿ */
        .math-input-panel {
            margin-top: 15px;
            padding: 15px;
            background: rgba(79, 172, 254, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(79, 172, 254, 0.2);
        }

        .math-symbols {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 8px;
            margin-bottom: 15px;
        }

        .symbol-btn {
            background: white;
            border: 1px solid #ddd;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 40px;
        }

        .symbol-btn:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }

        .math-templates {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .template-btn-small {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .template-btn-small:hover {
            background: var(--primary-color);
            transform: translateY(-2px);
        }

        /* è¯­éŸ³çŠ¶æ€ */
        .voice-status {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(255, 107, 107, 0.3);
            color: var(--error-color);
            font-weight: 500;
        }

        .voice-animation {
            display: flex;
            gap: 3px;
        }

        .voice-wave {
            width: 4px;
            height: 20px;
            background: var(--error-color);
            border-radius: 2px;
            animation: voiceWave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) {
            animation-delay: 0.2s;
        }

        .voice-wave:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes voiceWave {
            0%, 100% {
                height: 20px;
                background: var(--error-color);
            }
            50% {
                height: 35px;
                background: #ff8a80;
            }
        }

        /* è¯­éŸ³è¾“å…¥å¢å¼ºæ ·å¼ */
        .voice-btn.recording {
            background: linear-gradient(45deg, #ff6b6b, #ff8a80);
            color: white;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
            animation: recordingPulse 1.5s ease-in-out infinite;
        }

        @keyframes recordingPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 30px rgba(255, 107, 107, 0.8);
            }
        }

        /* è¯­éŸ³æƒé™æç¤º */
        .voice-permission-hint {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 10004;
            text-align: center;
            color: #333;
            max-width: 400px;
            animation: slideInScale 0.3s ease-out;
        }

        @keyframes slideInScale {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* ä¼˜åŒ–çš„æ•°å­¦å…¬å¼æ ·å¼ - çº¯CSSæ–¹æ¡ˆ */
        .math-formula {
            margin: 15px 0;
            padding: 12px;
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1));
            border-radius: 12px;
            border-left: 4px solid var(--accent-color);
            text-align: center;
            font-size: 1.2em;
            font-family: 'Times New Roman', 'STIX Two Math', 'Latin Modern Math', 'Cambria Math', 'Lucida Bright Math', 'DejaVu Math', serif;
            overflow-x: auto;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            /* ç¡®ä¿Unicodeå­—ç¬¦æ­£ç¡®æ˜¾ç¤º */
            unicode-bidi: embed;
            direction: ltr;
        }

        /* åˆ†æ•°æ ·å¼ */
        .fraction {
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            margin: 0 3px;
        }

        .numerator {
            display: block;
            border-bottom: 1px solid currentColor;
            padding-bottom: 2px;
            font-size: 0.9em;
        }

        .denominator {
            display: block;
            padding-top: 2px;
            font-size: 0.9em;
        }

        /* å¹³æ–¹æ ¹æ ·å¼ */
        .sqrt {
            position: relative;
            display: inline-block;
            margin: 0 2px;
        }

        .sqrt-content {
            border-top: 1px solid currentColor;
            padding-left: 2px;
            margin-left: 2px;
        }

        /* å‘é‡æ ·å¼ - ç²¾ç¡®ç®­å¤´å¯¹é½ */
        .vector {
            position: relative;
            font-weight: bold;
            display: inline-block;
            margin: 0 1px; /* ç»™ç®­å¤´ç•™å‡ºç©ºé—´ */
        }

        .vector::after {
            content: 'â†’';
            position: absolute;
            top: -0.4em; /* è°ƒæ•´å‚ç›´ä½ç½® */
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em; /* ç¨å¾®ç¼©å°ç®­å¤´ */
            font-weight: normal;
            line-height: 1;
            z-index: 1;
        }

        /* å•å­—æ¯å‘é‡ä¼˜åŒ– */
        .vector.single-letter {
            min-width: 0.8em;
            text-align: center;
        }

        .vector.single-letter::after {
            top: -0.35em;
            font-size: 0.65em;
        }

        /* å¤šå­—æ¯å‘é‡ä¼˜åŒ– */
        .vector.multi-letter::after {
            top: -0.45em;
            font-size: 0.75em;
        }

        /* å¤‡ç”¨å‘é‡æ ·å¼ï¼ˆä½¿ç”¨ä¸Šåˆ’çº¿ï¼‰ */
        .vector-overline {
            text-decoration: overline;
            text-decoration-thickness: 1px;
            text-underline-offset: -0.2em;
            font-weight: bold;
        }

        /* å®Œç¾å‘é‡å¯¹é½æ ·å¼ */
        .vector-perfect {
            position: relative;
            font-weight: bold;
            display: inline-block;
            margin: 0 2px;
        }

        .vector-perfect::after {
            content: 'â†’';
            position: absolute;
            top: -0.4em;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em;
            font-weight: normal;
            line-height: 1;
            color: currentColor;
            z-index: 1;
        }

        /* ä¸Šæ ‡ä¸‹æ ‡ä¼˜åŒ– */
        sup, sub {
            font-size: 0.75em;
            line-height: 0;
        }

        /* å¸Œè…Šå­—æ¯å’Œç‰¹æ®Šç¬¦å· */
        .math-formula .greek {
            font-style: italic;
            font-weight: normal;
        }

        /* å†…è”æ•°å­¦å…¬å¼ */
        .math-inline {
            background: rgba(79, 172, 254, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Times New Roman', serif;
            font-style: italic;
            margin: 0 2px;
        }

        /* æ•°å­¦æ˜¾ç¤ºå…¬å¼ */
        .math-display {
            display: block;
            text-align: center;
            margin: 15px 0;
            font-size: 1.3em;
            font-family: 'Times New Roman', serif;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        /* ç‰¹æ®Šæ•°å­¦ç¬¦å·æ ·å¼ */
        .math-symbol {
            font-family: 'Segoe UI Symbol', 'Symbol', 'Times New Roman', serif;
            font-size: 1.1em;
        }

        /* ç§¯åˆ†ç¬¦å·ç‰¹æ®Šå¤„ç† */
        .integral {
            font-size: 1.4em;
            vertical-align: middle;
            margin: 0 2px;
        }

        /* æ±‚å’Œç¬¦å·ç‰¹æ®Šå¤„ç† */
        .summation {
            font-size: 1.3em;
            vertical-align: middle;
            margin: 0 2px;
        }

        /* å¿«é€Ÿå»ºè®® */
        .suggestions-section {
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            animation: suggestionsSlideIn 1s ease-out 0.5s both;
        }

        @keyframes suggestionsSlideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .suggestions-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .suggestions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .suggestion-item {
            background: rgba(255,255,255,0.1);
            padding: 15px 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .suggestion-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-3px);
            border-color: rgba(255,255,255,0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* AIçŠ¶æ€æŒ‡ç¤ºå™¨ */
        .ai-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--glass-bg);
            padding: 12px 18px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            font-size: 0.9em;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .ai-status.thinking {
            animation: statusPulse 1.5s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
        }

        /* å¿«æ·é”®æç¤º */
        .shortcuts-hint {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--glass-bg);
            padding: 15px 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            font-size: 0.85em;
            opacity: 0.8;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .shortcuts-hint:hover {
            opacity: 1;
            transform: translateY(-3px);
        }

        /* é€šçŸ¥ç»„ä»¶ */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 15px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            max-width: 90vw;
        }

        .notification.show {
            animation: notificationSlideIn 0.3s ease-out;
        }

        @keyframes notificationSlideIn {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success-color), #38f9d7);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--error-color), #ee5a52);
        }

        .notification.info {
            background: linear-gradient(135deg, var(--accent-color), #00f2fe);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-content {
                padding: 60px 15px 20px;
            }
            
            .is-fullscreen .main-content {
                padding: 60px 20px 20px;
            }
            
            .chat-messages {
                height: 300px;
            }
            
            .is-fullscreen .chat-messages {
                height: 40vh;
            }
            
            .suggestions-grid {
                grid-template-columns: 1fr;
            }
            
            .input-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .send-btn {
                align-self: stretch;
                justify-content: center;
            }
            
            .shortcuts-hint {
                display: none;
            }
        }

        /* ç½‘ç»œçŠ¶æ€æç¤º */
        .network-status {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 107, 107, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            z-index: 10000;
            backdrop-filter: blur(10px);
            display: none;
            animation: slideDown 0.3s ease;
        }

        .network-status.show {
            display: block;
        }

        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-size: 18px;
            font-weight: 500;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            margin-top: 20px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: white;
            border-radius: 2px;
            animation: loadingProgress 3s ease-in-out infinite;
        }

        @keyframes loadingProgress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        /* é«˜çº§åŠŸèƒ½é¢æ¿æ ·å¼ */
        .advanced-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 400px;
            height: 100vh;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.3);
            z-index: 10002;
            overflow-y: auto;
            transform: translateX(100%);
            animation: slideInRight 0.3s ease-out forwards;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.2);
        }

        @keyframes slideInRight {
            to { transform: translateX(0); }
        }

        .panel-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .panel-header h3 {
            margin: 0;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .panel-content {
            padding: 20px;
            color: #333;
        }

        .feature-section, .preference-section, .session-section, .stats-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .feature-section h4, .preference-section h4, .session-section h4, .stats-section h4 {
            margin: 0 0 15px 0;
            color: var(--primary-color);
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
        }

        /* å¼€å…³æ ·å¼ */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .preference-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .preference-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .preference-item label {
            font-weight: 500;
            color: var(--secondary-color);
        }

        .preference-item select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: white;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .preference-item select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .session-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .session-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .session-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .session-btn.danger {
            background: var(--error-color);
        }

        .session-btn.danger:hover {
            background: #dc2626;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-value {
            display: block;
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.8em;
            color: #666;
        }

        /* æµ®åŠ¨ç²’å­æ•ˆæœ */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(255,255,255,0.4);
            border-radius: 50%;
            animation: floatParticle 40s linear infinite;
            box-shadow: 0 0 6px rgba(255,255,255,0.3);
        }

        @keyframes floatParticle {
            0% {
                transform: translateY(100vh) rotate(0deg) scale(0);
                opacity: 0;
            }
            5% {
                opacity: 1;
                transform: translateY(95vh) rotate(18deg) scale(1);
            }
            95% {
                opacity: 1;
                transform: translateY(-5vh) rotate(342deg) scale(1);
            }
            100% {
                transform: translateY(-10vh) rotate(360deg) scale(0);
                opacity: 0;
            }
        }

        /* AIæ™ºèƒ½æ¨å¯¼åŠŸèƒ½ */
        .ai-derivation-section {
            margin-top: 40px;
            padding: 30px;
            background: var(--glass-bg);
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            animation: suggestionsSlideIn 1s ease-out 0.5s both;
        }

        .derivation-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .derivation-card .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .derivation-card .card-content p {
            font-size: 0.95em;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .derivation-example .example-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .derivation-steps .step {
            font-size: 0.9em;
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .derivation-steps .formula {
            font-size: 0.9em;
            color: var(--accent-color);
            font-family: 'Courier New', Courier, monospace;
            margin-left: 20px;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .derivation-example .derivation-steps {
            border-left: 2px solid var(--primary-color);
            padding-left: 15px;
            margin-left: 10px;
        }

        .hint-system .hint-item {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .hint-system .hint-title {
            font-size: 1em;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .hint-system .hint-content p {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .interactive-exercise .exercise-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .interactive-exercise .exercise-steps .step-prompt {
            font-size: 0.9em;
            color: var(--secondary-color);
            margin-bottom: 8px;
            font-style: italic;
        }

        .interactive-exercise .exercise-steps .formula {
            font-size: 0.9em;
            color: var(--primary-color);
            font-family: 'Courier New', Courier, monospace;
            margin-left: 20px;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .advanced-derivation-section .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .verification-example .example-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .verification-steps .step {
            font-size: 0.9em;
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .verification-steps .formula {
            font-size: 0.9em;
            color: var(--primary-color);
            font-family: 'Courier New', Courier, monospace;
            margin-left: 20px;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .verification-result .result-title {
            font-size: 1em;
            font-weight: 600;
            color: var(--success-color);
            margin-bottom: 8px;
        }

        .verification-result .result-details p {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .error-detection .error-example {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .error-detection .error-title {
            font-size: 1em;
            font-weight: 600;
            color: var(--error-color);
            margin-bottom: 8px;
        }

        .error-detection .error-description p {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        /* æ•°å­¦å…¬å¼æ ·å¼ */
        .math-formula {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            backdrop-filter: blur(10px);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .math-formula::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .math-formula:hover::before {
            left: 100%;
        }

        .math-formula:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .formula-label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .derivation-step {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid var(--accent-color);
            transition: all 0.3s ease;
        }

        .derivation-step:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateX(5px);
        }

        .step-number {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.8em;
        }

        .step-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .step-description {
            color: var(--text-secondary);
            font-size: 0.95em;
            margin-bottom: 15px;
            line-height: 1.5;
        }



        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .math-formula {
                padding: 15px;
                margin: 10px 0;
            }

        }
    </style>
</head>
<body>
    <!-- æµ®åŠ¨ç²’å­æ•ˆæœ -->
    <div class="floating-elements">
        <div class="floating-particle" style="left: 6%; animation-delay: 0s;"></div>
        <div class="floating-particle" style="left: 16%; animation-delay: 6s;"></div>
        <div class="floating-particle" style="left: 26%; animation-delay: 12s;"></div>
        <div class="floating-particle" style="left: 36%; animation-delay: 18s;"></div>
        <div class="floating-particle" style="left: 46%; animation-delay: 24s;"></div>
        <div class="floating-particle" style="left: 56%; animation-delay: 30s;"></div>
        <div class="floating-particle" style="left: 66%; animation-delay: 36s;"></div>
        <div class="floating-particle" style="left: 76%; animation-delay: 42s;"></div>
        <div class="floating-particle" style="left: 86%; animation-delay: 48s;"></div>
        <div class="floating-particle" style="left: 96%; animation-delay: 54s;"></div>
    </div>

    <div id="app" :class="['ai-container', { 'is-fullscreen': isFullscreen }]">
        <!-- åŠ è½½è¦†ç›–å±‚ -->
        <div v-if="loading" class="loading-overlay">
            <div class="loading-spinner"></div>
            <div class="loading-text">æ­£åœ¨åŠ è½½AIå­¦ä¹ åŠ©æ‰‹...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>

        <!-- é€šçŸ¥ç»„ä»¶ -->
        <div v-if="notification.show" :class="['notification', notification.type, {show: notification.show}]">
            {{ notification.message }}
        </div>

        <!-- ç½‘ç»œçŠ¶æ€æç¤º -->
        <div v-if="networkStatus" :class="['network-status', { show: networkStatus.show }]" :title="networkStatus.message">
            <i :class="networkStatus.icon"></i> {{ networkStatus.message }}
        </div>

        <!-- å…¨å±æ§åˆ¶æŒ‰é’® -->
        <div class="fullscreen-controls">
            <button @click="toggleAdvancedPanel" class="advanced-btn" title="é«˜çº§åŠŸèƒ½é¢æ¿">
                <i class="fas fa-cog"></i> é«˜çº§åŠŸèƒ½
            </button>
            <button @click="toggleFullscreen" :class="['fullscreen-btn', { active: isFullscreen }]" :title="isFullscreen ? 'é€€å‡ºå…¨å± [F11]' : 'è¿›å…¥å…¨å± [F11]'">
                <i :class="isFullscreen ? 'fas fa-compress' : 'fas fa-expand'"></i>
                {{ isFullscreen ? 'é€€å‡ºå…¨å±' : 'å…¨å±æ¨¡å¼' }}
            </button>
            <a href="../index.html" class="back-btn" title="è¿”å›ä¸»é¡µ [ESC]">
                <i class="fas fa-arrow-left"></i> è¿”å›ä¸»é¡µ
            </a>
        </div>

        <!-- é«˜çº§åŠŸèƒ½é¢æ¿ -->
        <div v-if="showAdvancedPanel" class="advanced-panel">
            <div class="panel-header">
                <h3><i class="fas fa-brain"></i> AIåŠ©æ‰‹é«˜çº§åŠŸèƒ½</h3>
                <button @click="showAdvancedPanel = false" class="close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="panel-content">
                <!-- åŠŸèƒ½å¼€å…³ -->
                <div class="feature-section">
                    <h4><i class="fas fa-toggle-on"></i> åŠŸèƒ½å¼€å…³</h4>
                    <div class="feature-grid">
                        <div class="feature-item">
                            <label class="switch">
                                <input type="checkbox" v-model="advancedFeatures.mathMode">
                                <span class="slider"></span>
                            </label>
                            <span>æ•°å­¦æ¨¡å¼</span>
                        </div>
                        <div class="feature-item">
                            <label class="switch">
                                <input type="checkbox" v-model="advancedFeatures.expertMode">
                                <span class="slider"></span>
                            </label>
                            <span>ä¸“å®¶æ¨¡å¼</span>
                        </div>
                        <div class="feature-item">
                            <label class="switch">
                                <input type="checkbox" v-model="advancedFeatures.contextMemory">
                                <span class="slider"></span>
                            </label>
                            <span>ä¸Šä¸‹æ–‡è®°å¿†</span>
                        </div>
                        <div class="feature-item">
                            <label class="switch">
                                <input type="checkbox" v-model="advancedFeatures.smartSuggestions">
                                <span class="slider"></span>
                            </label>
                            <span>æ™ºèƒ½å»ºè®®</span>
                        </div>
                    </div>
                </div>

                <!-- ç”¨æˆ·åå¥½ -->
                <div class="preference-section">
                    <h4><i class="fas fa-user-cog"></i> ä¸ªæ€§åŒ–è®¾ç½®</h4>
                    <div class="preference-grid">
                        <div class="preference-item">
                            <label>å›ç­”è¯¦ç»†ç¨‹åº¦:</label>
                            <select v-model="userPreferences.responseLength">
                                <option value="brief">ç®€æ´</option>
                                <option value="normal">æ ‡å‡†</option>
                                <option value="detailed">è¯¦ç»†</option>
                            </select>
                        </div>
                        <div class="preference-item">
                            <label>è§£é‡Šæ°´å¹³:</label>
                            <select v-model="userPreferences.explanationLevel">
                                <option value="beginner">åˆå­¦è€…</option>
                                <option value="intermediate">ä¸­çº§</option>
                                <option value="advanced">é«˜çº§</option>
                            </select>
                        </div>
                        <div class="preference-item">
                            <label>AIä¸ªæ€§:</label>
                            <select v-model="aiPersonality">
                                <option value="friendly">å‹å¥½</option>
                                <option value="professional">ä¸“ä¸š</option>
                                <option value="academic">å­¦æœ¯</option>
                                <option value="casual">éšæ„</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- ä¼šè¯ç®¡ç† -->
                <div class="session-section">
                    <h4><i class="fas fa-history"></i> ä¼šè¯ç®¡ç†</h4>
                    <div class="session-controls">
                        <button @click="saveCurrentSession" class="session-btn">
                            <i class="fas fa-save"></i> ä¿å­˜ä¼šè¯
                        </button>
                        <button @click="loadSessionHistory" class="session-btn">
                            <i class="fas fa-folder-open"></i> å†å²ä¼šè¯
                        </button>
                        <button @click="exportChat" class="session-btn">
                            <i class="fas fa-download"></i> å¯¼å‡ºå¯¹è¯
                        </button>
                        <button @click="clearAllHistory" class="session-btn danger">
                            <i class="fas fa-trash"></i> æ¸…ç©ºå†å²
                        </button>
                    </div>
                </div>

                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                <div class="stats-section">
                    <h4><i class="fas fa-chart-bar"></i> ä¼šè¯ç»Ÿè®¡</h4>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">{{ sessionStats.questionsAsked }}</span>
                            <span class="stat-label">æé—®æ¬¡æ•°</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">{{ sessionStats.topicsDiscussed.size }}</span>
                            <span class="stat-label">è®¨è®ºè¯é¢˜</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">{{ formatDuration(sessionStats.timeSpent) }}</span>
                            <span class="stat-label">ä½¿ç”¨æ—¶é•¿</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <div v-if="!loading" class="main-content">
            <!-- é¡µé¢æ ‡é¢˜ -->
            <h1 class="page-title">ğŸ¤– AIå­¦ä¹ åŠ©æ‰‹</h1>
            <p class="page-subtitle">æ™ºèƒ½é—®ç­”è§£æƒ‘ï¼Œä¸ªæ€§åŒ–å­¦ä¹ å»ºè®®ï¼Œ24å°æ—¶åœ¨çº¿è¾…å¯¼</p>

            <!-- èŠå¤©å®¹å™¨ -->
            <div class="chat-container">
                <div class="chat-header">
                    <i class="fas fa-robot ai-icon"></i>
                    AIåŠ©æ‰‹ - åœ¨çº¿çŠ¶æ€
                    <span v-if="isTyping" style="margin-left: auto; font-size: 0.9em;">æ­£åœ¨è¾“å…¥...</span>
                </div>

                <div class="chat-messages" ref="chatMessages">
                    <div v-for="message in messages" :key="message.id" :class="['message', message.sender]">
                        <div class="message-content" v-html="message.content"></div>
                        <div class="message-time">{{ formatTime(message.timestamp) }}</div>
                    </div>
                </div>

                <div class="chat-input">
                    <div class="input-container">
                        <div class="input-wrapper">
                            <textarea
                                v-model="currentMessage"
                                @keydown.enter="handleEnter"
                                class="message-input"
                                placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."
                                :disabled="isTyping"
                            ></textarea>
                            <div class="input-tools">
                                <button @click="toggleVoiceInput" :class="['voice-btn', { active: isRecording }]" title="è¯­éŸ³è¾“å…¥">
                                    <i :class="isRecording ? 'fas fa-stop' : 'fas fa-microphone'"></i>
                                </button>
                                <button @click="toggleMathInput" :class="['math-btn', { active: mathInputMode }]" title="æ•°å­¦å…¬å¼è¾“å…¥">
                                    <i class="fas fa-square-root-alt"></i>
                                </button>
                                <button @click="insertTemplate" class="template-btn" title="æ’å…¥æ¨¡æ¿">
                                    <i class="fas fa-file-alt"></i>
                                </button>
                            </div>
                        </div>
                        <button @click="sendMessage" :disabled="!currentMessage.trim() || isTyping" class="send-btn">
                            <i class="fas fa-paper-plane"></i>
                            å‘é€
                        </button>
                    </div>

                    <!-- æ•°å­¦å…¬å¼è¾“å…¥é¢æ¿ -->
                    <div v-if="mathInputMode" class="math-input-panel">
                        <div class="math-symbols">
                            <button v-for="symbol in mathSymbols" :key="symbol.name"
                                    @click="insertMathSymbol(symbol.latex)"
                                    :title="symbol.name"
                                    class="symbol-btn">
                                {{ symbol.display }}
                            </button>
                        </div>
                        <div class="math-templates">
                            <button v-for="template in mathTemplates" :key="template.name"
                                    @click="insertMathTemplate(template.latex)"
                                    :title="template.name"
                                    class="template-btn-small">
                                {{ template.name }}
                            </button>
                        </div>
                    </div>

                    <!-- è¯­éŸ³è¯†åˆ«çŠ¶æ€ -->
                    <div v-if="isRecording" class="voice-status">
                        <div class="voice-animation">
                            <div class="voice-wave"></div>
                            <div class="voice-wave"></div>
                            <div class="voice-wave"></div>
                        </div>
                        <span>æ­£åœ¨å¬å–æ‚¨çš„è¯­éŸ³...</span>
                    </div>
                </div>
            </div>

            <!-- å¿«é€Ÿå»ºè®® -->
            <div class="suggestions-section">
                <h3 class="suggestions-title">ğŸ’¡ å¿«é€Ÿæé—®å»ºè®®</h3>
                <div class="suggestions-grid">
                    <div v-for="suggestion in suggestions" :key="suggestion" class="suggestion-item" @click="selectSuggestion(suggestion)">
                        {{ suggestion }}
                    </div>
                </div>
            </div>

            <!-- å¿«æ·é”®æç¤º -->
            <div class="shortcuts-hint">
                <i class="fas fa-keyboard"></i> 
                å¿«æ·é”®: Enter-å‘é€ | F11-å…¨å± | ESC-é€€å‡º | Ctrl+L-æ¸…ç©ºå¯¹è¯
            </div>

            <!-- AIæ™ºèƒ½æ¨å¯¼åŠŸèƒ½ -->
            <div class="ai-derivation-section">
                <div class="section-title">ğŸ¤– AIæ™ºèƒ½æ¨å¯¼åŠ©æ‰‹</div>
                
                <div class="derivation-card">
                    <div class="card-title">è‡ªåŠ¨å…¬å¼æ¨å¯¼</div>
                    <div class="card-content">
                        <p>AIåŠ©æ‰‹å¯ä»¥è‡ªåŠ¨æ¨å¯¼å¤æ‚çš„æµä½“åŠ›å­¦å…¬å¼ï¼Œæä¾›è¯¦ç»†çš„æ­¥éª¤åˆ†è§£ï¼š</p>
                        
                        <div class="derivation-example">
                            <div class="example-title">ä¼¯åŠªåˆ©æ–¹ç¨‹æ¨å¯¼</div>
                            <div class="derivation-steps">
                                <div class="derivation-step">
                                    <div class="step-number">1</div>
                                    <div class="step-title">ä»æ¬§æ‹‰æ–¹ç¨‹å‡ºå‘</div>
                                    <div class="step-description">æ¬§æ‹‰æ–¹ç¨‹æ˜¯ç†æƒ³æµä½“è¿åŠ¨çš„åŸºæœ¬æ–¹ç¨‹ï¼Œæè¿°äº†æµä½“å¾®å…ƒçš„å—åŠ›å¹³è¡¡ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">æ¬§æ‹‰æ–¹ç¨‹</div>
                                        $$\frac{\partial \vec{v}}{\partial t} + (\vec{v} \cdot \nabla)\vec{v} = -\frac{1}{\rho}\nabla p + \vec{g}$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">2</div>
                                    <div class="step-title">å¯¹äºå®šå¸¸æµåŠ¨</div>
                                    <div class="step-description">å®šå¸¸æµåŠ¨ä¸­ï¼Œé€Ÿåº¦åœºä¸éšæ—¶é—´å˜åŒ–ï¼Œæ—¶é—´å¯¼æ•°é¡¹ä¸ºé›¶ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">å®šå¸¸æ¡ä»¶</div>
                                        $$\frac{\partial \vec{v}}{\partial t} = 0$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">3</div>
                                    <div class="step-title">æ²¿æµçº¿ç§¯åˆ†</div>
                                    <div class="step-description">æ²¿æµçº¿ç§¯åˆ†æ¬§æ‹‰æ–¹ç¨‹ï¼Œå°†çŸ¢é‡æ–¹ç¨‹è½¬åŒ–ä¸ºæ ‡é‡æ–¹ç¨‹ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">ç§¯åˆ†å½¢å¼</div>
                                        âˆ«[(<span class="vector single-letter">v</span> Â· âˆ‡)<span class="vector single-letter">v</span>] Â· d<span class="vector single-letter">s</span> = âˆ«[-<span class="fraction"><span class="numerator">1</span><span class="denominator">Ï</span></span>âˆ‡p + <span class="vector single-letter">g</span>] Â· d<span class="vector single-letter">s</span>
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">4</div>
                                    <div class="step-title">åˆ©ç”¨å‘é‡æ’ç­‰å¼</div>
                                    <div class="step-description">ä½¿ç”¨å‘é‡åˆ†æä¸­çš„æ’ç­‰å¼ï¼Œå°†å¯¹æµé¡¹è½¬åŒ–ä¸ºæ¢¯åº¦å½¢å¼ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">å‘é‡æ’ç­‰å¼</div>
                                        (<span class="vector single-letter">v</span> Â· âˆ‡)<span class="vector single-letter">v</span> = âˆ‡(<span class="fraction"><span class="numerator">vÂ²</span><span class="denominator">2</span></span>) - <span class="vector single-letter">v</span> Ã— (âˆ‡ Ã— <span class="vector single-letter">v</span>)
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">5</div>
                                    <div class="step-title">å¯¹äºæ— æ—‹æµåŠ¨</div>
                                    <div class="step-description">æ— æ—‹æµåŠ¨ä¸­ï¼Œé€Ÿåº¦åœºçš„æ—‹åº¦ä¸ºé›¶ï¼Œç®€åŒ–äº†æ–¹ç¨‹å½¢å¼ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">æ— æ—‹æ¡ä»¶</div>
                                        $$\nabla \times \vec{v} = 0$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">6</div>
                                    <div class="step-title">ç§¯åˆ†å¾—åˆ°ä¼¯åŠªåˆ©æ–¹ç¨‹</div>
                                    <div class="step-description">æœ€ç»ˆç§¯åˆ†å¾—åˆ°ä¼¯åŠªåˆ©æ–¹ç¨‹ï¼Œæè¿°äº†æ²¿æµçº¿çš„æœºæ¢°èƒ½å®ˆæ’ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">ä¼¯åŠªåˆ©æ–¹ç¨‹</div>
                                        $$\frac{v^2}{2} + \frac{p}{\rho} + gz = å¸¸æ•°$$
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="derivation-card">
                    <div class="card-title">æ™ºèƒ½æ­¥éª¤åˆ†è§£</div>
                    <div class="card-content">
                        <p>AIå¯ä»¥å°†å¤æ‚æ¨å¯¼åˆ†è§£ä¸ºç®€å•æ˜“æ‡‚çš„æ­¥éª¤ï¼š</p>
                        
                        <div class="derivation-example">
                            <div class="example-title">Navier-Stokesæ–¹ç¨‹æ¨å¯¼</div>
                            <div class="derivation-steps">
                                <div class="derivation-step">
                                    <div class="step-number">1</div>
                                    <div class="step-title">åŸºäºç‰›é¡¿ç¬¬äºŒå®šå¾‹</div>
                                    <div class="step-description">æµä½“å¾®å…ƒçš„è¿åŠ¨éµå¾ªç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼ŒåŠ›ç­‰äºè´¨é‡ä¹˜ä»¥åŠ é€Ÿåº¦ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">ç‰›é¡¿ç¬¬äºŒå®šå¾‹</div>
                                        $$F = ma$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">2</div>
                                    <div class="step-title">æµä½“å¾®å…ƒå—åŠ›åˆ†æ</div>
                                    <div class="step-description">æµä½“å¾®å…ƒçš„æƒ¯æ€§åŠ›ç­‰äºå¯†åº¦ã€ä½“ç§¯å’Œç‰©è´¨å¯¼æ•°çš„ä¹˜ç§¯ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">æƒ¯æ€§åŠ›</div>
                                        $$F = \rho dV \frac{D\vec{v}}{Dt}$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">3</div>
                                    <div class="step-title">è¡¨é¢åŠ›ï¼ˆå‹åŠ›æ¢¯åº¦ï¼‰</div>
                                    <div class="step-description">å‹åŠ›æ¢¯åº¦äº§ç”Ÿçš„è¡¨é¢åŠ›ï¼Œæ–¹å‘æŒ‡å‘å‹åŠ›é™ä½çš„æ–¹å‘ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">å‹åŠ›æ¢¯åº¦åŠ›</div>
                                        $$F_p = -\nabla p dV$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">4</div>
                                    <div class="step-title">ä½“ç§¯åŠ›ï¼ˆé‡åŠ›ï¼‰</div>
                                    <div class="step-description">é‡åŠ›æ˜¯ä½œç”¨åœ¨æµä½“å¾®å…ƒä¸Šçš„ä½“ç§¯åŠ›ï¼Œä¸å¯†åº¦æˆæ­£æ¯”ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">é‡åŠ›</div>
                                        $$F_g = \rho \vec{g} dV$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">5</div>
                                    <div class="step-title">ç²˜æ€§åŠ›</div>
                                    <div class="step-description">ç²˜æ€§åŠ›ç”±é€Ÿåº¦æ¢¯åº¦çš„äºŒé˜¶å¯¼æ•°äº§ç”Ÿï¼Œä¸ç²˜æ€§ç³»æ•°æˆæ­£æ¯”ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">ç²˜æ€§åŠ›</div>
                                        $$F_v = \mu \nabla^2 \vec{v} dV$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">6</div>
                                    <div class="step-title">åŠ›çš„å¹³è¡¡</div>
                                    <div class="step-description">æ‰€æœ‰åŠ›çš„å¹³è¡¡å¾—åˆ°Navier-Stokesæ–¹ç¨‹ï¼Œè¿™æ˜¯ç²˜æ€§æµä½“è¿åŠ¨çš„åŸºæœ¬æ–¹ç¨‹ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">Navier-Stokesæ–¹ç¨‹</div>
                                        $$\rho \frac{D\vec{v}}{Dt} = -\nabla p + \rho \vec{g} + \mu \nabla^2 \vec{v}$$
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="derivation-card">
                    <div class="card-title">æ™ºèƒ½æç¤ºç³»ç»Ÿ</div>
                    <div class="card-content">
                        <p>AIæä¾›æ™ºèƒ½æç¤ºï¼Œå¸®åŠ©ç†è§£æ¨å¯¼è¿‡ç¨‹ä¸­çš„å…³é”®æ¦‚å¿µï¼š</p>
                        
                        <div class="hint-system">
                            <div class="hint-item">
                                <div class="hint-title">ğŸ’¡ è¿ç»­æ€§æ–¹ç¨‹æç¤º</div>
                                <div class="hint-content">
                                    <p><strong>å…³é”®æ¦‚å¿µï¼š</strong>è´¨é‡å®ˆæ’</p>
                                    <p><strong>ç‰©ç†æ„ä¹‰ï¼š</strong>æµå…¥æ§åˆ¶ä½“çš„è´¨é‡ç­‰äºæµå‡ºæ§åˆ¶ä½“çš„è´¨é‡</p>
                                    <div class="math-formula">
                                        <div class="formula-label">è¿ç»­æ€§æ–¹ç¨‹</div>
                                        $$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \vec{v}) = 0$$
                                    </div>
                                    <p><strong>åº”ç”¨åœºæ™¯ï¼š</strong>ç®¡é“æµåŠ¨ã€æµé‡è®¡ç®—</p>
                                </div>
                            </div>
                            
                            <div class="hint-item">
                                <div class="hint-title">ğŸ’¡ ä¼¯åŠªåˆ©æ–¹ç¨‹æç¤º</div>
                                <div class="hint-content">
                                    <p><strong>å…³é”®æ¦‚å¿µï¼š</strong>æœºæ¢°èƒ½å®ˆæ’</p>
                                    <p><strong>ç‰©ç†æ„ä¹‰ï¼š</strong>æ²¿æµçº¿æ€»æ°´å¤´ä¿æŒä¸å˜</p>
                                    <div class="math-formula">
                                        <div class="formula-label">ä¼¯åŠªåˆ©æ–¹ç¨‹</div>
                                        $$\frac{v^2}{2g} + \frac{p}{\rho g} + z = H$$
                                    </div>
                                    <p><strong>åº”ç”¨åœºæ™¯ï¼š</strong>æ–‡ä¸˜é‡Œç®¡ã€æœºç¿¼å‡åŠ›</p>
                                </div>
                            </div>
                            
                            <div class="hint-item">
                                <div class="hint-title">ğŸ’¡ é›·è¯ºæ•°æç¤º</div>
                                <div class="hint-content">
                                    <p><strong>å…³é”®æ¦‚å¿µï¼š</strong>æƒ¯æ€§åŠ›ä¸ç²˜æ€§åŠ›çš„æ¯”å€¼</p>
                                    <p><strong>ç‰©ç†æ„ä¹‰ï¼š</strong>åˆ¤æ–­æµåŠ¨çŠ¶æ€çš„é‡è¦å‚æ•°</p>
                                    <div class="math-formula">
                                        <div class="formula-label">é›·è¯ºæ•°</div>
                                        $$Re = \frac{\rho V L}{\mu}$$
                                    </div>
                                    <p><strong>åº”ç”¨åœºæ™¯ï¼š</strong>æµåŠ¨çŠ¶æ€åˆ¤æ–­ã€ç›¸ä¼¼æ€§åˆ†æ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="derivation-card">
                    <div class="card-title">äº¤äº’å¼æ¨å¯¼ç»ƒä¹ </div>
                    <div class="card-content">
                        <p>AIæä¾›äº¤äº’å¼æ¨å¯¼ç»ƒä¹ ï¼Œå¸®åŠ©å·©å›ºç†è§£ï¼š</p>
                        
                        <div class="interactive-exercise">
                            <div class="exercise-title">ç»ƒä¹ 1ï¼šæ¨å¯¼é™æ°´å‹å¼ºåˆ†å¸ƒ</div>
                            <div class="exercise-steps">
                                <div class="derivation-step">
                                    <div class="step-number">1</div>
                                    <div class="step-title">ä»æµä½“é™åŠ›å­¦åŸºæœ¬æ–¹ç¨‹å¼€å§‹</div>
                                    <div class="step-description">æµä½“é™åŠ›å­¦åŸºæœ¬æ–¹ç¨‹æè¿°äº†é™æ­¢æµä½“ä¸­å‹å¼ºçš„å˜åŒ–è§„å¾‹ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">é™åŠ›å­¦åŸºæœ¬æ–¹ç¨‹</div>
                                        $$\nabla p = \rho \vec{g}$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">2</div>
                                    <div class="step-title">å¯¹äºé‡åŠ›åœºç®€åŒ–</div>
                                    <div class="step-description">åœ¨é‡åŠ›åœºä¸­ï¼Œå‹å¼ºæ¢¯åº¦ä¸»è¦æ²¿å‚ç›´æ–¹å‘å˜åŒ–ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">é‡åŠ›åœºç®€åŒ–</div>
                                        $$\frac{dp}{dz} = -\rho g$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">3</div>
                                    <div class="step-title">ç§¯åˆ†å¾—åˆ°ç»“æœ</div>
                                    <div class="step-description">å¯¹å‹å¼ºæ¢¯åº¦æ–¹ç¨‹ç§¯åˆ†ï¼Œå¾—åˆ°å‹å¼ºéšé«˜åº¦çš„å˜åŒ–å…³ç³»ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">ç§¯åˆ†ç»“æœ</div>
                                        $$p - p_0 = -\rho g(z - z_0)$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">4</div>
                                    <div class="step-title">æœ€ç»ˆè¡¨è¾¾å¼</div>
                                    <div class="step-description">ä»¤æ·±åº¦h = zâ‚€ - zï¼Œå¾—åˆ°é™æ°´å‹å¼ºåˆ†å¸ƒçš„æœ€ç»ˆè¡¨è¾¾å¼ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">é™æ°´å‹å¼ºåˆ†å¸ƒ</div>
                                        $$p = p_0 + \rho g h$$
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="interactive-exercise">
                            <div class="exercise-title">ç»ƒä¹ 2ï¼šæ¨å¯¼å±‚æµç®¡é“é€Ÿåº¦åˆ†å¸ƒ</div>
                            <div class="exercise-steps">
                                <div class="derivation-step">
                                    <div class="step-number">1</div>
                                    <div class="step-title">ä»Navier-Stokesæ–¹ç¨‹å¼€å§‹</div>
                                    <div class="step-description">åœ†æŸ±åæ ‡ç³»ä¸‹çš„Navier-Stokesæ–¹ç¨‹ï¼Œæè¿°åœ†ç®¡å±‚æµçš„åŸºæœ¬æ–¹ç¨‹ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">Navier-Stokesæ–¹ç¨‹</div>
                                        $$\mu \frac{1}{r} \frac{d}{dr}(r \frac{du}{dr}) = \frac{dp}{dx}$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">2</div>
                                    <div class="step-title">ç¬¬ä¸€æ¬¡ç§¯åˆ†</div>
                                    <div class="step-description">å¯¹å¾„å‘åæ ‡rç§¯åˆ†ï¼Œå¾—åˆ°é€Ÿåº¦æ¢¯åº¦çš„è¡¨è¾¾å¼ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">ç¬¬ä¸€æ¬¡ç§¯åˆ†</div>
                                        $$r \frac{du}{dr} = \frac{r^2}{2\mu} \frac{dp}{dx} + C_1$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">3</div>
                                    <div class="step-title">åº”ç”¨è¾¹ç•Œæ¡ä»¶</div>
                                    <div class="step-description">åœ¨ç®¡é“ä¸­å¿ƒr=0å¤„ï¼Œé€Ÿåº¦æ¢¯åº¦ä¸ºé›¶ï¼Œç¡®å®šç§¯åˆ†å¸¸æ•°ã€‚</div>
                                    <div class="math-formula">
                                        <div class="formula-label">è¾¹ç•Œæ¡ä»¶</div>
                                        $$C_1 = 0$$
                                    </div>
                                </div>
                                
                                <div class="derivation-step">
                                    <div class="step-number">4</div>
                                    <div class="step-title">ç¬¬äºŒæ¬¡ç§¯åˆ†</div>
                                    <div class="step-description">å†æ¬¡ç§¯åˆ†å¾—åˆ°é€Ÿåº¦åˆ†å¸ƒå‡½æ•°ï¼Œåº”ç”¨å£é¢è¾¹ç•Œæ¡ä»¶ã€‚</div>
                                <div class="formula">$$u = \frac{r^2}{4\mu} \frac{dp}{dx} + C_2$$</div>
                                
                                <div class="step-prompt">è¾¹ç•Œæ¡ä»¶ $r = R$ æ—¶ $u = 0$ å¾—åˆ°æœ€ç»ˆç»“æœï¼š</div>
                                <div class="formula">$$u(r) = \frac{R^2}{4\mu}(-\frac{dp}{dx})(1 - \frac{r^2}{R^2})$$</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é«˜çº§æ¨å¯¼åŠŸèƒ½ -->
            <div class="advanced-derivation-section">
                <div class="section-title">ğŸš€ é«˜çº§æ¨å¯¼åŠŸèƒ½</div>
                
                <div class="derivation-card">
                    <div class="card-title">å¤šæ­¥éª¤æ¨å¯¼éªŒè¯</div>
                    <div class="card-content">
                        <p>AIå¯ä»¥éªŒè¯æ¨å¯¼è¿‡ç¨‹çš„æ­£ç¡®æ€§ï¼Œå¹¶æä¾›æ”¹è¿›å»ºè®®ï¼š</p>
                        
                        <div class="verification-example">
                            <div class="example-title">æ¶¡é‡è¾“è¿æ–¹ç¨‹éªŒè¯</div>
                            <div class="verification-steps">
                                <div class="step">åŸå§‹æ–¹ç¨‹ï¼šNavier-Stokesæ–¹ç¨‹</div>
                                <div class="formula">$$\rho(\frac{\partial \vec{v}}{\partial t} + (\vec{v} \cdot \nabla)\vec{v}) = -\nabla p + \rho\vec{g} + \mu\nabla^2\vec{v}$$</div>
                                
                                <div class="step">å–æ—‹åº¦æ“ä½œ</div>
                                <div class="formula">$$\nabla \times [\rho(\frac{\partial \vec{v}}{\partial t} + (\vec{v} \cdot \nabla)\vec{v})] = \nabla \times [-\nabla p + \rho\vec{g} + \mu\nabla^2\vec{v}]$$</div>
                                
                                <div class="step">åˆ©ç”¨å‘é‡æ’ç­‰å¼</div>
                                <div class="formula">$$\nabla \times (\nabla p) = 0, \quad \nabla \times \vec{g} = 0$$</div>
                                
                                <div class="step">å¾—åˆ°æ¶¡é‡è¾“è¿æ–¹ç¨‹</div>
                                <div class="formula">$$\frac{D\vec{\omega}}{Dt} = (\vec{\omega} \cdot \nabla)\vec{v} + \nu\nabla^2\vec{\omega}$$</div>
                                
                                <div class="verification-result">
                                    <div class="result-title">âœ… éªŒè¯ç»“æœï¼šæ¨å¯¼æ­£ç¡®</div>
                                    <div class="result-details">
                                        <p>â€¢ å‘é‡è¿ç®—æ­£ç¡®</p>
                                        <p>â€¢ ç‰©ç†æ„ä¹‰æ˜ç¡®</p>
                                        <p>â€¢ æ•°å­¦å½¢å¼åˆç†</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="derivation-card">
                    <div class="card-title">æ™ºèƒ½é”™è¯¯æ£€æµ‹</div>
                    <div class="card-content">
                        <p>AIå¯ä»¥æ£€æµ‹æ¨å¯¼è¿‡ç¨‹ä¸­çš„å¸¸è§é”™è¯¯ï¼š</p>
                        
                        <div class="error-detection">
                            <div class="error-example">
                                <div class="error-title">âŒ å¸¸è§é”™è¯¯1ï¼šå¿½ç•¥è¾¹ç•Œæ¡ä»¶</div>
                                <div class="error-description">
                                    <p>åœ¨æ¨å¯¼å±‚æµç®¡é“æµåŠ¨æ—¶ï¼Œå®¹æ˜“å¿½ç•¥è¾¹ç•Œæ¡ä»¶ï¼š</p>
                                    <div class="formula">$$r = 0: \frac{du}{dr} = 0$$</div>
                                    <div class="formula">$$r = R: u = 0$$</div>
                                    <p>è¿™äº›è¾¹ç•Œæ¡ä»¶å¯¹äºç¡®å®šç§¯åˆ†å¸¸æ•°è‡³å…³é‡è¦ã€‚</p>
                                </div>
                            </div>
                            
                            <div class="error-example">
                                <div class="error-title">âŒ å¸¸è§é”™è¯¯2ï¼šå‘é‡è¿ç®—é”™è¯¯</div>
                                <div class="error-description">
                                    <p>åœ¨æ¨å¯¼ä¼¯åŠªåˆ©æ–¹ç¨‹æ—¶ï¼Œå®¹æ˜“æ··æ·†å‘é‡è¿ç®—ï¼š</p>
                                    <div class="formula">$$(\vec{v} \cdot \nabla)\vec{v} \neq \vec{v} \cdot (\nabla \vec{v})$$</div>
                                    <p>æ­£ç¡®çš„å±•å¼€åº”è¯¥æ˜¯ï¼š</p>
                                    <div class="formula">$$(\vec{v} \cdot \nabla)\vec{v} = \nabla(\frac{v^2}{2}) - \vec{v} \times (\nabla \times \vec{v})$$</div>
                                </div>
                            </div>
                            
                            <div class="error-example">
                                <div class="error-title">âŒ å¸¸è§é”™è¯¯3ï¼šå•ä½ä¸ä¸€è‡´</div>
                                <div class="error-description">
                                    <p>åœ¨æ¨å¯¼è¿‡ç¨‹ä¸­å®¹æ˜“å¿½ç•¥å•ä½ä¸€è‡´æ€§ï¼š</p>
                                    <div class="formula">$$[p] = \text{Pa}, \quad [\rho] = \text{kg/m}^3, \quad [g] = \text{m/s}^2$$</div>
                                    <p>ç¡®ä¿æ‰€æœ‰é¡¹çš„å•ä½ä¸€è‡´æ˜¯æ¨å¯¼æ­£ç¡®æ€§çš„é‡è¦ä¿è¯ã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AIçŠ¶æ€æŒ‡ç¤ºå™¨ -->
        <div :class="['ai-status', { thinking: isTyping }]">
            <i class="fas fa-circle" :style="{ color: isTyping ? '#feca57' : '#43e97b' }"></i>
            {{ isTyping ? 'AIæ€è€ƒä¸­...' : 'AIåœ¨çº¿' }}
        </div>
    </div>

    <!-- Vue.js åº”ç”¨è„šæœ¬ -->
    <script>
        // é…ç½®Vueä»¥å‡å°‘å¼€å‘æ¨¡å¼è­¦å‘Š
        const originalWarn = console.warn;
        console.warn = function(message, ...args) {
            // è¿‡æ»¤æ‰Vueæ¨¡æ¿ç¼–è¯‘è­¦å‘Š
            if (typeof message === 'string' && message.includes('Tags with side effect')) {
                return; // å¿½ç•¥è¿™ä¸ªç‰¹å®šè­¦å‘Š
            }
            if (typeof message === 'string' && message.includes('Template compilation error')) {
                return; // å¿½ç•¥æ¨¡æ¿ç¼–è¯‘é”™è¯¯
            }
            originalWarn.apply(console, [message, ...args]);
        };

        const { createApp } = Vue;

        const app = createApp({
            data() {
                return {
                    loading: false, // ç›´æ¥è®¾ç½®ä¸ºfalseï¼Œä¸æ˜¾ç¤ºåŠ è½½ç•Œé¢
                    isFullscreen: false,
                    isTyping: false,
                    currentMessage: '',
                    messages: [
                        {
                            id: 1,
                            sender: 'ai',
                            content: 'ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯AIå­¦ä¹ åŠ©æ‰‹ï¼Œä¸“é—¨å¸®åŠ©æ‚¨å­¦ä¹ æµä½“åŠ›å­¦ã€‚è¯·éšæ—¶å‘æˆ‘æé—®ï¼',
                            timestamp: new Date()
                        }
                    ],
                    suggestions: [
                        // åŸºç¡€æ¦‚å¿µ
                        'ä»€ä¹ˆæ˜¯æµä½“ï¼Ÿæµä½“æœ‰å“ªäº›åŸºæœ¬ç‰¹æ€§ï¼Ÿ',
                        'æµä½“çš„ä¸»è¦ç‰©ç†æ€§è´¨æœ‰å“ªäº›ï¼Ÿ',
                        'æµä½“é™åŠ›å­¦åŸºæœ¬åŸç†',
                        'å¦‚ä½•æµ‹é‡æµä½“å‹åŠ›ï¼Ÿ',

                        // è¿åŠ¨å­¦ä¸åŠ¨åŠ›å­¦
                        'æµä½“è¿åŠ¨å­¦åŸºæœ¬æ¦‚å¿µ',
                        'ä»€ä¹ˆæ˜¯ä¼¯åŠªåˆ©æ–¹ç¨‹ï¼Ÿ',
                        'åŠ¨é‡æ–¹ç¨‹çš„åº”ç”¨',
                        'è¿ç»­æ€§æ–¹ç¨‹çš„æ¨å¯¼è¿‡ç¨‹',

                        // ç²˜æ€§æµåŠ¨
                        'ä»€ä¹ˆæ˜¯ç²˜æ€§ï¼Ÿç‰›é¡¿ç²˜æ€§å®šå¾‹',
                        'å±‚æµå’Œæ¹æµçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ',
                        'å¦‚ä½•è®¡ç®—é›·è¯ºæ•°ï¼Ÿ',
                        'æ¨å¯¼Navier-Stokesæ–¹ç¨‹',

                        // è¾¹ç•Œå±‚ç†è®º
                        'è¾¹ç•Œå±‚ç†è®ºçš„åŸºæœ¬æ¦‚å¿µ',
                        'è¾¹ç•Œå±‚åˆ†ç¦»ç°è±¡',
                        'Blasiusè§£çš„ç‰©ç†æ„ä¹‰',

                        // ç®¡é“æµåŠ¨
                        'ç®¡é“æµåŠ¨çš„ç‰¹ç‚¹',
                        'å¦‚ä½•è®¡ç®—ç®¡é“å‹åŠ›æŸå¤±ï¼Ÿ',
                        'ç®¡ç½‘ç³»ç»Ÿçš„è®¡ç®—æ–¹æ³•',

                        // ç»•æµ
                        'åœ†æŸ±ç»•æµç°è±¡åˆ†æ',
                        'åˆ†ææœºç¿¼å‡åŠ›äº§ç”Ÿæœºç†',
                        'ä»€ä¹ˆæ˜¯é˜»åŠ›ç³»æ•°ï¼Ÿ',

                        // é«˜çº§ç†è®º
                        'å¯å‹ç¼©æµåŠ¨åŸºç¡€',
                        'è§£é‡Šæ¶¡é‡è¾“è¿æ–¹ç¨‹',
                        'ç›¸ä¼¼ç†è®ºä¸é‡çº²åˆ†æ',

                        // å·¥ç¨‹åº”ç”¨
                        'è®¾è®¡æ–‡ä¸˜é‡Œæµé‡è®¡',
                        'æ³µçš„æ€§èƒ½æ›²çº¿åˆ†æ',
                        'æµä½“æµ‹é‡æŠ€æœ¯',
                        'æ±½èš€ç°è±¡åŠå…¶é˜²æ­¢'
                    ],
                    advancedFeatures: {
                        voiceInput: false,
                        mathMode: false,
                        expertMode: false,
                        multiLanguage: false,
                        darkMode: false,
                        autoSave: true,
                        realTimeLatex: true,
                        codeExecution: false,
                        imageAnalysis: false,
                        documentUpload: false
                    },
                    chatHistory: [],
                    bookmarks: [],
                    currentTopic: null,
                    learningPath: [],
                    userPreferences: {
                        responseLength: 'detailed', // brief, normal, detailed
                        explanationLevel: 'intermediate', // beginner, intermediate, advanced
                        includeExamples: true,
                        includeFormulas: true,
                        includeApplications: true,
                        preferredLanguage: 'zh-CN'
                    },
                    aiPersonality: 'professional', // friendly, professional, academic, casual
                    contextMemory: new Map(),
                    sessionStats: {
                        questionsAsked: 0,
                        topicsDiscussed: new Set(),
                        timeSpent: 0,
                        startTime: new Date()
                    },
                    notification: {
                        show: false,
                        message: '',
                        type: 'info'
                    },
                    networkStatus: null,
                    loadingTimeout: null,
                    // é«˜çº§åŠŸèƒ½çŠ¶æ€
                    advancedFeatures: {
                        voiceInput: false,
                        mathMode: true,
                        expertMode: false,
                        autoSave: true,
                        realTimeLatex: true,
                        contextMemory: true,
                        smartSuggestions: true,
                        multiModal: false
                    },
                    // å¯¹è¯å†å²ç®¡ç†
                    chatSessions: [],
                    currentSessionId: null,
                    maxHistoryLength: 50,
                    // å­¦ä¹ è·¯å¾„è·Ÿè¸ª
                    learningPath: [],
                    currentTopic: null,
                    topicProgress: new Map(),
                    // ç”¨æˆ·åå¥½è®¾ç½®
                    userPreferences: {
                        responseLength: 'detailed', // brief, normal, detailed
                        explanationLevel: 'intermediate', // beginner, intermediate, advanced
                        includeExamples: true,
                        includeFormulas: true,
                        includeApplications: true,
                        preferredLanguage: 'zh-CN',
                        theme: 'auto', // light, dark, auto
                        fontSize: 'medium' // small, medium, large
                    },
                    // AIä¸ªæ€§åŒ–è®¾ç½®
                    aiPersonality: 'professional', // friendly, professional, academic, casual
                    contextMemory: new Map(),
                    // ä¼šè¯ç»Ÿè®¡
                    sessionStats: {
                        questionsAsked: 0,
                        topicsDiscussed: new Set(),
                        timeSpent: 0,
                        startTime: new Date(),
                        lastActivity: new Date()
                    },
                    // ä¹¦ç­¾å’Œæ”¶è—
                    bookmarks: [],
                    favoriteTopics: [],
                    // å®æ—¶åŠŸèƒ½çŠ¶æ€
                    isRecording: false,
                    speechRecognition: null,
                    mathInputMode: false,
                    showAdvancedPanel: false,
                    // æ•°å­¦ç¬¦å·å’Œæ¨¡æ¿
                    mathSymbols: [
                        { name: 'åˆ†æ•°', latex: '\\frac{}{}', display: 'Â½' },
                        { name: 'å¹³æ–¹æ ¹', latex: '\\sqrt{}', display: 'âˆš' },
                        { name: 'ç§¯åˆ†', latex: '\\int_{}^{}', display: 'âˆ«' },
                        { name: 'æ±‚å’Œ', latex: '\\sum_{}^{}', display: 'âˆ‘' },
                        { name: 'æé™', latex: '\\lim_{}', display: 'lim' },
                        { name: 'åå¯¼æ•°', latex: '\\frac{\\partial}{\\partial}', display: 'âˆ‚' },
                        { name: 'æ¢¯åº¦', latex: '\\nabla', display: 'âˆ‡' },
                        { name: 'æ— ç©·å¤§', latex: '\\infty', display: 'âˆ' },
                        { name: 'çº¦ç­‰äº', latex: '\\approx', display: 'â‰ˆ' },
                        { name: 'ä¸ç­‰äº', latex: '\\neq', display: 'â‰ ' },
                        { name: 'å°äºç­‰äº', latex: '\\leq', display: 'â‰¤' },
                        { name: 'å¤§äºç­‰äº', latex: '\\geq', display: 'â‰¥' },
                        { name: 'Alpha', latex: '\\alpha', display: 'Î±' },
                        { name: 'Beta', latex: '\\beta', display: 'Î²' },
                        { name: 'Gamma', latex: '\\gamma', display: 'Î³' },
                        { name: 'Delta', latex: '\\delta', display: 'Î´' },
                        { name: 'Epsilon', latex: '\\epsilon', display: 'Îµ' },
                        { name: 'Theta', latex: '\\theta', display: 'Î¸' },
                        { name: 'Lambda', latex: '\\lambda', display: 'Î»' },
                        { name: 'Mu', latex: '\\mu', display: 'Î¼' },
                        { name: 'Pi', latex: '\\pi', display: 'Ï€' },
                        { name: 'Rho', latex: '\\rho', display: 'Ï' },
                        { name: 'Sigma', latex: '\\sigma', display: 'Ïƒ' },
                        { name: 'Tau', latex: '\\tau', display: 'Ï„' },
                        { name: 'Phi', latex: '\\phi', display: 'Ï†' },
                        { name: 'Omega', latex: '\\omega', display: 'Ï‰' }
                    ],
                    mathTemplates: [
                        { name: 'ä¼¯åŠªåˆ©æ–¹ç¨‹', latex: '\\frac{v^2}{2} + \\frac{p}{\\rho} + gz = \\text{å¸¸æ•°}' },
                        { name: 'è¿ç»­æ€§æ–¹ç¨‹', latex: '\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\vec{v}) = 0' },
                        { name: 'NSæ–¹ç¨‹', latex: '\\rho \\frac{D\\vec{v}}{Dt} = -\\nabla p + \\rho \\vec{g} + \\mu \\nabla^2 \\vec{v}' },
                        { name: 'é›·è¯ºæ•°', latex: 'Re = \\frac{\\rho V L}{\\mu}' },
                        { name: 'æ¬§æ‹‰æ–¹ç¨‹', latex: '\\frac{\\partial \\vec{v}}{\\partial t} + (\\vec{v} \\cdot \\nabla)\\vec{v} = -\\frac{1}{\\rho}\\nabla p + \\vec{g}' },
                        { name: 'æ¶¡é‡æ–¹ç¨‹', latex: '\\frac{D\\vec{\\omega}}{Dt} = (\\vec{\\omega} \\cdot \\nabla)\\vec{v} + \\nu\\nabla^2\\vec{\\omega}' }
                    ]
                };
            },

            created() {
                console.log('ğŸ¯ Vueåº”ç”¨åˆ›å»ºå®Œæˆ');
                // ç®€åŒ–åˆ›å»ºé€»è¾‘ï¼Œä¸è®¾ç½®å¤æ‚çš„è¶…æ—¶
            },

            methods: {
                async sendMessage() {
                    if (!this.currentMessage.trim() || this.isTyping) return;

                    const userMessage = {
                        id: Date.now(),
                        sender: 'user',
                        content: this.currentMessage,
                        timestamp: new Date()
                    };

                    this.messages.push(userMessage);

                    // æ›´æ–°ç»Ÿè®¡
                    this.sessionStats.questionsAsked++;
                    this.sessionStats.lastActivity = new Date();

                    // åˆ†æè¯é¢˜å’Œæ›´æ–°å­¦ä¹ è¿›åº¦
                    this.analyzeUserQuestion(this.currentMessage);
                    this.updateLearningProgress(this.currentMessage);
                    const messageText = this.currentMessage;
                    this.currentMessage = '';
                    this.scrollToBottom();

                    // AIæ€è€ƒä¸­ - ç‰¹åˆ«ä¸ºDeepSeek-R1å¢åŠ é•¿æ—¶é—´ç­‰å¾…æç¤º
                    this.isTyping = true;

                    // æ£€æŸ¥æ˜¯å¦æ˜¯æ•°å­¦æ¨å¯¼è¯·æ±‚ï¼Œå¦‚æœæ˜¯ï¼Œæ˜¾ç¤ºç‰¹æ®Šæç¤º
                    const isComplexMath = this.isComplexMathQuestion(messageText);
                    if (isComplexMath) {
                        this.showNotification('ğŸ§  DeepSeek-R1æ­£åœ¨è¿›è¡Œå¤æ‚æ¨ç†ï¼Œå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…...', 'info');
                    }

                    setTimeout(async () => {
                        // ä¸ºé•¿æ—¶é—´æ¨ç†æ·»åŠ è¿›åº¦æç¤º
                        let progressTimer = null;
                        if (isComplexMath) {
                            let progressCount = 0;
                            progressTimer = setInterval(() => {
                                progressCount++;
                                const messages = [
                                    'ğŸ§  DeepSeek-R1æ­£åœ¨æ·±åº¦æ€è€ƒä¸­...',
                                    'ğŸ”¬ æ­£åœ¨åˆ†ææ•°å­¦ç»“æ„...',
                                    'ğŸ“ æ­£åœ¨æ„å»ºæ¨å¯¼è¿‡ç¨‹...',
                                    'âš¡ æ­£åœ¨éªŒè¯è®¡ç®—æ­¥éª¤...',
                                    'ğŸ¯ å³å°†å®Œæˆæ¨ç†...'
                                ];
                                const message = messages[Math.min(progressCount - 1, messages.length - 1)];
                                this.showNotification(message, 'info');
                            }, 30000); // æ¯30ç§’æ›´æ–°ä¸€æ¬¡æç¤º
                        }

                        try {
                            const aiResponse = await this.generateAIResponse(messageText);
                            this.messages.push({
                                id: Date.now() + 1,
                                sender: 'ai',
                                content: aiResponse,
                                timestamp: new Date()
                            });

                            // å¤„ç†AIå›å¤ä¸­çš„æ•°å­¦å…¬å¼
                            this.$nextTick(() => {
                                this.processMathFormulas();
                            });
                        } catch (error) {
                            console.error('AIå›å¤å¤±è´¥:', error);
                            this.messages.push({
                                id: Date.now() + 1,
                                sender: 'ai',
                                content: 'æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ã€‚è¯·ç¨åé‡è¯•ã€‚ğŸ¤–',
                                timestamp: new Date()
                            });

                            // å³ä½¿æ˜¯é”™è¯¯æ¶ˆæ¯ä¹Ÿè¦å¤„ç†å¯èƒ½çš„å…¬å¼
                            this.$nextTick(() => {
                                this.processMathFormulas();
                            });
                        } finally {
                            // æ¸…é™¤è¿›åº¦è®¡æ—¶å™¨
                            if (progressTimer) {
                                clearInterval(progressTimer);
                            }
                            this.isTyping = false;
                            this.scrollToBottom();

                            // å¤„ç†æ–°æ·»åŠ çš„æ•°å­¦å…¬å¼
                            this.$nextTick(() => {
                                this.processMathFormulas();
                            });
                        }
                    }, 1500 + Math.random() * 2000);
                },

                async generateAIResponse(question) {
                    console.log('ğŸ¤– åŠ¨æ€AIåŠ©æ‰‹ç”Ÿæˆå›å¤:', question);
                    
                    // é¦–å…ˆå°è¯•æœ¬åœ°çŸ¥è¯†åº“
                    const localResponse = this.getLocalResponse(question);
                    
                    // å¦‚æœæœ¬åœ°çŸ¥è¯†åº“æœ‰å‡†ç¡®ç­”æ¡ˆï¼Œç›´æ¥è¿”å›
                    if (localResponse && !localResponse.includes('ğŸ’¡ <strong>æç¤ºï¼š</strong>')) {
                        console.log('ğŸ“š ä½¿ç”¨æœ¬åœ°çŸ¥è¯†åº“å›å¤');
                        return localResponse;
                    }
                    
                    // å¦‚æœæœ¬åœ°çŸ¥è¯†åº“æ²¡æœ‰å‡†ç¡®ç­”æ¡ˆï¼Œä¸”AIç³»ç»Ÿå¯ç”¨ï¼Œæ‰è°ƒç”¨AI
                    try {
                        // æ£€æŸ¥æ™ºèƒ½æ¨¡å‹é€‰æ‹©å™¨æ˜¯å¦å¯ç”¨
                        if (window.SmartModelSelector && window.AppConfig) {
                            console.log('ğŸ§  æœ¬åœ°çŸ¥è¯†åº“æ— å‡†ç¡®ç­”æ¡ˆï¼Œè°ƒç”¨æ™ºèƒ½AIç³»ç»Ÿ');
                            
                            // ä½¿ç”¨é…ç½®æ–‡ä»¶å¿«é€Ÿåˆå§‹åŒ–
                            if (!window.smartModelSelectorInstance) {
                                console.log('ğŸ”§ å¿«é€Ÿåˆå§‹åŒ–æ™ºèƒ½æ¨¡å‹é€‰æ‹©å™¨...');
                                const smartConfig = window.AppConfig.api.smartAI;
                                
                                window.smartModelSelectorInstance = await window.SmartModelSelector.init({
                                    apiKey: smartConfig.apiKey,
                                    apiUrl: smartConfig.endpoint,
                                    defaultStrategy: smartConfig.defaultStrategy,
                                    maxRetries: smartConfig.maxRetries,
                                    requestTimeout: smartConfig.requestTimeout,
                                    skipAvailabilityCheck: smartConfig.skipAvailabilityCheck
                                });
                            }
                            
                            // æ™ºèƒ½æ¨¡å‹é€‰æ‹©
                            const modelConfig = this.selectOptimalModel(question);

                            // è°ƒç”¨æ™ºèƒ½AIï¼Œå¸¦å¤‡é€‰æ¨¡å‹é‡è¯•æœºåˆ¶
                            let result;
                            try {
                                result = await window.smartModelSelectorInstance.callAI(question, {
                                    strategy: modelConfig.strategy,
                                    features: modelConfig.features,
                                    maxTokens: modelConfig.maxTokens,
                                    temperature: modelConfig.temperature,
                                    preferredModel: modelConfig.preferredModel,
                                    systemPrompt: modelConfig.systemPrompt,
                                    requestTimeout: modelConfig.requestTimeout // ä¼ é€’è¶…æ—¶é…ç½®
                                });
                                console.log('âœ… AIå›å¤æˆåŠŸ:', result.model);
                            } catch (primaryError) {
                                console.warn('âš ï¸ é¦–é€‰æ¨¡å‹å¤±è´¥ï¼Œå°è¯•å¤‡é€‰æ¨¡å‹:', primaryError.message);

                                // å¦‚æœæ˜¯æ•°å­¦æ¨å¯¼å¤±è´¥ï¼Œå°è¯•å¤‡é€‰æ¨¡å‹
                                if (modelConfig.preferredModel === 'deepseek-r1') {
                                    try {
                                        console.log('ğŸ”„ DeepSeek-R1å¤±è´¥ï¼Œå°è¯•DeepSeek-V3');
                                        result = await window.smartModelSelectorInstance.callAI(question, {
                                            strategy: 'reasoning',
                                            features: ['reasoning', 'math', 'analysis'],
                                            maxTokens: 1500,
                                            temperature: 0.4,
                                            preferredModel: 'deepseek-v3',
                                            systemPrompt: modelConfig.systemPrompt,
                                            requestTimeout: 180000 // 3åˆ†é’Ÿ
                                        });
                                        console.log('âœ… å¤‡é€‰DeepSeek-V3å›å¤æˆåŠŸ:', result.model);
                                    } catch (fallbackError) {
                                        console.error('âŒ DeepSeek-V3ä¹Ÿå¤±è´¥ï¼Œä½¿ç”¨è‡ªåŠ¨é€‰æ‹©:', fallbackError.message);
                                        // æœ€åå°è¯•è‡ªåŠ¨é€‰æ‹©å¯ç”¨æ¨¡å‹
                                        result = await window.smartModelSelectorInstance.callAI(question, {
                                            strategy: 'balanced',
                                            maxTokens: 1000,
                                            temperature: 0.5,
                                            systemPrompt: 'ä½ æ˜¯æµä½“åŠ›å­¦ä¸“å®¶ï¼Œè¯·è¯¦ç»†å›ç­”é—®é¢˜ã€‚',
                                            requestTimeout: 120000 // 2åˆ†é’Ÿ
                                        });
                                        console.log('âœ… è‡ªåŠ¨é€‰æ‹©æ¨¡å‹å›å¤æˆåŠŸ:', result.model);
                                    }
                                } else if (modelConfig.preferredModel === 'deepseek-v3') {
                                    try {
                                        result = await window.smartModelSelectorInstance.callAI(question, {
                                            strategy: 'balanced',
                                            features: ['reasoning', 'math'],
                                            maxTokens: 1500,
                                            temperature: 0.4,
                                            preferredModel: 'auto',
                                            systemPrompt: modelConfig.systemPrompt,
                                            requestTimeout: 90000
                                        });
                                        console.log('âœ… å¤‡é€‰æ¨¡å‹å›å¤æˆåŠŸ:', result.model);
                                    } catch (fallbackError) {
                                        console.error('âŒ å¤‡é€‰æ¨¡å‹ä¹Ÿå¤±è´¥:', fallbackError.message);
                                        throw fallbackError;
                                    }
                                } else {
                                    throw primaryError;
                                }
                            }

                            return result.content + '<br><br><small style="color: #888;">ğŸ¤– ç”±æ™ºèƒ½AIæä¾›</small>';
                            
                        } else {
                            console.warn('âš ï¸ æ™ºèƒ½æ¨¡å‹é€‰æ‹©å™¨ä¸å¯ç”¨ï¼Œè¿”å›æœ¬åœ°çŸ¥è¯†åº“å›å¤');
                            return localResponse || this.getFallbackResponse(question);
                        }
                        
                    } catch (error) {
                        console.error('âŒ AIè°ƒç”¨å¤±è´¥:', error);
                        return localResponse || this.getFallbackResponse(question);
                    }
                },
                
                getLocalResponse(question) {
                    console.log('ğŸ“š æœç´¢æœ¬åœ°çŸ¥è¯†åº“:', question);

                    const knowledgeBase = {
                        // ç¬¬ä¸€ç« ï¼šæµä½“åŠ›å­¦åŸºç¡€
                        'æµä½“å®šä¹‰': {
                            keywords: ['æµä½“', 'æµä½“å®šä¹‰', 'ä»€ä¹ˆæ˜¯æµä½“', 'fluid'],
                            content: `ğŸŒŠ <strong>æµä½“çš„å®šä¹‰ä¸ç‰¹æ€§</strong><br><br>
                            <strong>å®šä¹‰ï¼š</strong>æµä½“æ˜¯åœ¨ä»»ä½•å¾®å°å‰ªåˆ‡åŠ›ä½œç”¨ä¸‹éƒ½èƒ½è¿ç»­å˜å½¢çš„ç‰©è´¨<br><br>
                            <strong>åŸºæœ¬ç‰¹æ€§ï¼š</strong><br>
                            â€¢ <strong>æµåŠ¨æ€§ï¼š</strong>åœ¨å‰ªåˆ‡åŠ›ä½œç”¨ä¸‹è¿ç»­å˜å½¢<br>
                            â€¢ <strong>ç²˜æ€§ï¼š</strong>æµä½“å†…éƒ¨å­˜åœ¨å†…æ‘©æ“¦<br>
                            â€¢ <strong>å‹ç¼©æ€§ï¼š</strong>å¯†åº¦éšå‹åŠ›å˜åŒ–<br>
                            â€¢ <strong>è¡¨é¢å¼ åŠ›ï¼š</strong>æ¶²ä½“è¡¨é¢çš„æ”¶ç¼©è¶‹åŠ¿<br><br>
                            <strong>åˆ†ç±»ï¼š</strong><br>
                            â€¢ æ¶²ä½“ï¼šå‡ ä¹ä¸å¯å‹ç¼©ï¼Œæœ‰è‡ªç”±è¡¨é¢<br>
                            â€¢ æ°”ä½“ï¼šå¯å‹ç¼©æ€§å¼ºï¼Œå……æ»¡å®¹å™¨<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬ä¸€ç« ï¼šæµä½“åŠ›å­¦åŸºç¡€</small>`
                        },

                        'æµä½“æ€§è´¨': {
                            keywords: ['å¯†åº¦', 'ç²˜æ€§', 'å‹ç¼©æ€§', 'è¡¨é¢å¼ åŠ›', 'æµä½“æ€§è´¨'],
                            content: `ğŸ“Š <strong>æµä½“çš„ä¸»è¦ç‰©ç†æ€§è´¨</strong><br><br>
                            <strong>1. å¯†åº¦ (Ï)ï¼š</strong><br>
                            â€¢ å®šä¹‰ï¼šå•ä½ä½“ç§¯çš„è´¨é‡ Ï = m/V<br>
                            â€¢ å•ä½ï¼škg/mÂ³<br>
                            â€¢ æ°´çš„å¯†åº¦ï¼š1000 kg/mÂ³ (4â„ƒ)<br><br>

                            <strong>2. åŠ¨åŠ›ç²˜åº¦ (Î¼)ï¼š</strong><br>
                            â€¢ ç‰›é¡¿ç²˜æ€§å®šå¾‹ï¼šÏ„ = Î¼(du/dy)<br>
                            â€¢ å•ä½ï¼šPaÂ·s æˆ– NÂ·s/mÂ²<br>
                            â€¢ è¿åŠ¨ç²˜åº¦ï¼šÎ½ = Î¼/Ï (mÂ²/s)<br><br>

                            <strong>3. å‹ç¼©æ€§ï¼š</strong><br>
                            â€¢ ä½“ç§¯å¼¹æ€§æ¨¡é‡ï¼šK = -V(dp/dV)<br>
                            â€¢ å‹ç¼©ç³»æ•°ï¼šÎ² = 1/K<br><br>

                            <strong>4. è¡¨é¢å¼ åŠ› (Ïƒ)ï¼š</strong><br>
                            â€¢ å•ä½ï¼šN/m<br>
                            â€¢ æ¯›ç»†ç°è±¡ï¼šh = 2ÏƒcosÎ¸/(Ïgr)<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬ä¸€ç« ï¼šæµä½“åŠ›å­¦åŸºç¡€</small>`
                        },

                        // ç¬¬äºŒç« ï¼šæµä½“é™åŠ›å­¦
                        'æµä½“é™åŠ›å­¦': {
                            keywords: ['é™åŠ›å­¦', 'é™å‹åŠ›', 'å‹åŠ›åˆ†å¸ƒ', 'å¸•æ–¯å¡å®šå¾‹'],
                            content: `âš–ï¸ <strong>æµä½“é™åŠ›å­¦åŸºæœ¬åŸç†</strong><br><br>
                            <strong>é™å‹åŠ›ç‰¹æ€§ï¼š</strong><br>
                            â€¢ å‚ç›´ä½œç”¨äºä½œç”¨é¢<br>
                            â€¢ å¤§å°ä¸æ–¹å‘æ— å…³<br>
                            â€¢ å„å‘ç›¸ç­‰<br><br>

                            <strong>æµä½“é™åŠ›å­¦åŸºæœ¬æ–¹ç¨‹ï¼š</strong><br>
                            <div class="math-formula">$$\\frac{dp}{dz} = -\\rho g$$</div><br>

                            <strong>é‡åŠ›åœºä¸­çš„å‹åŠ›åˆ†å¸ƒï¼š</strong><br>
                            â€¢ ä¸å¯å‹ç¼©æµä½“ï¼šp = pâ‚€ + Ïgh<br>
                            â€¢ å¯å‹ç¼©æµä½“ï¼šéœ€è€ƒè™‘å¯†åº¦å˜åŒ–<br><br>

                            <strong>å¸•æ–¯å¡å®šå¾‹ï¼š</strong><br>
                            å¯†é—­å®¹å™¨ä¸­ï¼Œå‹åŠ›å˜åŒ–ä¼ é€’åˆ°å„ç‚¹<br>
                            åº”ç”¨ï¼šæ¶²å‹æœºã€æ¶²å‹ä¼ åŠ¨<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬äºŒç« ï¼šæµä½“é™åŠ›å­¦</small>`
                        },

                        'å‹åŠ›æµ‹é‡': {
                            keywords: ['å‹åŠ›è®¡', 'æµ‹å‹ç®¡', 'å‹åŠ›æµ‹é‡', 'manometer'],
                            content: `ğŸ“ <strong>å‹åŠ›æµ‹é‡æ–¹æ³•</strong><br><br>
                            <strong>1. Uå‹ç®¡å‹åŠ›è®¡ï¼š</strong><br>
                            â€¢ åŸç†ï¼šp = Ïgh<br>
                            â€¢ é€‚ç”¨ï¼šå°å‹åŠ›æµ‹é‡<br><br>

                            <strong>2. å€¾æ–œç®¡å‹åŠ›è®¡ï¼š</strong><br>
                            â€¢ æé«˜è¯»æ•°ç²¾åº¦<br>
                            â€¢ h = LÂ·sinÎ¸<br><br>

                            <strong>3. å¾®å‹è®¡ï¼š</strong><br>
                            â€¢ æµ‹é‡å¾®å°å‹åŠ›å·®<br>
                            â€¢ é«˜ç²¾åº¦è¦æ±‚<br><br>

                            <strong>å‹åŠ›è¡¨ç¤ºæ–¹æ³•ï¼š</strong><br>
                            â€¢ ç»å¯¹å‹åŠ›ï¼šp_abs = p_atm + p_gauge<br>
                            â€¢ è¡¨å‹åŠ›ï¼šp_gauge = p_abs - p_atm<br>
                            â€¢ çœŸç©ºåº¦ï¼šp_vac = p_atm - p_abs<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬äºŒç« ï¼šæµä½“é™åŠ›å­¦</small>`
                        },

                        // ç¬¬ä¸‰ç« ï¼šæµä½“è¿åŠ¨å­¦
                        'æµä½“è¿åŠ¨å­¦': {
                            keywords: ['è¿åŠ¨å­¦', 'æµçº¿', 'è¿¹çº¿', 'æµç®¡', 'æµé‡'],
                            content: `ğŸŒ€ <strong>æµä½“è¿åŠ¨å­¦åŸºæœ¬æ¦‚å¿µ</strong><br><br>
                            <strong>æè¿°æ–¹æ³•ï¼š</strong><br>
                            â€¢ <strong>æ‹‰æ ¼æœ—æ—¥æ³•ï¼š</strong>è·Ÿè¸ªæµä½“è´¨ç‚¹<br>
                            â€¢ <strong>æ¬§æ‹‰æ³•ï¼š</strong>è§‚å¯Ÿç©ºé—´å›ºå®šç‚¹<br><br>

                            <strong>åŸºæœ¬æ¦‚å¿µï¼š</strong><br>
                            â€¢ <strong>æµçº¿ï¼š</strong>æŸç¬æ—¶é€Ÿåº¦çŸ¢é‡çš„åŒ…ç»œçº¿<br>
                            â€¢ <strong>è¿¹çº¿ï¼š</strong>æµä½“è´¨ç‚¹çš„è¿åŠ¨è½¨è¿¹<br>
                            â€¢ <strong>æµç®¡ï¼š</strong>æµçº¿æŸå›´æˆçš„ç®¡çŠ¶åŒºåŸŸ<br><br>

                            <strong>æµé‡ä¸æµé€Ÿï¼š</strong><br>
                            â€¢ ä½“ç§¯æµé‡ï¼šQ = âˆ«vÂ·dA<br>
                            â€¢ è´¨é‡æµé‡ï¼šá¹ = âˆ«ÏvÂ·dA<br>
                            â€¢ å¹³å‡æµé€Ÿï¼švÌ„ = Q/A<br><br>

                            <strong>è¿ç»­æ€§æ–¹ç¨‹ï¼š</strong><br>
                            <div class="math-formula">$$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\vec{v}) = 0$$</div><br>
                            <small style="color: #888;">ğŸ“š ç¬¬ä¸‰ç« ï¼šæµä½“è¿åŠ¨å­¦</small>`
                        },

                        // ç¬¬å››ç« ï¼šæµä½“åŠ¨åŠ›å­¦
                        'ä¼¯åŠªåˆ©æ–¹ç¨‹': {
                            keywords: ['ä¼¯åŠªåˆ©', 'ä¼¯åŠªåˆ©æ–¹ç¨‹', 'bernoulli', 'èƒ½é‡å®ˆæ’'],
                            content: `ğŸŒŠ <strong>ä¼¯åŠªåˆ©æ–¹ç¨‹è¯¦è§£</strong><br><br>
                            <strong>ç†æƒ³æµä½“ä¼¯åŠªåˆ©æ–¹ç¨‹ï¼š</strong><br>
                            <div class="math-formula">$$\\frac{v^2}{2} + \\frac{p}{\\rho} + gz = C$$</div><br>

                            <strong>ç‰©ç†æ„ä¹‰ï¼š</strong><br>
                            â€¢ åŠ¨èƒ½é¡¹ï¼švÂ²/2 (å•ä½è´¨é‡åŠ¨èƒ½)<br>
                            â€¢ å‹åŠ›é¡¹ï¼šp/Ï (å•ä½è´¨é‡å‹åŠ›èƒ½)<br>
                            â€¢ ä½èƒ½é¡¹ï¼šgz (å•ä½è´¨é‡é‡åŠ›åŠ¿èƒ½)<br><br>

                            <strong>é€‚ç”¨æ¡ä»¶ï¼š</strong><br>
                            â€¢ ç†æƒ³æµä½“ (æ— ç²˜æ€§)<br>
                            â€¢ å®šå¸¸æµåŠ¨<br>
                            â€¢ ä¸å¯å‹ç¼©<br>
                            â€¢ æ²¿æµçº¿ç§¯åˆ†<br><br>

                            <strong>å®é™…æµä½“ä¿®æ­£ï¼š</strong><br>
                            $$\\frac{v_1^2}{2g} + \\frac{p_1}{\\rho g} + z_1 = \\frac{v_2^2}{2g} + \\frac{p_2}{\\rho g} + z_2 + h_f$$<br>
                            å…¶ä¸­ h_f ä¸ºæ°´å¤´æŸå¤±<br><br>

                            <strong>åº”ç”¨å®ä¾‹ï¼š</strong><br>
                            â€¢ æ–‡ä¸˜é‡Œæµé‡è®¡<br>
                            â€¢ çš®æ‰˜ç®¡æµ‹é€Ÿ<br>
                            â€¢ è™¹å¸ç°è±¡<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬å››ç« ï¼šæµä½“åŠ¨åŠ›å­¦</small>`
                        },

                        'åŠ¨é‡æ–¹ç¨‹': {
                            keywords: ['åŠ¨é‡æ–¹ç¨‹', 'åŠ¨é‡å®šç†', 'momentum', 'å†²å‡»'],
                            content: `âš¡ <strong>åŠ¨é‡æ–¹ç¨‹ä¸åº”ç”¨</strong><br><br>
                            <strong>åŠ¨é‡å®šç†ï¼š</strong><br>
                            $$\\sum \\vec{F} = \\frac{d}{dt}\\int_{CV} \\rho \\vec{v} dV + \\int_{CS} \\rho \\vec{v}(\\vec{v} \\cdot \\vec{n}) dA$$<br><br>

                            <strong>å®šå¸¸æµåŠ¨ç®€åŒ–ï¼š</strong><br>
                            $$\\sum \\vec{F} = \\sum \\dot{m}_{out}\\vec{v}_{out} - \\sum \\dot{m}_{in}\\vec{v}_{in}$$<br><br>

                            <strong>åº”ç”¨ï¼š</strong><br>
                            â€¢ <strong>å°„æµå†²å‡»ï¼š</strong><br>
                            &nbsp;&nbsp;F = ÏQv(1 - cosÎ¸) (å¹³æ¿)<br>
                            &nbsp;&nbsp;F = ÏQv (å‚ç›´å¹³æ¿)<br><br>

                            â€¢ <strong>å¼¯ç®¡å—åŠ›ï¼š</strong><br>
                            &nbsp;&nbsp;è€ƒè™‘å‹åŠ›å’ŒåŠ¨é‡å˜åŒ–<br><br>

                            â€¢ <strong>èºæ—‹æ¡¨æ¨åŠ›ï¼š</strong><br>
                            &nbsp;&nbsp;T = á¹(vâ‚‚ - vâ‚)<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬å››ç« ï¼šæµä½“åŠ¨åŠ›å­¦</small>`
                        },

                        // ç¬¬äº”ç« ï¼šç²˜æ€§æµä½“åŠ›å­¦
                        'ç²˜æ€§æµåŠ¨': {
                            keywords: ['ç²˜æ€§', 'ç²˜åº¦', 'ç‰›é¡¿æµä½“', 'å‰ªåˆ‡åº”åŠ›'],
                            content: `ğŸŒ€ <strong>ç²˜æ€§æµä½“åŸºæœ¬ç†è®º</strong><br><br>
                            <strong>ç‰›é¡¿ç²˜æ€§å®šå¾‹ï¼š</strong><br>
                            $$\\tau = \\mu \\frac{du}{dy}$$<br><br>

                            <strong>æµä½“åˆ†ç±»ï¼š</strong><br>
                            â€¢ <strong>ç‰›é¡¿æµä½“ï¼š</strong>Ï„ âˆ du/dy (æ°´ã€ç©ºæ°”)<br>
                            â€¢ <strong>éç‰›é¡¿æµä½“ï¼š</strong><br>
                            &nbsp;&nbsp;- å‡å¡‘æ€§ï¼šÎ¼éšå‰ªåˆ‡ç‡å‡å°<br>
                            &nbsp;&nbsp;- èƒ€å¡‘æ€§ï¼šÎ¼éšå‰ªåˆ‡ç‡å¢å¤§<br>
                            &nbsp;&nbsp;- å®¾æ±‰æµä½“ï¼šå­˜åœ¨å±ˆæœåº”åŠ›<br><br>

                            <strong>Navier-Stokesæ–¹ç¨‹ï¼š</strong><br>
                            <div class="math-formula">$$\\rho \\frac{D\\vec{v}}{Dt} = -\\nabla p + \\rho \\vec{g} + \\mu \\nabla^2 \\vec{v}$$</div><br>

                            <strong>ç®€åŒ–å½¢å¼ï¼š</strong><br>
                            â€¢ ä¸å¯å‹ç¼©ï¼šâˆ‡Â·v = 0<br>
                            â€¢ å®šå¸¸æµåŠ¨ï¼šâˆ‚v/âˆ‚t = 0<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬äº”ç« ï¼šç²˜æ€§æµä½“åŠ›å­¦</small>`
                        },

                        'å±‚æµæ¹æµ': {
                            keywords: ['å±‚æµ', 'æ¹æµ', 'laminar', 'turbulent', 'é›·è¯ºæ•°'],
                            content: `ğŸŒŠ <strong>å±‚æµä¸æ¹æµè¯¦è§£</strong><br><br>
                            <strong>é›·è¯ºæ•°ï¼š</strong><br>
                            $$Re = \\frac{\\rho V L}{\\mu} = \\frac{V L}{\\nu}$$<br><br>

                            <strong>ä¸´ç•Œé›·è¯ºæ•°ï¼š</strong><br>
                            â€¢ åœ†ç®¡ï¼šRe_c = 2300<br>
                            â€¢ å¹³æ¿ï¼šRe_c = 5Ã—10âµ<br>
                            â€¢ åœ†çƒï¼šRe_c = 2Ã—10âµ<br><br>

                            <strong>å±‚æµç‰¹å¾ï¼š</strong><br>
                            â€¢ æµä½“åˆ†å±‚æµåŠ¨<br>
                            â€¢ æµçº¿å¹³è¡Œä¸”ä¸ç›¸äº¤<br>
                            â€¢ ç²˜æ€§åŠ›å ä¸»å¯¼<br>
                            â€¢ èƒ½é‡æŸå¤±å°<br><br>

                            <strong>æ¹æµç‰¹å¾ï¼š</strong><br>
                            â€¢ æµä½“è´¨ç‚¹æ— è§„åˆ™è¿åŠ¨<br>
                            â€¢ å¼ºçƒˆæ··åˆ<br>
                            â€¢ æƒ¯æ€§åŠ›å ä¸»å¯¼<br>
                            â€¢ èƒ½é‡æŸå¤±å¤§<br><br>

                            <strong>æ¹æµç»Ÿè®¡ç†è®ºï¼š</strong><br>
                            â€¢ æ—¶å‡åŒ–ï¼šÅ« = (1/T)âˆ«u dt<br>
                            â€¢ è„‰åŠ¨ï¼šu' = u - Å«<br>
                            â€¢ é›·è¯ºåº”åŠ›ï¼šÏ„ = -Ïu'v'<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬äº”ç« ï¼šç²˜æ€§æµä½“åŠ›å­¦</small>`
                        },

                        // ç¬¬å…­ç« ï¼šè¾¹ç•Œå±‚ç†è®º
                        'è¾¹ç•Œå±‚': {
                            keywords: ['è¾¹ç•Œå±‚', 'boundary layer', 'å£é¢', 'åˆ†ç¦»'],
                            content: `ğŸ¯ <strong>è¾¹ç•Œå±‚ç†è®ºè¯¦è§£</strong><br><br>
                            <strong>è¾¹ç•Œå±‚æ¦‚å¿µï¼š</strong><br>
                            â€¢ å®šä¹‰ï¼šç´§è´´å£é¢çš„è–„å±‚åŒºåŸŸ<br>
                            â€¢ åšåº¦Î´ï¼šu = 0.99uâˆå¤„<br>
                            â€¢ æ— é‡çº²åšåº¦ï¼šÎ´/x = 5/âˆšRe_x<br><br>

                            <strong>è¾¹ç•Œå±‚æ–¹ç¨‹ï¼š</strong><br>
                            $$u\\frac{\\partial u}{\\partial x} + v\\frac{\\partial u}{\\partial y} = -\\frac{1}{\\rho}\\frac{dp}{dx} + \\nu\\frac{\\partial^2 u}{\\partial y^2}$$<br><br>

                            <strong>Blasiusè§£ (å¹³æ¿å±‚æµ)ï¼š</strong><br>
                            â€¢ è¾¹ç•Œå±‚åšåº¦ï¼šÎ´ = 5x/âˆšRe_x<br>
                            â€¢ å£é¢æ‘©æ“¦ç³»æ•°ï¼šC_f = 0.664/âˆšRe_x<br>
                            â€¢ é˜»åŠ›ç³»æ•°ï¼šC_D = 1.328/âˆšRe_L<br><br>

                            <strong>è¾¹ç•Œå±‚åˆ†ç¦»ï¼š</strong><br>
                            â€¢ æ¡ä»¶ï¼š(âˆ‚u/âˆ‚y)_wall = 0<br>
                            â€¢ åŸå› ï¼šé€†å‹æ¢¯åº¦ dp/dx > 0<br>
                            â€¢ åæœï¼šå½¢æˆå°¾æµï¼Œå¢åŠ é˜»åŠ›<br><br>

                            <strong>æ§åˆ¶æ–¹æ³•ï¼š</strong><br>
                            â€¢ å¹æ°”/å¸æ°”<br>
                            â€¢ è¡¨é¢ç²—ç³™åº¦æ§åˆ¶<br>
                            â€¢ å½¢çŠ¶ä¼˜åŒ–<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬å…­ç« ï¼šè¾¹ç•Œå±‚ç†è®º</small>`
                        },

                        // ç¬¬ä¸ƒç« ï¼šç®¡é“æµåŠ¨
                        'ç®¡é“æµåŠ¨': {
                            keywords: ['ç®¡é“', 'ç®¡æµ', 'æ‘©æ“¦', 'å‹åŠ›æŸå¤±', 'pipe flow'],
                            content: `ğŸ”§ <strong>ç®¡é“æµåŠ¨åˆ†æ</strong><br><br>
                            <strong>åœ†ç®¡å±‚æµ (Re < 2300)ï¼š</strong><br>
                            â€¢ é€Ÿåº¦åˆ†å¸ƒï¼šu = (1/4Î¼)(dp/dx)(RÂ² - rÂ²)<br>
                            â€¢ æœ€å¤§é€Ÿåº¦ï¼šu_max = (1/4Î¼)(dp/dx)RÂ²<br>
                            â€¢ å¹³å‡é€Ÿåº¦ï¼šÅ« = u_max/2<br>
                            â€¢ æ‘©æ“¦ç³»æ•°ï¼šf = 64/Re<br><br>

                            <strong>åœ†ç®¡æ¹æµ (Re > 4000)ï¼š</strong><br>
                            â€¢ å…‰æ»‘ç®¡ï¼šf = 0.316/Re^0.25 (Re < 10âµ)<br>
                            â€¢ ç²—ç³™ç®¡ï¼š1/âˆšf = 2log(3.7D/Îµ)<br>
                            â€¢ Colebrookå…¬å¼ï¼š<br>
                            &nbsp;&nbsp;1/âˆšf = -2log(Îµ/3.7D + 2.51/Reâˆšf)<br><br>

                            <strong>å‹åŠ›æŸå¤±ï¼š</strong><br>
                            â€¢ æ²¿ç¨‹æŸå¤±ï¼šh_f = f(L/D)(vÂ²/2g)<br>
                            â€¢ å±€éƒ¨æŸå¤±ï¼šh_l = Î¶(vÂ²/2g)<br>
                            â€¢ æ€»æŸå¤±ï¼šh = h_f + Î£h_l<br><br>

                            <strong>ç®¡ç½‘è®¡ç®—ï¼š</strong><br>
                            â€¢ ä¸²è”ï¼šQç›¸åŒï¼Œhç´¯åŠ <br>
                            â€¢ å¹¶è”ï¼šhç›¸åŒï¼ŒQç´¯åŠ <br>
                            â€¢ åˆ†æ”¯ï¼šèŠ‚ç‚¹è¿ç»­æ€§<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬ä¸ƒç« ï¼šç®¡é“æµåŠ¨</small>`
                        },

                        // ç¬¬å…«ç« ï¼šç»•æµ
                        'ç»•æµ': {
                            keywords: ['ç»•æµ', 'é˜»åŠ›', 'å‡åŠ›', 'åœ†æŸ±ç»•æµ', 'ç¿¼å‹'],
                            content: `âœˆï¸ <strong>ç»•æµç†è®ºä¸åº”ç”¨</strong><br><br>
                            <strong>åœ†æŸ±ç»•æµï¼š</strong><br>
                            â€¢ ç†æƒ³æµä½“ï¼šd'Alembertæ‚–è®º (é˜»åŠ›=0)<br>
                            â€¢ å®é™…æµä½“ï¼šè¾¹ç•Œå±‚åˆ†ç¦»äº§ç”Ÿé˜»åŠ›<br>
                            â€¢ é˜»åŠ›ç³»æ•°ï¼šC_D = F_D/(Â½ÏvÂ²A)<br><br>

                            <strong>é›·è¯ºæ•°æ•ˆåº”ï¼š</strong><br>
                            â€¢ Re < 1ï¼šStokesæµï¼ŒC_D = 24/Re<br>
                            â€¢ 1 < Re < 10Â³ï¼šè¿‡æ¸¡åŒº<br>
                            â€¢ 10Â³ < Re < 2Ã—10âµï¼šäºšä¸´ç•ŒåŒº<br>
                            â€¢ Re > 2Ã—10âµï¼šè¶…ä¸´ç•ŒåŒº<br><br>

                            <strong>ç¿¼å‹ç»•æµï¼š</strong><br>
                            â€¢ å‡åŠ›äº§ç”Ÿæœºç†ï¼š<br>
                            &nbsp;&nbsp;- ä¼¯åŠªåˆ©æ•ˆåº”<br>
                            &nbsp;&nbsp;- ç¯é‡ç†è®º<br>
                            &nbsp;&nbsp;- ç‰›é¡¿ç¬¬ä¸‰å®šå¾‹<br><br>

                            <strong>Kutta-Joukowskiå®šç†ï¼š</strong><br>
                            $$L = \\rho v \\Gamma$$<br>
                            å…¶ä¸­Î“ä¸ºç¯é‡<br><br>

                            <strong>å‡é˜»æ¯”ï¼š</strong><br>
                            â€¢ L/D = C_L/C_D<br>
                            â€¢ ç¿¼å‹è®¾è®¡ç›®æ ‡ï¼šæœ€å¤§å‡é˜»æ¯”<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬å…«ç« ï¼šç»•æµ</small>`
                        },

                        // ç¬¬ä¹ç« ï¼šå¯å‹ç¼©æµåŠ¨
                        'å¯å‹ç¼©æµ': {
                            keywords: ['å¯å‹ç¼©', 'éŸ³é€Ÿ', 'é©¬èµ«æ•°', 'æ¿€æ³¢', 'ç­‰ç†µæµ'],
                            content: `ğŸš€ <strong>å¯å‹ç¼©æµåŠ¨åŸºç¡€</strong><br><br>
                            <strong>éŸ³é€Ÿä¸é©¬èµ«æ•°ï¼š</strong><br>
                            â€¢ éŸ³é€Ÿï¼ša = âˆš(Î³RT) = âˆš(Î³p/Ï)<br>
                            â€¢ é©¬èµ«æ•°ï¼šMa = v/a<br>
                            â€¢ åˆ†ç±»ï¼šMa < 1(äºšéŸ³é€Ÿ), Ma > 1(è¶…éŸ³é€Ÿ)<br><br>

                            <strong>ç­‰ç†µæµåŠ¨æ–¹ç¨‹ï¼š</strong><br>
                            â€¢ è¿ç»­æ€§ï¼šÏâ‚vâ‚Aâ‚ = Ïâ‚‚vâ‚‚Aâ‚‚<br>
                            â€¢ åŠ¨é‡ï¼špâ‚ + Ïâ‚vâ‚Â² = pâ‚‚ + Ïâ‚‚vâ‚‚Â²<br>
                            â€¢ èƒ½é‡ï¼šhâ‚ + vâ‚Â²/2 = hâ‚‚ + vâ‚‚Â²/2<br><br>

                            <strong>æ‹‰ç“¦å°”å–·ç®¡ï¼š</strong><br>
                            â€¢ æ”¶ç¼©æ®µï¼šäºšéŸ³é€ŸåŠ é€Ÿ<br>
                            â€¢ å–‰éƒ¨ï¼šMa = 1<br>
                            â€¢ æ‰©å¼ æ®µï¼šè¶…éŸ³é€Ÿç»§ç»­åŠ é€Ÿ<br><br>

                            <strong>æ¿€æ³¢ç†è®ºï¼š</strong><br>
                            â€¢ æ­£æ¿€æ³¢ï¼šMaâ‚ > 1 â†’ Maâ‚‚ < 1<br>
                            â€¢ æ–œæ¿€æ³¢ï¼šæµåŠ¨æ–¹å‘æ”¹å˜<br>
                            â€¢ Rankine-Hugoniotå…³ç³»<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬ä¹ç« ï¼šå¯å‹ç¼©æµåŠ¨</small>`
                        },

                        // ç¬¬åç« ï¼šæ¶¡é‡ç†è®º
                        'æ¶¡é‡': {
                            keywords: ['æ¶¡é‡', 'æ¶¡åº¦', 'ç¯é‡', 'vorticity', 'æ¶¡çº¿'],
                            content: `ğŸŒªï¸ <strong>æ¶¡é‡ç†è®ºè¯¦è§£</strong><br><br>
                            <strong>æ¶¡é‡å®šä¹‰ï¼š</strong><br>
                            $$\\vec{\\omega} = \\nabla \\times \\vec{v} = \\begin{vmatrix}
                            \\vec{i} & \\vec{j} & \\vec{k} \\\\
                            \\frac{\\partial}{\\partial x} & \\frac{\\partial}{\\partial y} & \\frac{\\partial}{\\partial z} \\\\
                            u & v & w
                            \\end{vmatrix}$$<br><br>

                            <strong>ç¯é‡ï¼š</strong><br>
                            $$\\Gamma = \\oint \\vec{v} \\cdot d\\vec{l} = \\int \\vec{\\omega} \\cdot d\\vec{A}$$<br><br>

                            <strong>æ¶¡é‡è¾“è¿æ–¹ç¨‹ï¼š</strong><br>
                            $$\\frac{D\\vec{\\omega}}{Dt} = (\\vec{\\omega} \\cdot \\nabla)\\vec{v} + \\nu\\nabla^2\\vec{\\omega}$$<br><br>

                            <strong>Kelvinå®šç†ï¼š</strong><br>
                            ç†æƒ³æµä½“ä¸­ï¼Œç¯é‡å®ˆæ’ï¼šDÎ“/Dt = 0<br><br>

                            <strong>Helmholtzæ¶¡é‡å®šç†ï¼š</strong><br>
                            â€¢ æ¶¡çº¿ä¸èƒ½åœ¨æµä½“å†…éƒ¨ç»ˆæ­¢<br>
                            â€¢ æ¶¡ç®¡å¼ºåº¦æ²¿é•¿åº¦ä¸å˜<br>
                            â€¢ æ¶¡çº¿éšæµä½“è¿åŠ¨<br><br>

                            <strong>åº”ç”¨ï¼š</strong><br>
                            â€¢ ç¿¼å°–æ¶¡<br>
                            â€¢ é¾™å·é£<br>
                            â€¢ æ¹æµç»“æ„<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬åç« ï¼šæ¶¡é‡ç†è®º</small>`
                        },

                        // ç¬¬åä¸€ç« ï¼šæµä½“æµ‹é‡
                        'æµä½“æµ‹é‡': {
                            keywords: ['æµé‡è®¡', 'æµ‹é€Ÿ', 'å‹åŠ›æµ‹é‡', 'çš®æ‰˜ç®¡', 'æ–‡ä¸˜é‡Œ'],
                            content: `ğŸ“ <strong>æµä½“æµ‹é‡æŠ€æœ¯</strong><br><br>
                            <strong>1. çš®æ‰˜ç®¡æµ‹é€Ÿï¼š</strong><br>
                            â€¢ åŸç†ï¼šä¼¯åŠªåˆ©æ–¹ç¨‹<br>
                            â€¢ å…¬å¼ï¼šv = âˆš(2Î”p/Ï)<br>
                            â€¢ ä¿®æ­£ï¼šv = Câˆš(2Î”p/Ï)<br><br>

                            <strong>2. æ–‡ä¸˜é‡Œæµé‡è®¡ï¼š</strong><br>
                            â€¢ åŸç†ï¼šè¿ç»­æ€§+ä¼¯åŠªåˆ©<br>
                            â€¢ æµé‡ï¼šQ = CdAâ‚‚âˆš(2Î”p/Ï(1-(Aâ‚‚/Aâ‚)Â²))<br>
                            â€¢ ä¼˜ç‚¹ï¼šå‹åŠ›æŸå¤±å°<br><br>

                            <strong>3. å­”æ¿æµé‡è®¡ï¼š</strong><br>
                            â€¢ ç»“æ„ç®€å•ï¼Œæˆæœ¬ä½<br>
                            â€¢ å‹åŠ›æŸå¤±å¤§<br>
                            â€¢ éœ€è¦æ ‡å®šç³»æ•°<br><br>

                            <strong>4. è½¬å­æµé‡è®¡ï¼š</strong><br>
                            â€¢ å˜é¢ç§¯åŸç†<br>
                            â€¢ ç›´è¯»å¼<br>
                            â€¢ é€‚ç”¨èŒƒå›´å¹¿<br><br>

                            <strong>5. ç°ä»£æµ‹é‡æŠ€æœ¯ï¼š</strong><br>
                            â€¢ æ¿€å…‰å¤šæ™®å‹’æµ‹é€Ÿ(LDV)<br>
                            â€¢ ç²’å­å›¾åƒæµ‹é€Ÿ(PIV)<br>
                            â€¢ è¶…å£°æ³¢æµé‡è®¡<br>
                            â€¢ ç”µç£æµé‡è®¡<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬åä¸€ç« ï¼šæµä½“æµ‹é‡</small>`
                        },

                        // ç¬¬åäºŒç« ï¼šç›¸ä¼¼ç†è®ºä¸é‡çº²åˆ†æ
                        'ç›¸ä¼¼ç†è®º': {
                            keywords: ['ç›¸ä¼¼', 'é‡çº²åˆ†æ', 'æ— é‡çº²æ•°', 'æ¨¡å‹è¯•éªŒ'],
                            content: `ğŸ”¬ <strong>ç›¸ä¼¼ç†è®ºä¸é‡çº²åˆ†æ</strong><br><br>
                            <strong>ç›¸ä¼¼å‡†åˆ™ï¼š</strong><br>
                            â€¢ å‡ ä½•ç›¸ä¼¼ï¼šLr = Lâ‚/Lâ‚‚ = å¸¸æ•°<br>
                            â€¢ è¿åŠ¨ç›¸ä¼¼ï¼švr = vâ‚/vâ‚‚ = å¸¸æ•°<br>
                            â€¢ åŠ¨åŠ›ç›¸ä¼¼ï¼šFr = Fâ‚/Fâ‚‚ = å¸¸æ•°<br><br>

                            <strong>é‡è¦æ— é‡çº²æ•°ï¼š</strong><br>
                            â€¢ é›·è¯ºæ•°ï¼šRe = ÏvL/Î¼ (æƒ¯æ€§åŠ›/ç²˜æ€§åŠ›)<br>
                            â€¢ å¼—åŠ³å¾·æ•°ï¼šFr = v/âˆš(gL) (æƒ¯æ€§åŠ›/é‡åŠ›)<br>
                            â€¢ é©¬èµ«æ•°ï¼šMa = v/a (æƒ¯æ€§åŠ›/å¼¹æ€§åŠ›)<br>
                            â€¢ éŸ¦ä¼¯æ•°ï¼šWe = ÏvÂ²L/Ïƒ (æƒ¯æ€§åŠ›/è¡¨é¢å¼ åŠ›)<br><br>

                            <strong>Buckingham Ï€å®šç†ï¼š</strong><br>
                            nä¸ªç‰©ç†é‡ï¼Œkä¸ªåŸºæœ¬é‡çº²<br>
                            â†’ (n-k)ä¸ªæ— é‡çº²Ï€ç¾¤<br><br>

                            <strong>æ¨¡å‹è¯•éªŒï¼š</strong><br>
                            â€¢ ç¡®å®šä¸»å¯¼æ— é‡çº²æ•°<br>
                            â€¢ ä¿æŒç›¸ä¼¼å‡†åˆ™<br>
                            â€¢ ç»“æœå¤–æ¨åˆ°åŸå‹<br><br>

                            <strong>åº”ç”¨å®ä¾‹ï¼š</strong><br>
                            â€¢ èˆ¹èˆ¶é˜»åŠ›è¯•éªŒ (Frç›¸ä¼¼)<br>
                            â€¢ é£æœºé£æ´è¯•éªŒ (Re, Maç›¸ä¼¼)<br>
                            â€¢ æ°´å·¥æ¨¡å‹ (Frç›¸ä¼¼)<br><br>
                            <small style="color: #888;">ğŸ“š ç¬¬åäºŒç« ï¼šç›¸ä¼¼ç†è®º</small>`
                        },

                        // å·¥ç¨‹åº”ç”¨
                        'æ³µä¸é£æœº': {
                            keywords: ['æ³µ', 'é£æœº', 'å¶è½®', 'æ€§èƒ½æ›²çº¿', 'æ±½èš€'],
                            content: `âš™ï¸ <strong>æ³µä¸é£æœºå·¥ç¨‹åº”ç”¨</strong><br><br>
                            <strong>ç¦»å¿ƒæ³µåŸºæœ¬æ–¹ç¨‹ï¼š</strong><br>
                            â€¢ ç†è®ºæ‰¬ç¨‹ï¼šH_th = (uâ‚‚Â²-uâ‚Â²)/2g + (wâ‚Â²-wâ‚‚Â²)/2g<br>
                            â€¢ å®é™…æ‰¬ç¨‹ï¼šH = H_th - æŸå¤±<br><br>

                            <strong>æ€§èƒ½å‚æ•°ï¼š</strong><br>
                            â€¢ æµé‡ Q (mÂ³/s)<br>
                            â€¢ æ‰¬ç¨‹ H (m)<br>
                            â€¢ åŠŸç‡ P (kW)<br>
                            â€¢ æ•ˆç‡ Î· = ÏgQH/P<br><br>

                            <strong>ç›¸ä¼¼å®šå¾‹ï¼š</strong><br>
                            â€¢ Qâ‚/Qâ‚‚ = (nâ‚/nâ‚‚)(Dâ‚/Dâ‚‚)Â³<br>
                            â€¢ Hâ‚/Hâ‚‚ = (nâ‚/nâ‚‚)Â²(Dâ‚/Dâ‚‚)Â²<br>
                            â€¢ Pâ‚/Pâ‚‚ = (nâ‚/nâ‚‚)Â³(Dâ‚/Dâ‚‚)âµ<br><br>

                            <strong>æ±½èš€ç°è±¡ï¼š</strong><br>
                            â€¢ æ¡ä»¶ï¼šp < p_v (é¥±å’Œè’¸æ±½å‹)<br>
                            â€¢ æ±½èš€ä½™é‡ï¼šNPSH = (pâ‚€-p_v)/Ïg + vâ‚€Â²/2g<br>
                            â€¢ é˜²æ­¢æªæ–½ï¼šé™ä½å¸ç¨‹ï¼Œå¢å¤§ç®¡å¾„<br><br>

                            <strong>ç³»ç»Ÿç‰¹æ€§ï¼š</strong><br>
                            â€¢ ç®¡è·¯ç‰¹æ€§ï¼šH = Hâ‚€ + KQÂ²<br>
                            â€¢ å·¥ä½œç‚¹ï¼šæ³µç‰¹æ€§ä¸ç®¡è·¯ç‰¹æ€§äº¤ç‚¹<br><br>
                            <small style="color: #888;">ğŸ“š å·¥ç¨‹åº”ç”¨ï¼šæ³µä¸é£æœº</small>`
                        }
                    };
                    
                    const questionLower = question.toLowerCase();
                    
                    // ç²¾ç¡®åŒ¹é…å…³é”®è¯
                    for (const [topicKey, topic] of Object.entries(knowledgeBase)) {
                        for (const keyword of topic.keywords) {
                            if (questionLower.includes(keyword.toLowerCase())) {
                                console.log(`âœ… æœ¬åœ°çŸ¥è¯†åº“åŒ¹é…: ${topicKey}`);
                                return topic.content;
                            }
                        }
                    }
                    
                    console.log('âŒ æœ¬åœ°çŸ¥è¯†åº“æ— åŒ¹é…ç»“æœ');
                    return null;
                },

                getFallbackResponse(question) {
                    const fallbackResponses = [
                        'ğŸ’¡ <strong>æç¤ºï¼š</strong>è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼å»ºè®®æŸ¥é˜…ç›¸å…³æ•™ææˆ–å’¨è¯¢è€å¸ˆè·å¾—æ›´è¯¦ç»†çš„è§£ç­”ã€‚',
                        'ğŸ¤” <strong>æ€è€ƒï¼š</strong>è¿™ä¸ªé—®é¢˜æ¶‰åŠè¾ƒæ·±çš„ç†è®ºï¼Œå»ºè®®å…ˆå¤ä¹ åŸºç¡€æ¦‚å¿µï¼Œç„¶åé€æ­¥æ·±å…¥ã€‚',
                        'ğŸ“– <strong>å»ºè®®ï¼š</strong>å¯ä»¥ä»åŸºæœ¬åŸç†å‡ºå‘ï¼Œç»“åˆå…·ä½“ä¾‹å­æ¥ç†è§£è¿™ä¸ªæ¦‚å¿µã€‚'
                    ];
                    return fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];
                },

                selectSuggestion(suggestion) {
                    this.currentMessage = suggestion;

                    // å¦‚æœå¯ç”¨æ™ºèƒ½å»ºè®®ï¼Œæ›´æ–°å»ºè®®åˆ—è¡¨
                    if (this.advancedFeatures.smartSuggestions) {
                        this.updateSmartSuggestions(suggestion);
                    }

                    // è‡ªåŠ¨å‘é€æ¶ˆæ¯
                    this.sendMessage();
                },

                // æ›´æ–°æ™ºèƒ½å»ºè®®
                updateSmartSuggestions(selectedSuggestion) {
                    const relatedSuggestions = {
                        // åŸºç¡€æ¦‚å¿µç›¸å…³
                        'ä»€ä¹ˆæ˜¯æµä½“ï¼Ÿæµä½“æœ‰å“ªäº›åŸºæœ¬ç‰¹æ€§ï¼Ÿ': [
                            'æµä½“çš„ä¸»è¦ç‰©ç†æ€§è´¨æœ‰å“ªäº›ï¼Ÿ',
                            'ç‰›é¡¿æµä½“ä¸éç‰›é¡¿æµä½“çš„åŒºåˆ«',
                            'æµä½“é™åŠ›å­¦åŸºæœ¬åŸç†'
                        ],
                        'æµä½“çš„ä¸»è¦ç‰©ç†æ€§è´¨æœ‰å“ªäº›ï¼Ÿ': [
                            'å¯†åº¦å’Œæ¯”é‡çš„æ¦‚å¿µ',
                            'ç²˜æ€§ç³»æ•°çš„æµ‹é‡æ–¹æ³•',
                            'è¡¨é¢å¼ åŠ›çš„åº”ç”¨'
                        ],

                        // é™åŠ›å­¦ç›¸å…³
                        'æµä½“é™åŠ›å­¦åŸºæœ¬åŸç†': [
                            'å¦‚ä½•æµ‹é‡æµä½“å‹åŠ›ï¼Ÿ',
                            'å¸•æ–¯å¡å®šå¾‹çš„åº”ç”¨',
                            'æµ®åŠ›å’Œé˜¿åŸºç±³å¾·åŸç†'
                        ],

                        // è¿åŠ¨å­¦ç›¸å…³
                        'æµä½“è¿åŠ¨å­¦åŸºæœ¬æ¦‚å¿µ': [
                            'æµçº¿ã€è¿¹çº¿å’Œæµçº¿çš„åŒºåˆ«',
                            'è¿ç»­æ€§æ–¹ç¨‹çš„æ¨å¯¼è¿‡ç¨‹',
                            'æµé‡å’Œæµé€Ÿçš„å…³ç³»'
                        ],

                        // åŠ¨åŠ›å­¦ç›¸å…³
                        'ä»€ä¹ˆæ˜¯ä¼¯åŠªåˆ©æ–¹ç¨‹ï¼Ÿ': [
                            'ä¼¯åŠªåˆ©æ–¹ç¨‹çš„åº”ç”¨å®ä¾‹',
                            'å¦‚ä½•æ¨å¯¼ä¼¯åŠªåˆ©æ–¹ç¨‹ï¼Ÿ',
                            'ä¼¯åŠªåˆ©æ–¹ç¨‹çš„é€‚ç”¨æ¡ä»¶',
                            'è®¾è®¡æ–‡ä¸˜é‡Œæµé‡è®¡'
                        ],
                        'åŠ¨é‡æ–¹ç¨‹çš„åº”ç”¨': [
                            'å°„æµå†²å‡»åŠ›è®¡ç®—',
                            'å¼¯ç®¡å—åŠ›åˆ†æ',
                            'èºæ—‹æ¡¨æ¨åŠ›ç†è®º'
                        ],

                        // ç²˜æ€§æµåŠ¨ç›¸å…³
                        'ä»€ä¹ˆæ˜¯ç²˜æ€§ï¼Ÿç‰›é¡¿ç²˜æ€§å®šå¾‹': [
                            'å±‚æµå’Œæ¹æµçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ',
                            'æ¨å¯¼Navier-Stokesæ–¹ç¨‹',
                            'éç‰›é¡¿æµä½“çš„ç‰¹æ€§'
                        ],
                        'å±‚æµå’Œæ¹æµçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ': [
                            'å¦‚ä½•è®¡ç®—é›·è¯ºæ•°ï¼Ÿ',
                            'ä¸´ç•Œé›·è¯ºæ•°çš„ç¡®å®š',
                            'æ¹æµçš„ç»Ÿè®¡ç†è®º'
                        ],
                        'å¦‚ä½•è®¡ç®—é›·è¯ºæ•°ï¼Ÿ': [
                            'é›·è¯ºæ•°çš„ç‰©ç†æ„ä¹‰',
                            'ä¸åŒå‡ ä½•å½¢çŠ¶çš„é›·è¯ºæ•°',
                            'é›·è¯ºæ•°å¯¹æµåŠ¨çš„å½±å“'
                        ],

                        // è¾¹ç•Œå±‚ç›¸å…³
                        'è¾¹ç•Œå±‚ç†è®ºçš„åŸºæœ¬æ¦‚å¿µ': [
                            'è¾¹ç•Œå±‚åšåº¦çš„è®¡ç®—',
                            'è¾¹ç•Œå±‚åˆ†ç¦»ç°è±¡',
                            'Blasiusè§£çš„ç‰©ç†æ„ä¹‰'
                        ],
                        'è¾¹ç•Œå±‚åˆ†ç¦»ç°è±¡': [
                            'åˆ†ç¦»çš„æ¡ä»¶å’ŒåŸå› ',
                            'å¦‚ä½•æ§åˆ¶è¾¹ç•Œå±‚åˆ†ç¦»',
                            'åˆ†ç¦»å¯¹é˜»åŠ›çš„å½±å“'
                        ],

                        // ç®¡é“æµåŠ¨ç›¸å…³
                        'ç®¡é“æµåŠ¨çš„ç‰¹ç‚¹': [
                            'å¦‚ä½•è®¡ç®—ç®¡é“å‹åŠ›æŸå¤±ï¼Ÿ',
                            'ç®¡ç½‘ç³»ç»Ÿçš„è®¡ç®—æ–¹æ³•',
                            'ç®¡é“æ‘©æ“¦ç³»æ•°çš„ç¡®å®š'
                        ],

                        // ç»•æµç›¸å…³
                        'åœ†æŸ±ç»•æµç°è±¡åˆ†æ': [
                            'ä»€ä¹ˆæ˜¯é˜»åŠ›ç³»æ•°ï¼Ÿ',
                            'å¡é—¨æ¶¡è¡—ç°è±¡',
                            'ç»•æµçš„é›·è¯ºæ•°æ•ˆåº”'
                        ],
                        'åˆ†ææœºç¿¼å‡åŠ›äº§ç”Ÿæœºç†': [
                            'Kutta-Joukowskiå®šç†',
                            'ç¿¼å‹çš„å‡ ä½•å‚æ•°',
                            'å‡é˜»æ¯”çš„ä¼˜åŒ–'
                        ],

                        // é«˜çº§ç†è®ºç›¸å…³
                        'å¯å‹ç¼©æµåŠ¨åŸºç¡€': [
                            'éŸ³é€Ÿå’Œé©¬èµ«æ•°',
                            'æ¿€æ³¢ç†è®º',
                            'æ‹‰ç“¦å°”å–·ç®¡è®¾è®¡'
                        ],
                        'è§£é‡Šæ¶¡é‡è¾“è¿æ–¹ç¨‹': [
                            'æ¶¡é‡çš„å®šä¹‰å’Œè®¡ç®—',
                            'Kelvinç¯é‡å®šç†',
                            'Helmholtzæ¶¡é‡å®šç†'
                        ],
                        'ç›¸ä¼¼ç†è®ºä¸é‡çº²åˆ†æ': [
                            'Buckingham Ï€å®šç†',
                            'é‡è¦çš„æ— é‡çº²æ•°',
                            'æ¨¡å‹è¯•éªŒè®¾è®¡'
                        ],

                        // å·¥ç¨‹åº”ç”¨ç›¸å…³
                        'è®¾è®¡æ–‡ä¸˜é‡Œæµé‡è®¡': [
                            'æµé‡è®¡çš„å·¥ä½œåŸç†',
                            'å­”æ¿æµé‡è®¡çš„ç‰¹ç‚¹',
                            'ç°ä»£æµé‡æµ‹é‡æŠ€æœ¯'
                        ],
                        'æ³µçš„æ€§èƒ½æ›²çº¿åˆ†æ': [
                            'æ³µçš„ç›¸ä¼¼å®šå¾‹',
                            'æ±½èš€ç°è±¡åŠå…¶é˜²æ­¢',
                            'æ³µç«™ç³»ç»Ÿè®¾è®¡'
                        ]
                    };

                    const related = relatedSuggestions[selectedSuggestion];
                    if (related) {
                        // å°†ç›¸å…³å»ºè®®æ·»åŠ åˆ°å½“å‰å»ºè®®åˆ—è¡¨çš„å‰é¢
                        this.suggestions = [...related, ...this.suggestions.filter(s => !related.includes(s))].slice(0, 12);
                        console.log('ğŸ’¡ æ™ºèƒ½å»ºè®®å·²æ›´æ–°:', related);
                    }
                },

                // åˆ·æ–°å»ºè®®
                refreshSuggestions() {
                    const allSuggestions = [
                        'ä»€ä¹ˆæ˜¯ä¼¯åŠªåˆ©æ–¹ç¨‹ï¼Ÿ',
                        'å±‚æµå’Œæ¹æµçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ',
                        'å¦‚ä½•è®¡ç®—é›·è¯ºæ•°ï¼Ÿ',
                        'è¾¹ç•Œå±‚ç†è®ºçš„åŸºæœ¬æ¦‚å¿µ',
                        'æµä½“ç²˜æ€§çš„ç‰©ç†æ„ä¹‰',
                        'è¿ç»­æ€§æ–¹ç¨‹çš„æ¨å¯¼è¿‡ç¨‹',
                        'æ¨å¯¼Navier-Stokesæ–¹ç¨‹',
                        'è§£é‡Šæ¶¡é‡è¾“è¿æ–¹ç¨‹',
                        'åˆ†æç®¡é“æµåŠ¨çš„é€Ÿåº¦åˆ†å¸ƒ',
                        'è®¡ç®—ç»•åœ†æŸ±æµåŠ¨çš„é˜»åŠ›ç³»æ•°',
                        'è®¾è®¡æ–‡ä¸˜é‡Œæµé‡è®¡',
                        'åˆ†ææœºç¿¼å‡åŠ›äº§ç”Ÿæœºç†',
                        'ä»€ä¹ˆæ˜¯å‹åŠ›æŸå¤±ï¼Ÿ',
                        'å¦‚ä½•æµ‹é‡æµä½“æµé‡ï¼Ÿ',
                        'æµä½“é™åŠ›å­¦åŸºæœ¬åŸç†',
                        'ç†æƒ³æµä½“ä¸å®é™…æµä½“çš„åŒºåˆ«',
                        'æµçº¿ã€è¿¹çº¿å’Œæµçº¿çš„åŒºåˆ«',
                        'ä»€ä¹ˆæ˜¯æµå‡½æ•°å’ŒåŠ¿å‡½æ•°ï¼Ÿ',
                        'ç®¡é“æ‘©æ“¦æŸå¤±è®¡ç®—',
                        'æ³µçš„æ€§èƒ½æ›²çº¿åˆ†æ'
                    ];

                    // éšæœºé€‰æ‹©12ä¸ªå»ºè®®
                    const shuffled = allSuggestions.sort(() => 0.5 - Math.random());
                    this.suggestions = shuffled.slice(0, 12);

                    this.showNotification('ğŸ”„ å»ºè®®å·²åˆ·æ–°', 'success');
                },

                // å­¦ä¹ è¿›åº¦è·Ÿè¸ª
                updateLearningProgress(question) {
                    const topics = {
                        'ä¼¯åŠªåˆ©': { name: 'ä¼¯åŠªåˆ©æ–¹ç¨‹', difficulty: 'basic' },
                        'é›·è¯º': { name: 'é›·è¯ºæ•°', difficulty: 'basic' },
                        'å±‚æµ': { name: 'æµåŠ¨çŠ¶æ€', difficulty: 'basic' },
                        'æ¹æµ': { name: 'æµåŠ¨çŠ¶æ€', difficulty: 'intermediate' },
                        'è¾¹ç•Œå±‚': { name: 'è¾¹ç•Œå±‚ç†è®º', difficulty: 'intermediate' },
                        'NSæ–¹ç¨‹': { name: 'Navier-Stokesæ–¹ç¨‹', difficulty: 'advanced' },
                        'æ¶¡é‡': { name: 'æ¶¡é‡ç†è®º', difficulty: 'advanced' },
                        'è¿ç»­æ€§': { name: 'è¿ç»­æ€§æ–¹ç¨‹', difficulty: 'basic' }
                    };

                    for (const [keyword, topicInfo] of Object.entries(topics)) {
                        if (question.toLowerCase().includes(keyword.toLowerCase())) {
                            // æ›´æ–°å­¦ä¹ è·¯å¾„
                            if (!this.learningPath.some(item => item.name === topicInfo.name)) {
                                this.learningPath.push({
                                    name: topicInfo.name,
                                    difficulty: topicInfo.difficulty,
                                    timestamp: new Date(),
                                    questions: 1
                                });
                            } else {
                                // å¢åŠ é—®é¢˜è®¡æ•°
                                const existingTopic = this.learningPath.find(item => item.name === topicInfo.name);
                                if (existingTopic) {
                                    existingTopic.questions++;
                                    existingTopic.timestamp = new Date();
                                }
                            }

                            // è®¡ç®—å­¦ä¹ è¿›åº¦
                            this.calculateLearningProgress();
                            break;
                        }
                    }
                },

                // è®¡ç®—å­¦ä¹ è¿›åº¦
                calculateLearningProgress() {
                    const totalTopics = 8; // æ€»å…±8ä¸ªä¸»è¦è¯é¢˜
                    const completedTopics = this.learningPath.length;
                    const progressPercentage = Math.round((completedTopics / totalTopics) * 100);

                    // æ›´æ–°ä¼šè¯ç»Ÿè®¡
                    this.sessionStats.learningProgress = progressPercentage;
                    this.sessionStats.topicsExplored = completedTopics;

                    // æ˜¾ç¤ºè¿›åº¦æç¤º
                    if (completedTopics > 0 && completedTopics % 3 === 0) {
                        this.showNotification(`ğŸ‰ å­¦ä¹ è¿›åº¦: ${progressPercentage}% (å·²æ¢ç´¢${completedTopics}ä¸ªè¯é¢˜)`, 'success');
                    }
                },

                // è·å–å­¦ä¹ å»ºè®®
                getLearningRecommendations() {
                    const basicTopics = ['ä¼¯åŠªåˆ©æ–¹ç¨‹', 'è¿ç»­æ€§æ–¹ç¨‹', 'é›·è¯ºæ•°'];
                    const intermediateTopics = ['è¾¹ç•Œå±‚ç†è®º', 'æµåŠ¨çŠ¶æ€', 'å‹åŠ›åˆ†æ'];
                    const advancedTopics = ['Navier-Stokesæ–¹ç¨‹', 'æ¶¡é‡ç†è®º'];

                    const exploredTopics = this.learningPath.map(item => item.name);
                    const unexploredBasic = basicTopics.filter(topic => !exploredTopics.includes(topic));
                    const unexploredIntermediate = intermediateTopics.filter(topic => !exploredTopics.includes(topic));
                    const unexploredAdvanced = advancedTopics.filter(topic => !exploredTopics.includes(topic));

                    let recommendations = [];

                    if (unexploredBasic.length > 0) {
                        recommendations.push(`å»ºè®®å…ˆå­¦ä¹ åŸºç¡€æ¦‚å¿µ: ${unexploredBasic.join(', ')}`);
                    } else if (unexploredIntermediate.length > 0) {
                        recommendations.push(`å¯ä»¥å­¦ä¹ ä¸­çº§æ¦‚å¿µ: ${unexploredIntermediate.join(', ')}`);
                    } else if (unexploredAdvanced.length > 0) {
                        recommendations.push(`æŒ‘æˆ˜é«˜çº§æ¦‚å¿µ: ${unexploredAdvanced.join(', ')}`);
                    } else {
                        recommendations.push('æ­å–œï¼æ‚¨å·²ç»æ¢ç´¢äº†æ‰€æœ‰ä¸»è¦è¯é¢˜ï¼Œå¯ä»¥æ·±å…¥ç ”ç©¶å…·ä½“åº”ç”¨ã€‚');
                    }

                    return recommendations;
                },

                formatTime(date) {
                    return date.toLocaleTimeString('zh-CN', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                },

                scrollToBottom() {
                    this.$nextTick(() => {
                        const messagesContainer = this.$refs.chatMessages;
                        if (messagesContainer) {
                            messagesContainer.scrollTop = messagesContainer.scrollHeight;
                        }
                    });
                },

                handleEnter(event) {
                    if (event.key === 'Enter' && !event.shiftKey) {
                        event.preventDefault();
                        this.sendMessage();
                    }
                },

                toggleFullscreen() {
                    this.isFullscreen = !this.isFullscreen;

                    if (this.isFullscreen) {
                        document.body.style.overflow = 'hidden';
                        this.showNotification('å·²è¿›å…¥å…¨å±æ¨¡å¼', 'info');
                    } else {
                        document.body.style.overflow = '';
                        this.showNotification('å·²é€€å‡ºå…¨å±æ¨¡å¼', 'info');
                    }
                },

                showNotification(message, type = 'info') {
                    this.notification = {
                        show: true,
                        message,
                        type
                    };

                    setTimeout(() => {
                        this.notification.show = false;
                    }, 3000);
                },

                // é”®ç›˜å¿«æ·é”®å¤„ç†
                handleKeyboard(event) {
                    if (event.key === 'F11') {
                        event.preventDefault();
                        this.toggleFullscreen();
                    } else if (event.key === 'Escape') {
                        if (this.isFullscreen) {
                            this.toggleFullscreen();
                        } else {
                            window.location.href = '../index.html';
                        }
                    } else if (event.ctrlKey && event.key === 'l') {
                        event.preventDefault();
                        this.clearChat();
                    }
                },

                clearChat() {
                    this.messages = [{
                        id: 1,
                        sender: 'ai',
                        content: 'ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯AIå­¦ä¹ åŠ©æ‰‹ï¼Œä¸“é—¨å¸®åŠ©æ‚¨å­¦ä¹ æµä½“åŠ›å­¦ã€‚è¯·éšæ—¶å‘æˆ‘æé—®ï¼',
                        timestamp: new Date()
                    }];
                    this.showNotification('å¯¹è¯å·²æ¸…ç©º', 'success');
                },

                // è¯­éŸ³è¾“å…¥åŠŸèƒ½
                toggleVoiceInput() {
                    if (!this.isRecording) {
                        this.startVoiceRecognition();
                    } else {
                        this.stopVoiceRecognition();
                    }
                },

                startVoiceRecognition() {
                    // æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
                    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                        this.showNotification('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½ã€‚è¯·ä½¿ç”¨Chromeã€Edgeæˆ–Safariæµè§ˆå™¨ã€‚', 'error');
                        return;
                    }

                    // æ£€æŸ¥éº¦å…‹é£æƒé™
                    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                        navigator.mediaDevices.getUserMedia({ audio: true })
                            .then(() => {
                                this.initSpeechRecognition();
                            })
                            .catch((error) => {
                                console.error('éº¦å…‹é£æƒé™è¢«æ‹’ç»:', error);
                                this.showNotification('è¯·å…è®¸è®¿é—®éº¦å…‹é£ä»¥ä½¿ç”¨è¯­éŸ³è¾“å…¥åŠŸèƒ½', 'error');
                            });
                    } else {
                        this.initSpeechRecognition();
                    }
                },

                initSpeechRecognition() {
                    try {
                        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                        this.speechRecognition = new SpeechRecognition();

                        // é…ç½®è¯­éŸ³è¯†åˆ«
                        this.speechRecognition.lang = 'zh-CN';
                        this.speechRecognition.continuous = false;
                        this.speechRecognition.interimResults = true; // å¯ç”¨ä¸­é—´ç»“æœ
                        this.speechRecognition.maxAlternatives = 1;

                        // å°è¯•ä½¿ç”¨æœ¬åœ°è¯­éŸ³è¯†åˆ«ï¼ˆå¦‚æœæ”¯æŒï¼‰
                        if ('webkitSpeechGrammarList' in window) {
                            const grammar = '#JSGF V1.0; grammar commands; public <command> = å‘é€ | æ¸…ç©º | å…¨å± | è®¾ç½®;';
                            const speechRecognitionList = new webkitSpeechGrammarList();
                            speechRecognitionList.addFromString(grammar, 1);
                            this.speechRecognition.grammars = speechRecognitionList;
                        }

                        // å¼€å§‹è¯†åˆ«äº‹ä»¶
                        this.speechRecognition.onstart = () => {
                            this.isRecording = true;
                            this.showNotification('ğŸ¤ å¼€å§‹è¯­éŸ³è¯†åˆ«ï¼Œè¯·è¯´è¯...', 'info');
                            console.log('ğŸ¤ è¯­éŸ³è¯†åˆ«å·²å¯åŠ¨');
                        };

                        // è¯†åˆ«ç»“æœäº‹ä»¶
                        this.speechRecognition.onresult = (event) => {
                            let transcript = '';
                            let isFinal = false;

                            // å¤„ç†è¯†åˆ«ç»“æœ
                            for (let i = event.resultIndex; i < event.results.length; i++) {
                                const result = event.results[i];
                                transcript += result[0].transcript;
                                if (result.isFinal) {
                                    isFinal = true;
                                }
                            }

                            if (isFinal) {
                                // æœ€ç»ˆç»“æœ
                                if (transcript.trim()) {
                                    this.currentMessage += transcript;
                                    this.showNotification(`âœ… è¯†åˆ«å®Œæˆ: "${transcript}"`, 'success');
                                    console.log('âœ… è¯­éŸ³è¯†åˆ«ç»“æœ:', transcript);
                                } else {
                                    this.showNotification('âš ï¸ æœªè¯†åˆ«åˆ°æœ‰æ•ˆè¯­éŸ³ï¼Œè¯·é‡è¯•', 'warning');
                                }
                            } else {
                                // ä¸­é—´ç»“æœï¼ˆå®æ—¶æ˜¾ç¤ºï¼‰
                                console.log('ğŸ”„ å®æ—¶è¯†åˆ«:', transcript);
                            }
                        };

                        // é”™è¯¯å¤„ç†
                        this.speechRecognition.onerror = (event) => {
                            console.error('è¯­éŸ³è¯†åˆ«é”™è¯¯:', event.error);
                            this.isRecording = false;

                            let errorMessage = 'è¯­éŸ³è¯†åˆ«å¤±è´¥';
                            switch (event.error) {
                                case 'no-speech':
                                    errorMessage = 'æœªæ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡è¯•';
                                    break;
                                case 'audio-capture':
                                    errorMessage = 'æ— æ³•è®¿é—®éº¦å…‹é£ï¼Œè¯·æ£€æŸ¥è®¾å¤‡';
                                    break;
                                case 'not-allowed':
                                    errorMessage = 'éº¦å…‹é£æƒé™è¢«æ‹’ç»ï¼Œè¯·å…è®¸è®¿é—®';
                                    break;
                                case 'network':
                                    errorMessage = 'ç½‘ç»œé”™è¯¯ï¼Œå°è¯•ä½¿ç”¨ç¦»çº¿æ¨¡å¼';
                                    // å°è¯•ç¦»çº¿è¯­éŸ³è¯†åˆ«
                                    this.tryOfflineVoiceRecognition();
                                    return; // ä¸æ˜¾ç¤ºé”™è¯¯ï¼Œå°è¯•ç¦»çº¿æ¨¡å¼
                                    break;
                                case 'service-not-allowed':
                                    errorMessage = 'è¯­éŸ³è¯†åˆ«æœåŠ¡ä¸å¯ç”¨';
                                    break;
                                default:
                                    errorMessage = `è¯­éŸ³è¯†åˆ«é”™è¯¯: ${event.error}`;
                            }

                            this.showNotification(errorMessage, 'error');
                        };

                        // è¯†åˆ«ç»“æŸäº‹ä»¶
                        this.speechRecognition.onend = () => {
                            this.isRecording = false;
                            console.log('ğŸ”š è¯­éŸ³è¯†åˆ«å·²ç»“æŸ');
                        };

                        // å¯åŠ¨è¯†åˆ«
                        this.speechRecognition.start();

                    } catch (error) {
                        console.error('åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«å¤±è´¥:', error);
                        this.showNotification('è¯­éŸ³è¯†åˆ«åˆå§‹åŒ–å¤±è´¥: ' + error.message, 'error');
                        this.isRecording = false;
                    }
                },

                stopVoiceRecognition() {
                    if (this.speechRecognition) {
                        this.speechRecognition.stop();
                        this.isRecording = false;
                        this.showNotification('ğŸ›‘ è¯­éŸ³è¯†åˆ«å·²åœæ­¢', 'info');
                        console.log('ğŸ›‘ æ‰‹åŠ¨åœæ­¢è¯­éŸ³è¯†åˆ«');
                    }
                },

                // è¯­éŸ³å‘½ä»¤å¤„ç†
                processVoiceCommand(transcript) {
                    const command = transcript.toLowerCase().trim();

                    // è¯­éŸ³å‘½ä»¤æ˜ å°„
                    const voiceCommands = {
                        'å‘é€': () => this.sendMessage(),
                        'æ¸…ç©º': () => this.clearChat(),
                        'å…¨å±': () => this.toggleFullscreen(),
                        'è®¾ç½®': () => this.toggleAdvancedPanel(),
                        'æ•°å­¦æ¨¡å¼': () => this.toggleMathInput(),
                        'ä¿å­˜ä¼šè¯': () => this.saveCurrentSession(),
                        'å¯¼å‡ºå¯¹è¯': () => this.exportChat()
                    };

                    // æ£€æŸ¥æ˜¯å¦ä¸ºè¯­éŸ³å‘½ä»¤
                    for (const [cmd, action] of Object.entries(voiceCommands)) {
                        if (command.includes(cmd)) {
                            action();
                            this.showNotification(`âœ¨ æ‰§è¡Œè¯­éŸ³å‘½ä»¤: ${cmd}`, 'success');
                            return true;
                        }
                    }

                    return false;
                },

                // ç¦»çº¿è¯­éŸ³è¯†åˆ«å°è¯•
                tryOfflineVoiceRecognition() {
                    console.log('ğŸ”„ å°è¯•ç¦»çº¿è¯­éŸ³è¯†åˆ«æ¨¡å¼');
                    this.showNotification('ğŸ”„ åˆ‡æ¢åˆ°ç¦»çº¿æ¨¡å¼ï¼ŒåŠŸèƒ½å¯èƒ½å—é™', 'warning');

                    // ç®€åŒ–çš„ç¦»çº¿æ¨¡å¼ - ä½¿ç”¨é”®ç›˜è¾“å…¥æ¨¡æ‹Ÿ
                    const offlineInput = prompt('ç¦»çº¿æ¨¡å¼ï¼šè¯·è¾“å…¥æ‚¨çš„é—®é¢˜');
                    if (offlineInput && offlineInput.trim()) {
                        this.currentMessage += offlineInput;
                        this.showNotification('âœ… ç¦»çº¿è¾“å…¥å®Œæˆ', 'success');
                    }

                    this.isRecording = false;
                },

                // è¯­éŸ³è¾“å…¥å¢å¼ºåŠŸèƒ½
                enhanceVoiceInput() {
                    // æ·»åŠ è¯­éŸ³è¾“å…¥å¿«æ·é”®
                    document.addEventListener('keydown', (event) => {
                        // Ctrl + Shift + V å¯åŠ¨è¯­éŸ³è¾“å…¥
                        if (event.ctrlKey && event.shiftKey && event.key === 'V') {
                            event.preventDefault();
                            this.toggleVoiceInput();
                        }

                        // ç©ºæ ¼é”®åœæ­¢å½•éŸ³ï¼ˆå½“æ­£åœ¨å½•éŸ³æ—¶ï¼‰
                        if (event.code === 'Space' && this.isRecording) {
                            event.preventDefault();
                            this.stopVoiceRecognition();
                        }
                    });

                    // æ·»åŠ è¯­éŸ³è¾“å…¥æç¤º
                    this.showNotification('ğŸ’¡ è¯­éŸ³è¾“å…¥æç¤º: Ctrl+Shift+V å¿«é€Ÿå¯åŠ¨ï¼Œç©ºæ ¼é”®åœæ­¢å½•éŸ³', 'info');
                },

                // æ™ºèƒ½è¯é¢˜åˆ†æ
                analyzeUserQuestion(question) {
                    const topics = {
                        'ä¼¯åŠªåˆ©': 'ä¼¯åŠªåˆ©æ–¹ç¨‹',
                        'é›·è¯º': 'é›·è¯ºæ•°',
                        'å±‚æµ': 'æµåŠ¨çŠ¶æ€',
                        'æ¹æµ': 'æµåŠ¨çŠ¶æ€',
                        'ç²˜æ€§': 'æµä½“æ€§è´¨',
                        'è¾¹ç•Œå±‚': 'è¾¹ç•Œå±‚ç†è®º',
                        'æ¶¡é‡': 'æ¶¡é‡ç†è®º',
                        'è¿ç»­æ€§': 'è¿ç»­æ€§æ–¹ç¨‹',
                        'NSæ–¹ç¨‹': 'Navier-Stokesæ–¹ç¨‹',
                        'å‹åŠ›': 'å‹åŠ›åˆ†æ',
                        'é€Ÿåº¦': 'é€Ÿåº¦åˆ†å¸ƒ',
                        'é˜»åŠ›': 'é˜»åŠ›åˆ†æ',
                        'å‡åŠ›': 'å‡åŠ›ç†è®º'
                    };

                    for (const [keyword, topic] of Object.entries(topics)) {
                        if (question.includes(keyword)) {
                            this.currentTopic = topic;
                            this.updateLearningPath(topic);
                            break;
                        }
                    }
                },

                // æ›´æ–°å­¦ä¹ è·¯å¾„
                updateLearningPath(topic) {
                    if (!this.learningPath.includes(topic)) {
                        this.learningPath.push(topic);

                        // æ¨èç›¸å…³è¯é¢˜
                        const recommendations = this.getTopicRecommendations(topic);
                        if (recommendations.length > 0) {
                            this.showNotification(`ğŸ’¡ ç›¸å…³è¯é¢˜æ¨è: ${recommendations.join(', ')}`, 'info');
                        }
                    }
                },

                // è·å–è¯é¢˜æ¨è
                getTopicRecommendations(currentTopic) {
                    const topicMap = {
                        'ä¼¯åŠªåˆ©æ–¹ç¨‹': ['è¿ç»­æ€§æ–¹ç¨‹', 'å‹åŠ›åˆ†æ'],
                        'é›·è¯ºæ•°': ['å±‚æµæ¹æµ', 'è¾¹ç•Œå±‚ç†è®º'],
                        'æµåŠ¨çŠ¶æ€': ['é›·è¯ºæ•°', 'è¾¹ç•Œå±‚ç†è®º'],
                        'Navier-Stokesæ–¹ç¨‹': ['æ¶¡é‡ç†è®º', 'è¾¹ç•Œå±‚ç†è®º'],
                        'è¾¹ç•Œå±‚ç†è®º': ['é˜»åŠ›åˆ†æ', 'å‡åŠ›ç†è®º']
                    };

                    return topicMap[currentTopic] || [];
                },

                // æ£€æŸ¥æ˜¯å¦æ˜¯å¤æ‚æ•°å­¦é—®é¢˜
                isComplexMathQuestion(question) {
                    const mathKeywords = ['æ¨å¯¼', 'è¯æ˜', 'æ±‚è§£', 'è®¡ç®—', 'æ–¹ç¨‹', 'ç§¯åˆ†', 'å¾®åˆ†', 'å¯¼æ•°', 'æé™', 'çº§æ•°'];
                    const complexKeywords = ['çº³ç»´-æ–¯æ‰˜å…‹æ–¯', 'Navier-Stokes', 'æ¬§æ‹‰æ–¹ç¨‹', 'ä¼¯åŠªåˆ©', 'è¿ç»­æ€§æ–¹ç¨‹', 'åŠ¨é‡æ–¹ç¨‹'];
                    const lowerQuestion = question.toLowerCase();

                    return mathKeywords.some(keyword => lowerQuestion.includes(keyword)) ||
                           complexKeywords.some(keyword => lowerQuestion.includes(keyword));
                },

                // æ™ºèƒ½æ¨¡å‹é€‰æ‹©å™¨
                selectOptimalModel(question) {
                    const lowerQuestion = question.toLowerCase();
                    console.log('ğŸ§  æ™ºèƒ½æ¨¡å‹é€‰æ‹© - åˆ†æé—®é¢˜:', question);

                    // æ£€æµ‹æ˜¯å¦æ¶‰åŠæ•°å­¦æ¨å¯¼
                    const derivationKeywords = [
                        'æ¨å¯¼', 'è¯æ˜', 'æ±‚è§£', 'è®¡ç®—', 'è§£æ', 'åˆ†æ',
                        'å¦‚ä½•å¾—åˆ°', 'æ€ä¹ˆæ¨å‡º', 'ä¸ºä»€ä¹ˆç­‰äº', 'æ­¥éª¤',
                        'å…¬å¼æ¨å¯¼', 'æ•°å­¦æ¨å¯¼', 'ç†è®ºæ¨å¯¼',
                        'derive', 'proof', 'calculate', 'solve',
                        'âˆ‚', 'âˆ‡', 'âˆ«', 'ç§¯åˆ†', 'å¾®åˆ†', 'åå¯¼æ•°',
                        'æ¬§æ‹‰æ–¹ç¨‹', 'çº³ç»´-æ–¯æ‰˜å…‹æ–¯', 'ä¼¯åŠªåˆ©',
                        'è¿ç»­æ€§æ–¹ç¨‹', 'åŠ¨é‡æ–¹ç¨‹', 'èƒ½é‡æ–¹ç¨‹'
                    ];

                    // æ£€æµ‹æ˜¯å¦æ¶‰åŠå¤æ‚æ•°å­¦
                    const complexMathKeywords = [
                        'å‘é‡', 'æ¢¯åº¦', 'æ•£åº¦', 'æ—‹åº¦', 'æ‹‰æ™®æ‹‰æ–¯',
                        'é›·è¯ºæ•°', 'é©¬èµ«æ•°', 'æ™®æœ—ç‰¹æ•°',
                        'æ¹æµ', 'å±‚æµ', 'è¾¹ç•Œå±‚',
                        'æœ‰é™å…ƒ', 'æ•°å€¼æ¨¡æ‹Ÿ', 'CFD'
                    ];

                    const hasDerivation = derivationKeywords.some(keyword =>
                        lowerQuestion.includes(keyword)
                    );

                    const hasComplexMath = complexMathKeywords.some(keyword =>
                        lowerQuestion.includes(keyword)
                    );

                    console.log('ğŸ” å…³é”®è¯æ£€æµ‹ç»“æœ:', {
                        hasDerivation,
                        hasComplexMath,
                        matchedDerivation: derivationKeywords.filter(k => lowerQuestion.includes(k)),
                        matchedComplexMath: complexMathKeywords.filter(k => lowerQuestion.includes(k))
                    });

                    if (hasDerivation || hasComplexMath) {
                        console.log('ğŸ¯ é€‰æ‹©DeepSeek-R1æ¨¡å‹è¿›è¡Œæ•°å­¦æ¨å¯¼');
                        // ä½¿ç”¨DeepSeek-R1è¿›è¡Œæ•°å­¦æ¨å¯¼ï¼Œå¢åŠ è¶…æ—¶æ—¶é—´å’Œé‡è¯•æœºåˆ¶
                        const config = {
                            strategy: 'reasoning',
                            features: ['reasoning', 'math', 'derivation'],
                            maxTokens: 2000,
                            temperature: 0.3,
                            preferredModel: 'deepseek-r1',
                            requestTimeout: 600000, // 10åˆ†é’Ÿè¶…æ—¶ï¼Œç»™R1å……è¶³çš„æ¨ç†æ—¶é—´
                            systemPrompt: `ä½ æ˜¯ä¸€ä½èµ„æ·±çš„æµä½“åŠ›å­¦æ•™æˆï¼Œæ“…é•¿æ•°å­¦æ¨å¯¼å’Œç†è®ºåˆ†æã€‚è¯·è¯¦ç»†å›ç­”å­¦ç”Ÿçš„é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š

1. **ç†è®ºåŸºç¡€**ï¼šç›¸å…³çš„åŸºæœ¬åŸç†å’Œå‡è®¾
2. **æ•°å­¦æ¨å¯¼**ï¼šå®Œæ•´çš„æ¨å¯¼è¿‡ç¨‹ï¼Œæ¯ä¸€æ­¥éƒ½è¦æ¸…æ™°
3. **å…¬å¼è§£é‡Š**ï¼šæ¯ä¸ªç¬¦å·å’Œé¡¹çš„ç‰©ç†æ„ä¹‰
4. **ç»“æœåˆ†æ**ï¼šæ¨å¯¼ç»“æœçš„ç‰©ç†æ„ä¹‰å’Œåº”ç”¨

**é‡è¦ï¼šæ•°å­¦å…¬å¼æ ¼å¼è¦æ±‚**
- ä½¿ç”¨LaTeXè¯­æ³•ï¼Œç”¨$$åŒ…å›´æ˜¾ç¤ºå…¬å¼ï¼Œç”¨$åŒ…å›´å†…è”å…¬å¼
- å‘é‡ä½¿ç”¨\\vec{v}æ ¼å¼ï¼Œä¼šè‡ªåŠ¨æ¸²æŸ“ä¸ºvâ†’
- å¸¸ç”¨ç¬¦å·ï¼š\\rhoâ†’Ï, \\muâ†’Î¼, \\nablaâ†’âˆ‡, \\partialâ†’âˆ‚
- åˆ†æ•°ä½¿ç”¨\\frac{åˆ†å­}{åˆ†æ¯}æ ¼å¼
- ä¾‹å¦‚ï¼š$$\\frac{\\partial \\vec{v}}{\\partial t} + (\\vec{v} \\cdot \\nabla)\\vec{v} = -\\frac{1}{\\rho}\\nabla p + \\vec{g}$$

ç¡®ä¿æ¨å¯¼è¿‡ç¨‹ä¸¥è°¨ã€é€»è¾‘æ¸…æ™°ï¼Œä½¿ç”¨æ ‡å‡†LaTeXè¯­æ³•ä¾¿äºç³»ç»Ÿæ¸²æŸ“ã€‚`
                        };
                        console.log('ğŸ“‹ DeepSeek-R1æ¨¡å‹é…ç½®:', config);
                        return config;
                    } else {
                        console.log('ğŸ¯ é€‰æ‹©é€šç”¨æ¨¡å‹è¿›è¡Œæ¦‚å¿µè§£é‡Š');
                        // ä½¿ç”¨é€šç”¨æ¨¡å‹è¿›è¡Œæ¦‚å¿µè§£é‡Š
                        const config = {
                            strategy: 'balanced',
                            features: ['chat', 'explanation'],
                            maxTokens: 1000,
                            temperature: 0.7,
                            preferredModel: 'auto',
                            requestTimeout: 60000, // 1åˆ†é’Ÿè¶…æ—¶ï¼Œé€‚åˆä¸€èˆ¬é—®ç­”
                            systemPrompt: `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æµä½“åŠ›å­¦æ•™å¸ˆï¼Œè¯·ç”¨ç®€æ´æ˜äº†çš„æ–¹å¼å›ç­”å­¦ç”Ÿé—®é¢˜ã€‚å›ç­”è¦åŒ…å«ï¼š

1. **æ ¸å¿ƒæ¦‚å¿µè§£é‡Š**ï¼šç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€è§£é‡Š
2. **å¿…è¦çš„å…¬å¼**ï¼šå¦‚æœé€‚ç”¨ï¼Œç”¨LaTeXè¯­æ³•è¡¨ç¤º
3. **å®é™…åº”ç”¨ä¸¾ä¾‹**ï¼šè”ç³»å®é™…ç”Ÿæ´»æˆ–å·¥ç¨‹åº”ç”¨
4. **å­¦ä¹ å»ºè®®**ï¼šç»™å‡ºè¿›ä¸€æ­¥å­¦ä¹ çš„æ–¹å‘

è¯·ä½¿ç”¨LaTeXè¯­æ³•è¡¨ç¤ºæ•°å­¦å…¬å¼ï¼Œç”¨$$åŒ…å›´æ˜¾ç¤ºå…¬å¼ï¼Œç”¨$åŒ…å›´å†…è”å…¬å¼ã€‚
è¯·ç”¨HTMLæ ¼å¼å›å¤ï¼Œä½¿ç”¨<strong>ã€<br>ç­‰æ ‡ç­¾ï¼Œè®©å†…å®¹æ˜“è¯»æ˜“æ‡‚ã€‚`
                        };
                        console.log('ğŸ“‹ é€šç”¨æ¨¡å‹é…ç½®:', config);
                        return config;
                    }
                },

                // æ™ºèƒ½å›å¤ç”Ÿæˆï¼ˆå·²åˆ é™¤é‡å¤æ–¹æ³•ï¼Œä½¿ç”¨ä¸Šé¢çš„ä¸»è¦æ–¹æ³•ï¼‰

                // å¤‡ç”¨å›å¤ç³»ç»Ÿ
                generateFallbackResponse(userMessage) {
                    const responses = [
                        'è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æµä½“åŠ›å­¦é—®é¢˜ï¼è®©æˆ‘æ¥ä¸ºæ‚¨è¯¦ç»†è§£ç­”...',
                        'æ ¹æ®æµä½“åŠ›å­¦åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ¥åˆ†æ...',
                        'è¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°æµä½“åŠ›å­¦çš„æ ¸å¿ƒæ¦‚å¿µï¼Œè®©æˆ‘ä¸ºæ‚¨é€æ­¥è§£é‡Š...',
                        'åœ¨æµä½“åŠ›å­¦ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªç»å…¸é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£...'
                    ];

                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];

                    // æ ¹æ®è¯é¢˜æ·»åŠ å…·ä½“å†…å®¹
                    if (this.currentTopic) {
                        return `${randomResponse}\n\nå…³äº${this.currentTopic}ï¼Œè¿™é‡Œæœ‰ä¸€äº›å…³é”®è¦ç‚¹éœ€è¦æ³¨æ„...`;
                    }

                    return randomResponse;
                },

                // æ•°å­¦è¾“å…¥åŠŸèƒ½
                toggleMathInput() {
                    this.mathInputMode = !this.mathInputMode;
                    if (this.mathInputMode) {
                        this.showNotification('æ•°å­¦å…¬å¼è¾“å…¥æ¨¡å¼å·²å¼€å¯', 'info');
                    }
                },

                insertMathSymbol(latex) {
                    const textarea = document.querySelector('.message-input');
                    const start = textarea.selectionStart;
                    const end = textarea.selectionEnd;

                    const before = this.currentMessage.substring(0, start);
                    const after = this.currentMessage.substring(end);

                    this.currentMessage = before + '$' + latex + '$' + after;

                    // è®¾ç½®å…‰æ ‡ä½ç½®
                    this.$nextTick(() => {
                        const newPos = start + latex.length + 2;
                        textarea.setSelectionRange(newPos, newPos);
                        textarea.focus();
                    });
                },

                insertMathTemplate(latex) {
                    const textarea = document.querySelector('.message-input');
                    const start = textarea.selectionStart;
                    const end = textarea.selectionEnd;

                    const before = this.currentMessage.substring(0, start);
                    const after = this.currentMessage.substring(end);

                    this.currentMessage = before + '$$' + latex + '$$' + after;

                    this.$nextTick(() => {
                        const newPos = start + latex.length + 4;
                        textarea.setSelectionRange(newPos, newPos);
                        textarea.focus();
                    });
                },

                insertTemplate() {
                    const templates = [
                        'è¯·è§£é‡Šä¸€ä¸‹',
                        'è¯·æ¨å¯¼',
                        'è¯·è®¡ç®—',
                        'è¯·åˆ†æ',
                        'è¯·æ¯”è¾ƒ',
                        'è¯·ä¸¾ä¾‹è¯´æ˜'
                    ];

                    // ç®€å•çš„æ¨¡æ¿é€‰æ‹©ï¼ˆå¯ä»¥åç»­æ”¹ä¸ºä¸‹æ‹‰èœå•ï¼‰
                    const template = templates[Math.floor(Math.random() * templates.length)];
                    this.currentMessage = template + this.currentMessage;
                },

                // é«˜çº§åŠŸèƒ½é¢æ¿
                toggleAdvancedPanel() {
                    this.showAdvancedPanel = !this.showAdvancedPanel;
                },

                // ä¼šè¯ç®¡ç†åŠŸèƒ½
                saveCurrentSession() {
                    const session = {
                        id: Date.now(),
                        name: `ä¼šè¯ ${new Date().toLocaleString()}`,
                        messages: [...this.messages],
                        timestamp: new Date(),
                        stats: { ...this.sessionStats }
                    };

                    this.chatSessions.push(session);
                    this.currentSessionId = session.id;

                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('aiChatSessions', JSON.stringify(this.chatSessions));
                    this.showNotification('ä¼šè¯å·²ä¿å­˜', 'success');
                },

                loadSessionHistory() {
                    try {
                        const saved = localStorage.getItem('aiChatSessions');
                        if (saved) {
                            this.chatSessions = JSON.parse(saved);
                            this.showNotification(`å·²åŠ è½½ ${this.chatSessions.length} ä¸ªå†å²ä¼šè¯`, 'info');
                        }
                    } catch (error) {
                        console.error('åŠ è½½ä¼šè¯å†å²å¤±è´¥:', error);
                        this.showNotification('åŠ è½½ä¼šè¯å†å²å¤±è´¥', 'error');
                    }
                },

                exportChat() {
                    const chatData = {
                        messages: this.messages,
                        timestamp: new Date(),
                        stats: this.sessionStats
                    };

                    const blob = new Blob([JSON.stringify(chatData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `AIå¯¹è¯è®°å½•_${new Date().toISOString().slice(0, 10)}.json`;
                    a.click();
                    URL.revokeObjectURL(url);

                    this.showNotification('å¯¹è¯è®°å½•å·²å¯¼å‡º', 'success');
                },

                clearAllHistory() {
                    if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                        this.chatSessions = [];
                        localStorage.removeItem('aiChatSessions');
                        this.showNotification('æ‰€æœ‰å†å²è®°å½•å·²æ¸…ç©º', 'success');
                    }
                },

                formatDuration(ms) {
                    const seconds = Math.floor(ms / 1000);
                    const minutes = Math.floor(seconds / 60);
                    const hours = Math.floor(minutes / 60);

                    if (hours > 0) {
                        return `${hours}å°æ—¶${minutes % 60}åˆ†é’Ÿ`;
                    } else if (minutes > 0) {
                        return `${minutes}åˆ†é’Ÿ${seconds % 60}ç§’`;
                    } else {
                        return `${seconds}ç§’`;
                    }
                },

                // é«˜çº§åŠŸèƒ½é¢æ¿
                toggleAdvancedPanel() {
                    this.showAdvancedPanel = !this.showAdvancedPanel;
                    if (this.showAdvancedPanel) {
                        this.showNotification('é«˜çº§åŠŸèƒ½é¢æ¿å·²æ‰“å¼€', 'info');
                    }
                },

                // åˆå§‹åŒ–æ™ºèƒ½AIç³»ç»Ÿ
                async initSmartAI() {
                    try {
                        if (window.SmartModelSelector && window.AppConfig) {
                            console.log('ğŸ”§ åˆå§‹åŒ–æ™ºèƒ½AIç³»ç»Ÿ...');
                            const smartConfig = window.AppConfig.api.smartAI;

                            window.smartModelSelectorInstance = await window.SmartModelSelector.init({
                                apiKey: smartConfig.apiKey,
                                apiUrl: smartConfig.endpoint,
                                defaultStrategy: smartConfig.defaultStrategy,
                                maxRetries: smartConfig.maxRetries,
                                requestTimeout: smartConfig.requestTimeout,
                                skipAvailabilityCheck: smartConfig.skipAvailabilityCheck
                            });

                            console.log('âœ… æ™ºèƒ½AIç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
                        }
                    } catch (error) {
                        console.warn('âš ï¸ æ™ºèƒ½AIç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:', error);
                    }
                },

                // å¤„ç†æ•°å­¦å…¬å¼ - çº¯CSSæ–¹æ¡ˆ
                processMathFormulas() {
                    console.log('ğŸ”¢ å¤„ç†æ•°å­¦å…¬å¼ - ä½¿ç”¨çº¯CSSæ–¹æ¡ˆ');

                    // å¤„ç†çŸ¥è¯†åº“ä¸­çš„å…¬å¼å®¹å™¨
                    document.querySelectorAll('.math-formula').forEach(el => {
                        this.processFormulaElement(el);
                    });

                    // å¤„ç†æ¶ˆæ¯å†…å®¹ä¸­çš„å…¬å¼
                    document.querySelectorAll('.message-content').forEach(el => {
                        this.processFormulaElement(el);
                    });

                    console.log('âœ… æ•°å­¦å…¬å¼å¤„ç†å®Œæˆ');
                },

                // å¤„ç†å•ä¸ªå…ƒç´ ä¸­çš„å…¬å¼
                processFormulaElement(el) {
                    if (!el) return;
                    let content = el.innerHTML;

                    // æ£€æŸ¥æ˜¯å¦åŒ…å«LaTeXå…¬å¼
                    const hasLatex = content.includes('\\') || content.includes('$$') || content.includes('$');
                    if (!hasLatex) {
                        return;
                    }

                    console.log('ğŸ”¢ å¤„ç†LaTeXå…¬å¼:', content.substring(0, 100) + '...');

                    // é¦–å…ˆå¤„ç†LaTeXç¬¦å·è½¬æ¢
                    const processLatexSymbols = (formula) => {
                        return formula
                            // åˆ†æ•°
                            .replace(/\\frac\{([^}]+)\}\{([^}]+)\}/g, '<span class="fraction"><span class="numerator">$1</span><span class="denominator">$2</span></span>')
                            // å¹³æ–¹æ ¹
                            .replace(/\\sqrt\{([^}]+)\}/g, '<span class="sqrt">âˆš<span class="sqrt-content">$1</span></span>')
                            // ä¸Šä¸‹æ ‡
                            .replace(/\^{([^}]+)}/g, '<sup>$1</sup>')
                            .replace(/_{([^}]+)}/g, '<sub>$1</sub>')
                            .replace(/\^(\w+)/g, '<sup>$1</sup>')
                            .replace(/_(\w+)/g, '<sub>$1</sub>')
                            // å¸Œè…Šå­—æ¯ - å°å†™
                            .replace(/\\alpha/g, 'Î±')
                            .replace(/\\beta/g, 'Î²')
                            .replace(/\\gamma/g, 'Î³')
                            .replace(/\\delta/g, 'Î´')
                            .replace(/\\epsilon/g, 'Îµ')
                            .replace(/\\varepsilon/g, 'Îµ')
                            .replace(/\\zeta/g, 'Î¶')
                            .replace(/\\eta/g, 'Î·')
                            .replace(/\\theta/g, 'Î¸')
                            .replace(/\\vartheta/g, 'Ï‘')
                            .replace(/\\iota/g, 'Î¹')
                            .replace(/\\kappa/g, 'Îº')
                            .replace(/\\lambda/g, 'Î»')
                            .replace(/\\mu/g, 'Î¼')
                            .replace(/\\nu/g, 'Î½')
                            .replace(/\\xi/g, 'Î¾')
                            .replace(/\\pi/g, 'Ï€')
                            .replace(/\\varpi/g, 'Ï–')
                            .replace(/\\rho/g, 'Ï')
                            .replace(/\\varrho/g, 'Ï±')
                            .replace(/\\sigma/g, 'Ïƒ')
                            .replace(/\\varsigma/g, 'Ï‚')
                            .replace(/\\tau/g, 'Ï„')
                            .replace(/\\upsilon/g, 'Ï…')
                            .replace(/\\phi/g, 'Ï†')
                            .replace(/\\varphi/g, 'Ï†')
                            .replace(/\\chi/g, 'Ï‡')
                            .replace(/\\psi/g, 'Ïˆ')
                            .replace(/\\omega/g, 'Ï‰')
                            // å¸Œè…Šå­—æ¯ - å¤§å†™
                            .replace(/\\Gamma/g, 'Î“')
                            .replace(/\\Delta/g, 'Î”')
                            .replace(/\\Theta/g, 'Î˜')
                            .replace(/\\Lambda/g, 'Î›')
                            .replace(/\\Xi/g, 'Î')
                            .replace(/\\Pi/g, 'Î ')
                            .replace(/\\Sigma/g, 'Î£')
                            .replace(/\\Upsilon/g, 'Î¥')
                            .replace(/\\Phi/g, 'Î¦')
                            .replace(/\\Psi/g, 'Î¨')
                            .replace(/\\Omega/g, 'Î©')
                            // æ•°å­¦ç¬¦å·
                            .replace(/\\nabla/g, 'âˆ‡')
                            .replace(/\\partial/g, 'âˆ‚')
                            .replace(/\\infty/g, 'âˆ')
                            .replace(/\\approx/g, 'â‰ˆ')
                            .replace(/\\neq/g, 'â‰ ')
                            .replace(/\\leq/g, 'â‰¤')
                            .replace(/\\geq/g, 'â‰¥')
                            .replace(/\\ll/g, 'â‰ª')
                            .replace(/\\gg/g, 'â‰«')
                            .replace(/\\cdot/g, 'Â·')
                            .replace(/\\times/g, 'Ã—')
                            .replace(/\\otimes/g, 'âŠ—')
                            .replace(/\\oplus/g, 'âŠ•')
                            .replace(/\\div/g, 'Ã·')
                            .replace(/\\pm/g, 'Â±')
                            .replace(/\\mp/g, 'âˆ“')
                            .replace(/\\equiv/g, 'â‰¡')
                            .replace(/\\sim/g, 'âˆ¼')
                            .replace(/\\simeq/g, 'â‰ƒ')
                            .replace(/\\cong/g, 'â‰…')
                            .replace(/\\propto/g, 'âˆ')
                            // ç‚¹ç¬¦å·
                            .replace(/\\dot\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">Ë™</span></span>')
                            .replace(/\\ddot\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">Â¨</span></span>')
                            .replace(/\\hat\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">^</span></span>')
                            .replace(/\\tilde\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">~</span></span>')
                            .replace(/\\bar\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.3em;left:0;right:0;height:1px;background:currentColor;"></span></span>')
                            // ç§¯åˆ†ç¬¦å·
                            .replace(/\\int/g, '<span class="integral math-symbol">âˆ«</span>')
                            .replace(/\\iint/g, '<span class="integral math-symbol">âˆ¬</span>')
                            .replace(/\\iiint/g, '<span class="integral math-symbol">âˆ­</span>')
                            .replace(/\\oint/g, '<span class="integral math-symbol">âˆ®</span>')
                            // æ±‚å’Œç¬¦å·
                            .replace(/\\sum/g, 'âˆ‘')
                            .replace(/\\prod/g, 'âˆ')
                            .replace(/\\coprod/g, 'âˆ')
                            // æé™ç¬¦å·
                            .replace(/\\lim/g, 'lim')
                            .replace(/\\limsup/g, 'lim sup')
                            .replace(/\\liminf/g, 'lim inf')
                            .replace(/\\max/g, 'max')
                            .replace(/\\min/g, 'min')
                            .replace(/\\sup/g, 'sup')
                            .replace(/\\inf/g, 'inf')
                            // ä¸‰è§’å‡½æ•°
                            .replace(/\\sin/g, 'sin')
                            .replace(/\\cos/g, 'cos')
                            .replace(/\\tan/g, 'tan')
                            .replace(/\\cot/g, 'cot')
                            .replace(/\\sec/g, 'sec')
                            .replace(/\\csc/g, 'csc')
                            .replace(/\\arcsin/g, 'arcsin')
                            .replace(/\\arccos/g, 'arccos')
                            .replace(/\\arctan/g, 'arctan')
                            .replace(/\\sinh/g, 'sinh')
                            .replace(/\\cosh/g, 'cosh')
                            .replace(/\\tanh/g, 'tanh')
                            // å¯¹æ•°å‡½æ•°
                            .replace(/\\log/g, 'log')
                            .replace(/\\ln/g, 'ln')
                            .replace(/\\lg/g, 'lg')
                            .replace(/\\exp/g, 'exp')
                            // ç®­å¤´
                            .replace(/\\rightarrow/g, 'â†’')
                            .replace(/\\leftarrow/g, 'â†')
                            .replace(/\\leftrightarrow/g, 'â†”')
                            .replace(/\\Rightarrow/g, 'â‡’')
                            .replace(/\\Leftarrow/g, 'â‡')
                            .replace(/\\Leftrightarrow/g, 'â‡”')
                            .replace(/\\uparrow/g, 'â†‘')
                            .replace(/\\downarrow/g, 'â†“')
                            .replace(/\\updownarrow/g, 'â†•')
                            .replace(/\\nearrow/g, 'â†—')
                            .replace(/\\searrow/g, 'â†˜')
                            .replace(/\\swarrow/g, 'â†™')
                            .replace(/\\nwarrow/g, 'â†–')
                            .replace(/\\top/g, 'áµ€')
                            // é›†åˆç¬¦å·
                            .replace(/\\in/g, 'âˆˆ')
                            .replace(/\\notin/g, 'âˆ‰')
                            .replace(/\\subset/g, 'âŠ‚')
                            .replace(/\\supset/g, 'âŠƒ')
                            .replace(/\\subseteq/g, 'âŠ†')
                            .replace(/\\supseteq/g, 'âŠ‡')
                            .replace(/\\cap/g, 'âˆ©')
                            .replace(/\\cup/g, 'âˆª')
                            .replace(/\\setminus/g, 'âˆ–')
                            .replace(/\\emptyset/g, 'âˆ…')
                            .replace(/\\varnothing/g, 'âˆ…')
                            // é€»è¾‘ç¬¦å·
                            .replace(/\\forall/g, 'âˆ€')
                            .replace(/\\exists/g, 'âˆƒ')
                            .replace(/\\nexists/g, 'âˆ„')
                            .replace(/\\land/g, 'âˆ§')
                            .replace(/\\lor/g, 'âˆ¨')
                            .replace(/\\lnot/g, 'Â¬')
                            .replace(/\\neg/g, 'Â¬')
                            // å‘é‡å’ŒçŸ©é˜µ
                            .replace(/\\vec\{([^}]+)\}/g, '<span class="vector-perfect">$1</span>')
                            .replace(/\\mathbf\{([^}]+)\}/g, '<strong>$1</strong>')
                            .replace(/\\boldsymbol\{([^}]+)\}/g, '<strong>$1</strong>')
                            .replace(/\\mathbb\{([^}]+)\}/g, '<span style="font-weight:bold;font-family:serif;">$1</span>')
                            .replace(/\\mathcal\{([^}]+)\}/g, '<span style="font-family:cursive;font-style:italic;">$1</span>')
                            .replace(/\\mathfrak\{([^}]+)\}/g, '<span style="font-family:serif;font-weight:bold;">$1</span>')
                            // å¾®åˆ†ç¬¦å·
                            .replace(/\\mathrm\{d\}/g, 'd')
                            .replace(/\\,\s*d/g, ' d')
                            // å¸¸ç”¨å¸¸æ•°
                            .replace(/\\mathbf\{I\}/g, '<strong>I</strong>')
                            .replace(/\\mathbf\{0\}/g, '<strong>0</strong>')
                            // æ›´å¤šè¿ç®—ç¬¦
                            .replace(/\\ast/g, 'âˆ—')
                            .replace(/\\star/g, 'â‹†')
                            .replace(/\\circ/g, 'âˆ˜')
                            .replace(/\\bullet/g, 'â€¢')
                            .replace(/\\diamond/g, 'â‹„')
                            .replace(/\\triangle/g, 'â–³')
                            .replace(/\\triangledown/g, 'â–½')
                            .replace(/\\square/g, 'â–¡')
                            .replace(/\\blacksquare/g, 'â– ')
                            .replace(/\\bigcirc/g, 'â—‹')
                            .replace(/\\bigtriangleup/g, 'â–³')
                            .replace(/\\bigtriangledown/g, 'â–½')
                            // å…³ç³»ç¬¦å·
                            .replace(/\\parallel/g, 'âˆ¥')
                            .replace(/\\perp/g, 'âŠ¥')
                            .replace(/\\angle/g, 'âˆ ')
                            .replace(/\\sphericalangle/g, 'âˆ¢')
                            .replace(/\\measuredangle/g, 'âˆ¡')
                            // å…¶ä»–ç¬¦å·
                            .replace(/\\hbar/g, 'â„')
                            .replace(/\\ell/g, 'â„“')
                            .replace(/\\wp/g, 'â„˜')
                            .replace(/\\Re/g, 'â„œ')
                            .replace(/\\Im/g, 'â„‘')
                            .replace(/\\aleph/g, 'â„µ')
                            .replace(/\\beth/g, 'â„¶')
                            .replace(/\\gimel/g, 'â„·')
                            .replace(/\\daleth/g, 'â„¸')
                            // å¤„ç† \left å’Œ \right å‘½ä»¤
                            .replace(/\\left\s*\(/g, '(')
                            .replace(/\\right\s*\)/g, ')')
                            .replace(/\\left\s*\[/g, '[')
                            .replace(/\\right\s*\]/g, ']')
                            .replace(/\\left\s*\{/g, '{')
                            .replace(/\\right\s*\}/g, '}')
                            .replace(/\\left\s*\|/g, '|')
                            .replace(/\\right\s*\|/g, '|')
                            .replace(/\\left\s*\\langle/g, 'âŸ¨')
                            .replace(/\\right\s*\\rangle/g, 'âŸ©')
                            .replace(/\\left\s*\\lceil/g, 'âŒˆ')
                            .replace(/\\right\s*\\rceil/g, 'âŒ‰')
                            .replace(/\\left\s*\\lfloor/g, 'âŒŠ')
                            .replace(/\\right\s*\\rfloor/g, 'âŒ‹')
                            // å¤„ç†å•ç‹¬çš„ \left å’Œ \rightï¼ˆç§»é™¤å®ƒä»¬ï¼‰
                            .replace(/\\left\s*/g, '')
                            .replace(/\\right\s*/g, '');
                    };

                    // å¤„ç†$$åŒ…å›´çš„æ˜¾ç¤ºå…¬å¼
                    content = content.replace(/\$\$([\s\S]*?)\$\$/g, (match, formula) => {
                        console.log('ğŸ“ å¤„ç†æ˜¾ç¤ºå…¬å¼:', formula);
                        const processedFormula = processLatexSymbols(formula);
                        return `<div class="math-display">${processedFormula}</div>`;
                    });

                    // å¤„ç†$åŒ…å›´çš„å†…è”å…¬å¼
                    content = content.replace(/\$([^$\n]+)\$/g, (match, formula) => {
                        console.log('ğŸ“ å¤„ç†å†…è”å…¬å¼:', formula);
                        const processedFormula = processLatexSymbols(formula);
                        return `<span class="math-inline">${processedFormula}</span>`;
                    });

                    // LaTeXç¬¦å·å·²åœ¨ä¸Šé¢çš„processLatexSymbolså‡½æ•°ä¸­å¤„ç†ï¼Œè¿™é‡Œä¸éœ€è¦é‡å¤å¤„ç†

                    el.innerHTML = content;

                    // åªå¯¹å…¬å¼å®¹å™¨è®¾ç½®æ˜¾ç¤ºæ ·å¼
                    if (el.classList.contains('math-formula')) {
                        el.style.display = 'block';
                        el.style.visibility = 'visible';
                    }
                }
            },

            mounted() {
                console.log('ğŸš€ Vueåº”ç”¨å·²æŒ‚è½½');

                // ç«‹å³æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
                this.showNotification('AIå­¦ä¹ åŠ©æ‰‹å·²å°±ç»ªï¼', 'success');

                // æ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬
                document.addEventListener('keydown', this.handleKeyboard);

                // å¼‚æ­¥åˆå§‹åŒ–å…¶ä»–åŠŸèƒ½ï¼ˆä¸é˜»å¡ç•Œé¢ï¼‰
                setTimeout(() => {
                    this.initSmartAI().catch(error => {
                        console.warn('AIç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:', error);
                    });
                    this.processMathFormulas(); // å¤„ç†æ•°å­¦å…¬å¼
                    this.enhanceVoiceInput(); // åˆå§‹åŒ–è¯­éŸ³è¾“å…¥å¢å¼ºåŠŸèƒ½
                }, 100);

                console.log('ğŸ¤– AIå­¦ä¹ åŠ©æ‰‹å·²å¯åŠ¨');
            },

            beforeUnmount() {
                // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
                document.removeEventListener('keydown', this.handleKeyboard);
                document.body.style.overflow = '';
            }
        });

        // ç«‹å³éšè—åŠ è½½ç•Œé¢çš„ç´§æ€¥æªæ–½
        setTimeout(() => {
            const loadingOverlay = document.querySelector('.loading-overlay');
            if (loadingOverlay) {
                console.log('ğŸš¨ ç´§æ€¥éšè—åŠ è½½ç•Œé¢');
                loadingOverlay.style.display = 'none';
            }
        }, 2000); // 2ç§’åå¼ºåˆ¶éšè—

        // æŒ‚è½½Vueåº”ç”¨
        try {
            app.mount('#app');
            console.log('âœ… Vueåº”ç”¨æŒ‚è½½æˆåŠŸ');

            // æŒ‚è½½æˆåŠŸåç«‹å³éšè—åŠ è½½ç•Œé¢
            setTimeout(() => {
                const loadingOverlay = document.querySelector('.loading-overlay');
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
            }, 500);

        } catch (error) {
            console.error('âŒ Vueåº”ç”¨æŒ‚è½½å¤±è´¥:', error);
            // å¦‚æœVueæŒ‚è½½å¤±è´¥ï¼Œè‡³å°‘éšè—åŠ è½½ç•Œé¢
            setTimeout(() => {
                const loadingOverlay = document.querySelector('.loading-overlay');
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
            }, 1000);
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„é¢å¤–æ£€æŸ¥
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“„ DOMå†…å®¹åŠ è½½å®Œæˆ');
        });

        window.addEventListener('load', function() {
            console.log('ğŸŒ é¡µé¢å®Œå…¨åŠ è½½å®Œæˆ');
            // å¦‚æœæ­¤æ—¶è¿˜åœ¨åŠ è½½çŠ¶æ€ï¼Œå¼ºåˆ¶å®Œæˆ
            setTimeout(() => {
                const loadingOverlay = document.querySelector('.loading-overlay');
                if (loadingOverlay && getComputedStyle(loadingOverlay).display !== 'none') {
                    console.warn('âš ï¸ é¡µé¢åŠ è½½å®Œæˆåå¼ºåˆ¶éšè—åŠ è½½ç•Œé¢');
                    loadingOverlay.style.display = 'none';
                }
            }, 1000);
        });

        // é¢å¤–çš„å®‰å…¨æªæ–½ï¼šå¦‚æœ5ç§’åè¿˜åœ¨åŠ è½½ï¼Œå¼ºåˆ¶éšè—åŠ è½½ç•Œé¢
        setTimeout(() => {
            const loadingOverlay = document.querySelector('.loading-overlay');
            if (loadingOverlay && getComputedStyle(loadingOverlay).display !== 'none') {
                console.warn('âš ï¸ è¶…æ—¶å¼ºåˆ¶éšè—åŠ è½½ç•Œé¢');
                loadingOverlay.style.display = 'none';
                // æ˜¾ç¤ºé”™è¯¯æç¤º
                const errorDiv = document.createElement('div');
                errorDiv.innerHTML = `
                    <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                                background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 10px;
                                box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 10001; text-align: center;
                                color: #333; max-width: 400px;">
                        <h3 style="color: #ff6b6b; margin-bottom: 10px;">âš ï¸ åŠ è½½æç¤º</h3>
                        <p>é¡µé¢åŠ è½½å®Œæˆï¼Œä½†æŸäº›èµ„æºå¯èƒ½ä»åœ¨åå°åŠ è½½ä¸­ã€‚</p>
                        <p>æ‚¨å¯ä»¥æ­£å¸¸ä½¿ç”¨AIåŠ©æ‰‹åŠŸèƒ½ã€‚</p>
                        <button onclick="this.parentElement.parentElement.remove()"
                                style="margin-top: 15px; padding: 8px 16px; background: #4facfe;
                                       color: white; border: none; border-radius: 5px; cursor: pointer;">
                            çŸ¥é“äº†
                        </button>
                    </div>
                `;
                document.body.appendChild(errorDiv);

                // 3ç§’åè‡ªåŠ¨ç§»é™¤æç¤º
                setTimeout(() => {
                    if (errorDiv.parentElement) {
                        errorDiv.remove();
                    }
                }, 3000);
            }
        }, 5000);
    </script>

    <!-- ç´§æ€¥åŠ è½½å®Œæˆè„šæœ¬ -->
    <script>
        // é¡µé¢åŠ è½½å®Œæˆåçš„ç´§æ€¥å¤„ç†
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“„ DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹ç´§æ€¥å¤„ç†');

            // 3ç§’åå¼ºåˆ¶éšè—åŠ è½½ç•Œé¢
            setTimeout(function() {
                const loadingOverlay = document.querySelector('.loading-overlay');
                if (loadingOverlay && getComputedStyle(loadingOverlay).display !== 'none') {
                    console.log('ğŸš¨ DOMåŠ è½½å®Œæˆåå¼ºåˆ¶éšè—åŠ è½½ç•Œé¢');
                    loadingOverlay.style.display = 'none';

                    // æ˜¾ç¤ºç´§æ€¥æç¤º
                    const emergencyNotice = document.createElement('div');
                    emergencyNotice.innerHTML = `
                        <div style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
                                    background: linear-gradient(135deg, #4facfe, #00f2fe); color: white;
                                    padding: 15px 25px; border-radius: 25px; z-index: 10003;
                                    box-shadow: 0 10px 30px rgba(0,0,0,0.3); animation: slideDown 0.3s ease;">
                            <i class="fas fa-check-circle"></i> AIå­¦ä¹ åŠ©æ‰‹å·²å°±ç»ªï¼
                        </div>
                    `;
                    document.body.appendChild(emergencyNotice);

                    // 3ç§’åç§»é™¤æç¤º
                    setTimeout(() => {
                        if (emergencyNotice.parentElement) {
                            emergencyNotice.remove();
                        }
                    }, 3000);
                }
            }, 3000);
        });

        // çª—å£åŠ è½½å®Œæˆçš„å¤„ç†
        window.addEventListener('load', function() {
            console.log('ğŸŒ çª—å£å®Œå…¨åŠ è½½å®Œæˆ');
            setTimeout(function() {
                const loadingOverlay = document.querySelector('.loading-overlay');
                if (loadingOverlay && getComputedStyle(loadingOverlay).display !== 'none') {
                    console.log('ğŸš¨ çª—å£åŠ è½½å®Œæˆåå¼ºåˆ¶éšè—åŠ è½½ç•Œé¢');
                    loadingOverlay.style.display = 'none';
                }
            }, 1000);
        });

        // æœ€ç»ˆçš„å®‰å…¨ç½‘ - 5ç§’åæ— è®ºå¦‚ä½•éƒ½éšè—åŠ è½½ç•Œé¢
        setTimeout(function() {
            const loadingOverlay = document.querySelector('.loading-overlay');
            if (loadingOverlay) {
                console.log('ğŸ›¡ï¸ å®‰å…¨ç½‘æ¿€æ´» - å¼ºåˆ¶éšè—åŠ è½½ç•Œé¢');
                loadingOverlay.style.display = 'none';
                loadingOverlay.style.opacity = '0';
                loadingOverlay.style.pointerEvents = 'none';
            }
        }, 5000);
    </script>
</body>
</html>