<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🤖 AI学习助手 - 流体力学学习平台</title>
    
    <!-- 外部依赖 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- 共享组件库 -->
    <script src="../js/shared-components.js"></script>
    
    <style>
        body {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            margin: 0;
            font-family: 'SF Pro Display', sans-serif;
            color: white;
        }

        .ai-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .chat-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            color: #333;
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 20px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 15px;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            margin-left: auto;
        }

        .message.ai {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
        }

        .message-header {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .message-content {
            line-height: 1.6;
        }

        .chat-input {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .input-field {
            flex: 1;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }

        .suggestions-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            color: #333;
        }

        .suggestion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .suggestion-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-card:hover {
            border-color: #667eea;
            background: #e3f2fd;
            transform: translateY(-3px);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 15px;
            max-width: 120px;
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="aiApp">
        <!-- 海洋背景 -->
        <ocean-background></ocean-background>

        <!-- 通知组件 -->
        <notification-component :notification="notification" @close="notification = ''"></notification-component>

        <!-- 加载动画 -->
        <loading-spinner :show="loading" text="AI助手启动中..."></loading-spinner>

        <div class="ai-container" v-if="!loading">
            <!-- 页面头部 -->
            <header style="text-align: center; padding: 40px 0; margin-bottom: 30px;">
                <h1><i class="fas fa-robot"></i> AI学习助手</h1>
                <p>智能问答系统，个性化学习建议和知识点解析</p>
            </header>

            <!-- 聊天面板 -->
            <div class="chat-panel">
                <div class="chat-header">
                    <h2><i class="fas fa-comments"></i> 智能对话</h2>
                    <p>向AI助手提问流体力学相关问题，获得专业解答</p>
                </div>

                <div class="chat-messages" ref="chatMessages">
                    <div v-for="message in messages" :key="message.id" class="message" :class="message.type">
                        <div class="message-header">
                            <i :class="message.type === 'user' ? 'fas fa-user' : 'fas fa-robot'"></i>
                            {{ message.type === 'user' ? '您' : 'AI助手' }}
                            <span style="font-size: 0.8em; opacity: 0.7;">{{ message.time }}</span>
                        </div>
                        <div class="message-content" v-html="message.content"></div>
                    </div>

                    <!-- 打字指示器 -->
                    <div v-if="isTyping" class="typing-indicator">
                        <i class="fas fa-robot"></i>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>

                <div class="chat-input">
                    <input 
                        v-model="inputMessage" 
                        @keyup.enter="sendMessage"
                        class="input-field" 
                        placeholder="请输入您的问题..."
                        :disabled="isTyping"
                    >
                    <button @click="sendMessage" class="send-btn" :disabled="isTyping">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <!-- 建议问题 -->
            <div class="suggestions-panel">
                <h3><i class="fas fa-lightbulb"></i> 推荐问题</h3>
                <p>点击下方问题快速开始对话</p>
                
                <div class="suggestion-grid">
                    <div 
                        v-for="suggestion in suggestions" 
                        :key="suggestion.id"
                        class="suggestion-card"
                        @click="askSuggestion(suggestion.text)"
                    >
                        <div style="font-weight: bold; margin-bottom: 10px;">
                            <i :class="suggestion.icon"></i> {{ suggestion.text }}
                        </div>
                        <div style="color: #666; font-size: 0.9em;">
                            {{ suggestion.text }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <a href="../index.html" class="back-btn">
        <i class="fas fa-arrow-left"></i> 返回主页
    </a>

    <script>
        const { createApp } = Vue;

        createApp({
            mixins: [SharedMixin],
            components: {
                'ocean-background': OceanBackground,
                'notification-component': NotificationComponent,
                'loading-spinner': LoadingSpinner
            },
            data() {
                return {
                    messages: [],
                    inputMessage: '',
                    isTyping: false,
                    suggestions: [
                        {
                            id: 1,
                            text: '什么是伯努利方程？',
                            icon: '⚡',
                            category: 'theory'
                        },
                        {
                            id: 2, 
                            text: '雷诺数的物理意义是什么？',
                            icon: '🔢',
                            category: 'theory'
                        },
                        {
                            id: 3,
                            text: '如何区分层流和湍流？',
                            icon: '🌊',
                            category: 'concept'
                        },
                        {
                            id: 4,
                            text: '流体粘性的作用机理',
                            icon: '🌀',
                            category: 'concept'
                        },
                        {
                            id: 5,
                            text: '连续性方程的推导过程',
                            icon: '⚖️',
                            category: 'theory'
                        },
                        {
                            id: 6,
                            text: '阿基米德原理的工程应用',
                            icon: '🚢',
                            category: 'application'
                        },
                        {
                            id: 7,
                            text: '如何学好流体力学？',
                            icon: '📚',
                            category: 'study'
                        },
                        {
                            id: 8,
                            text: '推荐一些练习题目',
                            icon: '🎯',
                            category: 'practice'
                        },
                        {
                            id: 9,
                            text: '边界层理论的基本概念',
                            icon: '📐',
                            category: 'advanced'
                        },
                        {
                            id: 10,
                            text: '流体力学在工程中的应用',
                            icon: '🏗️',
                            category: 'application'
                        }
                    ]
                }
            },
            methods: {
                sendMessage() {
                    if (!this.inputMessage.trim() || this.isTyping) return;
                    
                    // 添加用户消息
                    this.addMessage('user', this.inputMessage);
                    const userQuestion = this.inputMessage;
                    this.inputMessage = '';
                    
                    // 模拟AI思考
                    this.isTyping = true;
                    
                    setTimeout(() => {
                        const response = this.generateAIResponse(userQuestion);
                        this.addMessage('ai', response);
                        this.isTyping = false;
                        this.scrollToBottom();
                    }, 2000);
                },
                
                addMessage(type, content) {
                    const message = {
                        id: Date.now(),
                        type: type,
                        content: content,
                        time: new Date().toLocaleTimeString()
                    };
                    this.messages.push(message);
                    this.saveToStorage('aiMessages', this.messages);
                    this.scrollToBottom();
                },
                
                generateAIResponse(message) {
                    // 模拟AI响应延迟
                    this.isTyping = true;
                    
                    setTimeout(() => {
                        let response = '';
                        const msg = message.toLowerCase();
                        
                        // 流体力学专业知识问答
                        if (msg.includes('伯努利') || msg.includes('bernoulli')) {
                            response = `💡 关于伯努利方程：

**伯努利方程**：p + ½ρV² + ρgh = 常数

**适用条件**：
• 理想流体（无粘性、不可压缩）
• 定常流动
• 沿流线应用

**物理意义**：
• p - 静压能
• ½ρV² - 动能
• ρgh - 位能

伯努利方程体现了流动过程中机械能守恒的基本原理。`;
                        }
                        else if (msg.includes('雷诺数') || msg.includes('reynolds')) {
                            response = `🔢 雷诺数 (Reynolds Number)：

**公式**：Re = ρVL/μ

其中：
• ρ - 流体密度
• V - 特征速度
• L - 特征长度
• μ - 动力粘度

**物理意义**：表示惯性力与粘性力的比值

**判断标准**（圆管流动）：
• Re < 2300：层流
• 2300 < Re < 4000：过渡流
• Re > 4000：湍流`;
                        }
                        else if (msg.includes('粘性') || msg.includes('viscosity')) {
                            response = `🌊 流体粘性：

**定义**：流体抵抗剪切变形的性质

**牛顿内摩擦定律**：τ = μ(du/dy)

**分类**：
• **牛顿流体**：剪应力与剪切率成正比（水、空气）
• **非牛顿流体**：不成正比（血液、聚合物）

**温度影响**：
• 液体：温度↑ → 粘度↓
• 气体：温度↑ → 粘度↑`;
                        }
                        else if (msg.includes('连续性') || msg.includes('continuity')) {
                            response = `⚖️ 连续性方程：

**微分形式**：∂ρ/∂t + ∇·(ρV) = 0

**积分形式**：ρ₁A₁V₁ = ρ₂A₂V₂（不可压缩流体）

**物理意义**：质量守恒定律在流体力学中的体现

**适用条件**：
• 定常流动
• 连续介质假设
• 无质量源汇`;
                        }
                        else if (msg.includes('压强') || msg.includes('pressure')) {
                            response = `📏 流体压强：

**静力学基本方程**：p = p₀ + ρgh

**压强分类**：
• **绝对压强**：以真空为基准
• **表压强**：以大气压为基准
• **负压（真空度）**：低于大气压的压强

**关系式**：绝对压强 = 表压强 + 大气压强

**帕斯卡定律**：静止流体中任意一点的压强在各个方向上都相等`;
                        }
                        else if (msg.includes('流线') || msg.includes('streamline')) {
                            response = `📈 流线与流动描述：

**流线**：某一瞬时流场中处处与速度矢量相切的曲线

**迹线**：流体质点的运动轨迹

**区别**：
• 流线：瞬时概念
• 迹线：历史轨迹
• 定常流动中两者重合

**流线性质**：
• 不能相交（除奇点外）
• 切向即为该点速度方向
• 形状随时间变化（非定常流动）`;
                        }
                        else if (msg.includes('边界层') || msg.includes('boundary layer')) {
                            response = `🌊 边界层理论：

**定义**：紧贴固体壁面的薄层，粘性效应显著

**边界层厚度**：速度达到外流速度99%处到壁面的距离

**特点**：
• 速度梯度很大
• 粘性应力不可忽略
• 厚度沿流向增长

**分类**：
• **层流边界层**：有序流动
• **湍流边界层**：混合强烈

**工程意义**：阻力计算、传热传质分析的基础`;
                        }
                        else if (msg.includes('阿基米德') || msg.includes('archimedes')) {
                            response = `⚖️ 阿基米德原理：

**表述**：浸入流体中的物体受到的浮力等于被物体排开的流体重量

**公式**：F浮 = ρ流体 × V排开 × g

**应用**：
• 浮体稳定性分析
• 比重计设计
• 潜水器浮力控制
• 液体密度测量

**浮沉条件**：
• ρ物 < ρ流：漂浮
• ρ物 = ρ流：悬浮
• ρ物 > ρ流：下沉`;
                        }
                        else if (msg.includes('学习建议') || msg.includes('如何学')) {
                            response = `📚 流体力学学习建议：

**基础阶段**：
1. 掌握基本概念（压强、密度、粘性等）
2. 理解三大守恒定律（质量、动量、能量）
3. 熟练静力学计算

**进阶阶段**：
1. 深入理解伯努利方程及其应用
2. 掌握管流和边界层理论
3. 学习量纲分析方法

**实践建议**：
• 多做练习题，特别是易错题
• 结合工程实例理解概念
• 重视物理过程分析
• 建立错题本，定期复习`;
                        }
                        else if (msg.includes('推荐') || msg.includes('题目')) {
                            response = `🎯 学习资源推荐：

**练习模块**：
• 流体静力学专题 - 适合初学者
• 流体动力学专题 - 理解核心方程
• 粘性流动专题 - 掌握雷诺数概念
• 易错题集 - 避免常见错误

**学习路径**：
1. 先从基础概念开始
2. 逐步学习各专题模块
3. 大量练习易错题
4. 最后进行考试模拟

需要我为您推荐具体的练习题目吗？`;
                        }
                        else if (msg.includes('你好') || msg.includes('hello')) {
                            response = `👋 您好！我是流体力学AI学习助手！

我可以帮助您：
• 解答流体力学概念问题
• 提供学习建议和方法
• 推荐适合的练习题目
• 解释物理现象和工程应用

请随时向我提问，比如：
"什么是伯努利方程？"
"雷诺数有什么意义？"
"如何学好流体力学？"`;
                        }
                        else if (msg.includes('谢谢') || msg.includes('thank')) {
                            response = `😊 不用客气！学习流体力学是一个渐进的过程，遇到问题随时问我！

记住要：
• 理论联系实际
• 多做练习巩固
• 错题及时总结
• 保持学习热情

祝您学习进步！🎓`;
                        }
                        else {
                            // 通用回复
                            response = `🤔 我理解您的问题。关于"${message}"，让我为您提供一些相关信息：

这个问题可能涉及到流体力学的多个方面。建议您：

1. **明确问题背景** - 是理论概念还是实际应用？
2. **参考相关资料** - 查看对应的专题学习模块
3. **做针对性练习** - 通过题目加深理解

您可以问我更具体的问题，比如：
• "伯努利方程的应用条件是什么？"
• "如何计算雷诺数？"
• "流线和迹线有什么区别？"

我会为您提供详细的解答！`;
                        }
                        
                        this.isTyping = false;
                        this.addMessage('ai', response);
                        this.scrollToBottom();
                        
                        // 保存对话记录
                        this.saveMessages();
                    }, 1000 + Math.random() * 1000); // 1-2秒的随机延迟，模拟真实AI响应
                },
                
                askSuggestion(question) {
                    this.inputMessage = question;
                    this.sendMessage();
                },
                
                scrollToBottom() {
                    this.$nextTick(() => {
                        const messagesContainer = this.$refs.chatMessages;
                        if (messagesContainer) {
                            messagesContainer.scrollTop = messagesContainer.scrollHeight;
                        }
                    });
                },
                
                loadMessages() {
                    const saved = this.loadFromStorage('aiMessages', []);
                    this.messages = saved;
                }
            },
            
            mounted() {
                console.log('🤖 AI学习助手模块启动！');
                this.setLoading(true);
                
                setTimeout(() => {
                    this.setLoading(false);
                    this.loadMessages();
                    
                    // 如果没有历史消息，显示欢迎信息
                    if (this.messages.length === 0) {
                        this.addMessage('ai', `👋 欢迎使用流体力学AI学习助手！

我是您的专属学习伙伴，可以帮助您：

🎯 **概念解答** - 解释流体力学基本概念和原理
📊 **公式推导** - 详解重要方程的来源和应用
🔧 **实际应用** - 介绍工程实践中的流体力学
📚 **学习指导** - 提供个性化的学习建议和方法
🎲 **题目推荐** - 根据您的需求推荐练习内容

请选择下方的建议问题，或直接输入您想了解的内容！

💡 **提示**：您可以问我任何关于流体力学的问题，我会尽力为您提供详细准确的解答。`);
                    }
                    
                    this.showNotification('AI助手已就绪，开始学习吧！', 'success');
                    this.scrollToBottom();
                }, 800);
            }
        }).mount('#aiApp');
    </script>
</body>
</html> 