<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🤖 AI学习助手 - 流体力学学习平台</title>
    
    <!-- 外部依赖 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- 共享组件库 -->
    <script src="../js/shared-components.js"></script>
    
    <style>
        body {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            margin: 0;
            font-family: 'SF Pro Display', sans-serif;
            color: white;
        }

        .ai-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .chat-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            color: #333;
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 20px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 15px;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            margin-left: auto;
        }

        .message.ai {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
        }

        .message-header {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .message-content {
            line-height: 1.6;
        }

        .chat-input {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .input-field {
            flex: 1;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }

        .suggestions-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            color: #333;
        }

        .suggestion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .suggestion-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-card:hover {
            border-color: #667eea;
            background: #e3f2fd;
            transform: translateY(-3px);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 15px;
            max-width: 120px;
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="aiApp">
        <!-- 海洋背景 -->
        <ocean-background></ocean-background>

        <!-- 通知组件 -->
        <notification-component :notification="notification" @close="notification = ''"></notification-component>

        <!-- 加载动画 -->
        <loading-spinner :show="loading" text="AI助手启动中..."></loading-spinner>

        <div class="ai-container" v-if="!loading">
            <!-- 页面头部 -->
            <header style="text-align: center; padding: 40px 0; margin-bottom: 30px;">
                <h1><i class="fas fa-robot"></i> AI学习助手</h1>
                <p>智能问答系统，个性化学习建议和知识点解析</p>
            </header>

            <!-- 聊天面板 -->
            <div class="chat-panel">
                <div class="chat-header">
                    <h2><i class="fas fa-comments"></i> 智能对话</h2>
                    <p>向AI助手提问流体力学相关问题，获得专业解答</p>
                </div>

                <div class="chat-messages" ref="chatMessages">
                    <div v-for="message in messages" :key="message.id" class="message" :class="message.type">
                        <div class="message-header">
                            <i :class="message.type === 'user' ? 'fas fa-user' : 'fas fa-robot'"></i>
                            {{ message.type === 'user' ? '您' : 'AI助手' }}
                            <span style="font-size: 0.8em; opacity: 0.7;">{{ message.time }}</span>
                        </div>
                        <div class="message-content" v-html="message.content"></div>
                    </div>

                    <!-- 打字指示器 -->
                    <div v-if="isTyping" class="typing-indicator">
                        <i class="fas fa-robot"></i>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>

                <div class="chat-input">
                    <input 
                        v-model="inputMessage" 
                        @keyup.enter="sendMessage"
                        class="input-field" 
                        placeholder="请输入您的问题..."
                        :disabled="isTyping"
                    >
                    <button @click="sendMessage" class="send-btn" :disabled="isTyping">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <!-- 建议问题 -->
            <div class="suggestions-panel">
                <h3><i class="fas fa-lightbulb"></i> 推荐问题</h3>
                <p>点击下方问题快速开始对话</p>
                
                <div class="suggestion-grid">
                    <div 
                        v-for="suggestion in suggestions" 
                        :key="suggestion.id"
                        class="suggestion-card"
                        @click="askSuggestion(suggestion.question)"
                    >
                        <div style="font-weight: bold; margin-bottom: 10px;">
                            <i :class="suggestion.icon"></i> {{ suggestion.title }}
                        </div>
                        <div style="color: #666; font-size: 0.9em;">
                            {{ suggestion.question }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            mixins: [SharedMixin],
            components: {
                'ocean-background': OceanBackground,
                'notification-component': NotificationComponent,
                'loading-spinner': LoadingSpinner
            },
            data() {
                return {
                    messages: [],
                    inputMessage: '',
                    isTyping: false,
                    suggestions: [
                        {
                            id: 1,
                            title: '基础概念',
                            question: '什么是流体？流体的基本特征有哪些？',
                            icon: 'fas fa-book'
                        },
                        {
                            id: 2,
                            title: '压强计算',
                            question: '如何计算流体静压强？有哪些应用实例？',
                            icon: 'fas fa-calculator'
                        },
                        {
                            id: 3,
                            title: '伯努利方程',
                            question: '伯努利方程的物理意义是什么？如何应用？',
                            icon: 'fas fa-formula'
                        },
                        {
                            id: 4,
                            title: '雷诺数',
                            question: '雷诺数的作用是什么？如何判断流动状态？',
                            icon: 'fas fa-chart-line'
                        },
                        {
                            id: 5,
                            title: '学习建议',
                            question: '我是流体力学初学者，应该如何系统学习？',
                            icon: 'fas fa-graduation-cap'
                        },
                        {
                            id: 6,
                            title: '解题技巧',
                            question: '流体力学计算题有什么解题技巧？',
                            icon: 'fas fa-puzzle-piece'
                        }
                    ]
                }
            },
            methods: {
                sendMessage() {
                    if (!this.inputMessage.trim() || this.isTyping) return;
                    
                    // 添加用户消息
                    this.addMessage('user', this.inputMessage);
                    const userQuestion = this.inputMessage;
                    this.inputMessage = '';
                    
                    // 模拟AI思考
                    this.isTyping = true;
                    
                    setTimeout(() => {
                        const response = this.generateAIResponse(userQuestion);
                        this.addMessage('ai', response);
                        this.isTyping = false;
                        this.scrollToBottom();
                    }, 2000);
                },
                
                addMessage(type, content) {
                    const message = {
                        id: Date.now(),
                        type: type,
                        content: content,
                        time: new Date().toLocaleTimeString()
                    };
                    this.messages.push(message);
                    this.saveToStorage('aiMessages', this.messages);
                    this.scrollToBottom();
                },
                
                generateAIResponse(question) {
                    const responses = {
                        '流体': `
                            <strong>流体的定义和特征：</strong><br><br>
                            🌊 <strong>流体定义：</strong>流体是指液体和气体的总称，具有在切应力作用下连续变形的特性。<br><br>
                            📋 <strong>基本特征：</strong><br>
                            • <strong>连续性：</strong>流体在宏观上是连续介质<br>
                            • <strong>流动性：</strong>在任何微小切应力作用下都会发生连续变形<br>
                            • <strong>易变形性：</strong>形状易变，体积相对稳定（液体）或易变（气体）<br><br>
                            💡 <strong>学习建议：</strong>理解流体的连续性假设是学习流体力学的基础！
                        `,
                        '压强': `
                            <strong>流体静压强计算：</strong><br><br>
                            📐 <strong>基本公式：</strong>p = p₀ + ρgh<br>
                            • p₀ - 液面压强<br>
                            • ρ - 流体密度<br>
                            • g - 重力加速度<br>
                            • h - 深度<br><br>
                            🏗️ <strong>工程应用：</strong><br>
                            • 水坝设计中的水压力计算<br>
                            • 潜水器的耐压设计<br>
                            • 液压系统的压力传递<br><br>
                            ⚠️ <strong>注意事项：</strong>适用于静止或匀速运动的流体
                        `,
                        '伯努利': `
                            <strong>伯努利方程详解：</strong><br><br>
                            🧮 <strong>方程形式：</strong><br>
                            p₁ + ½ρv₁² + ρgh₁ = p₂ + ½ρv₂² + ρgh₂<br><br>
                            💭 <strong>物理意义：</strong><br>
                            • <strong>压强能：</strong>p - 单位体积流体的压强能<br>
                            • <strong>动能：</strong>½ρv² - 单位体积流体的动能<br>
                            • <strong>势能：</strong>ρgh - 单位体积流体的重力势能<br><br>
                            🔧 <strong>应用条件：</strong><br>
                            • 理想流体（无粘性）<br>
                            • 定常流动<br>
                            • 沿流线应用
                        `,
                        '雷诺数': `
                            <strong>雷诺数的重要性：</strong><br><br>
                            📊 <strong>定义：</strong>Re = ρVL/μ<br>
                            • ρ - 流体密度<br>
                            • V - 特征速度<br>
                            • L - 特征长度<br>
                            • μ - 动力粘度<br><br>
                            🌊 <strong>判断标准：</strong><br>
                            • <strong>圆管流动：</strong><br>
                            &nbsp;&nbsp;Re < 2300 → 层流<br>
                            &nbsp;&nbsp;Re > 4000 → 湍流<br>
                            &nbsp;&nbsp;2300 < Re < 4000 → 过渡流<br><br>
                            💡 <strong>物理意义：</strong>表示惯性力与粘性力的比值
                        `,
                        '学习': `
                            <strong>流体力学学习路径建议：</strong><br><br>
                            📚 <strong>第一阶段 - 基础概念：</strong><br>
                            • 流体的基本性质<br>
                            • 流体静力学原理<br>
                            • 压强分布规律<br><br>
                            🌊 <strong>第二阶段 - 运动分析：</strong><br>
                            • 流体运动学<br>
                            • 连续性方程<br>
                            • 伯努利方程<br><br>
                            🔬 <strong>第三阶段 - 深入理论：</strong><br>
                            • 粘性流动<br>
                            • 雷诺数和流态<br>
                            • 工程应用<br><br>
                            💪 <strong>学习建议：</strong>理论结合实践，多做习题！
                        `,
                        '技巧': `
                            <strong>流体力学解题技巧：</strong><br><br>
                            🎯 <strong>解题步骤：</strong><br>
                            1. <strong>审题分析：</strong>明确已知条件和求解目标<br>
                            2. <strong>选择原理：</strong>判断适用的基本方程<br>
                            3. <strong>建立方程：</strong>根据原理列出方程<br>
                            4. <strong>求解计算：</strong>代入数值求解<br>
                            5. <strong>检验结果：</strong>检查结果的合理性<br><br>
                            💡 <strong>常用技巧：</strong><br>
                            • 画出流动示意图<br>
                            • 选择合适的控制体<br>
                            • 注意单位换算<br>
                            • 检查量纲一致性<br><br>
                            ⚡ <strong>提升方法：</strong>多练习典型例题，总结解题规律
                        `
                    };
                    
                    // 根据关键词匹配响应
                    for (const keyword in responses) {
                        if (question.includes(keyword)) {
                            return responses[keyword];
                        }
                    }
                    
                    // 默认响应
                    return `
                        <strong>感谢您的提问！</strong><br><br>
                        我是您的流体力学AI学习助手。虽然我正在学习更多知识来回答您的具体问题，但我可以为您提供以下帮助：<br><br>
                        📚 <strong>基础概念解释</strong><br>
                        🧮 <strong>公式推导和应用</strong><br>
                        💡 <strong>解题思路指导</strong><br>
                        📖 <strong>学习方法建议</strong><br><br>
                        请尝试点击下方的推荐问题，或者问一些更具体的流体力学问题，我会尽力为您详细解答！
                    `;
                },
                
                askSuggestion(question) {
                    this.inputMessage = question;
                    this.sendMessage();
                },
                
                scrollToBottom() {
                    this.$nextTick(() => {
                        const messagesContainer = this.$refs.chatMessages;
                        if (messagesContainer) {
                            messagesContainer.scrollTop = messagesContainer.scrollHeight;
                        }
                    });
                },
                
                loadMessages() {
                    const saved = this.loadFromStorage('aiMessages', []);
                    this.messages = saved;
                }
            },
            
            mounted() {
                console.log('🤖 AI学习助手启动！');
                this.setLoading(true);
                
                setTimeout(() => {
                    this.loadMessages();
                    this.setLoading(false);
                    this.showNotification('AI助手已就绪，可以开始提问！', 'success');
                    
                    // 如果没有历史消息，显示欢迎消息
                    if (this.messages.length === 0) {
                        this.addMessage('ai', `
                            👋 <strong>欢迎使用AI学习助手！</strong><br><br>
                            我是您的流体力学专属AI导师，可以帮助您：<br>
                            • 解答流体力学概念问题<br>
                            • 提供解题思路和技巧<br>
                            • 推荐个性化学习路径<br>
                            • 分析知识点的关联性<br><br>
                            请随时向我提问，或点击下方的推荐问题开始对话！🚀
                        `);
                    }
                }, 1500);
            }
        }).mount('#aiApp');
    </script>
</body>
</html> 