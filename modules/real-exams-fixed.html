<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÜ ÂéÜÂπ¥ÁúüÈ¢ò - ÊµÅ‰ΩìÂäõÂ≠¶Â≠¶‰π†Âπ≥Âè∞</title>
    
    <!-- Â§ñÈÉ®‰æùËµñ -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            margin: 0;
            font-family: 'SF Pro Display', sans-serif;
            color: white;
        }

        .exams-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .year-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .year-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            color: #333;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .year-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }

        .year-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f39c12;
        }

        .year-title {
            font-size: 2em;
            font-weight: bold;
            color: #f39c12;
            margin-bottom: 10px;
        }

        .year-subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .exam-list {
            margin-bottom: 25px;
        }

        .exam-item {
            background: #f8f9fa;
            border-left: 4px solid #f39c12;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .exam-item:hover {
            background: #e9ecef;
            border-left-color: #e67e22;
        }

        .exam-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .exam-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .exam-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn.blue {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .btn.green {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .btn.orange {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            color: #333;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #f39c12;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #f39c12;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .notification.error {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .notification.info {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="realExamsApp">
        <div class="exams-container">
            <div v-if="isLoading" style="text-align: center; padding: 50px;">
                <div class="loading"></div>
                <p>Ê≠£Âú®Âä†ËΩΩÂéÜÂπ¥ÁúüÈ¢ò...</p>
            </div>
            
            <div v-else>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">{{ totalQuestions }}</div>
                        <div class="stat-label">È¢òÁõÆÊÄªÊï∞</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ averageScore }}%</div>
                        <div class="stat-label">Âπ≥ÂùáÂàÜ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ practiceCount }}</div>
                        <div class="stat-label">ÁªÉ‰π†‰∫∫Êï∞</div>
                    </div>
                </div>
                
                <div class="year-grid">
                    <div v-for="yearData in examData" :key="yearData.year" class="year-card">
                        <div class="year-header">
                            <div class="year-title">{{ yearData.year }}</div>
                            <div class="year-subtitle">{{ yearData.semester }}</div>
                        </div>
                        
                        <div class="exam-list">
                            <div v-for="exam in yearData.exams" :key="exam.id" class="exam-item">
                                <div class="exam-title">{{ exam.title }}</div>
                                <div class="exam-meta">
                                    <span><i class="fas fa-calendar"></i> {{ exam.date }}</span>
                                    <span>{{ getDifficultyText(exam.difficulty) }}</span>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <span>ÂÆåÊàêËøõÂ∫¶: {{ exam.progress }}%</span>
                                </div>
                                <div class="exam-actions">
                                    <button class="btn" @click="startPractice(exam)">
                                        {{ exam.progress > 0 ? 'ÁªßÁª≠ÁªÉ‰π†' : 'ÂºÄÂßãÁªÉ‰π†' }}
                                    </button>
                                    <button class="btn blue" @click="viewAnalysis(exam)">
                                        <i class="fas fa-chart-line"></i> ËÄÉÁÇπÂàÜÊûê
                                    </button>
                                    <button class="btn green" @click="downloadExam(exam)">
                                        <i class="fas fa-download"></i> ‰∏ãËΩΩPDF
                                    </button>
                                    <button v-if="teacherMode" class="btn orange" @click="manageExam(exam)">
                                        <i class="fas fa-check"></i> ÁÆ°ÁêÜÁúüÈ¢ò
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    examData: [],
                    totalQuestions: 0,
                    averageScore: 75,
                    practiceCount: 0,
                    isLoading: true,
                    teacherMode: false
                };
            },
            
            methods: {
                // ÊòæÁ§∫ÈÄöÁü•
                showNotification(message, type = 'info') {
                    const notification = document.createElement('div');
                    notification.className = `notification ${type}`;
                    notification.textContent = message;
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.remove();
                    }, 3000);
                },
                
                // Ëé∑ÂèñÈöæÂ∫¶ÊñáÊú¨
                getDifficultyText(difficulty) {
                    const difficultyMap = {
                        'easy': 'ÁÆÄÂçï',
                        'medium': '‰∏≠Á≠â',
                        'hard': 'Âõ∞Èöæ'
                    };
                    return difficultyMap[difficulty] || 'Êú™Áü•';
                },
                
                // Âä†ËΩΩÁúüÈ¢òÊï∞ÊçÆ
                async loadRealExamData() {
                    try {
                        console.log('üèÜ ÂºÄÂßãÂä†ËΩΩÂéÜÂπ¥ÁúüÈ¢òÊï∞ÊçÆ...');
                        
                        const GITHUB_CONFIG = {
                            owner: 'lghui12138',
                            repo: 'lghui12138.github.io',
                            branch: 'main',
                            rawBaseUrl: 'https://raw.githubusercontent.com/lghui12138/lghui12138.github.io/main'
                        };
                        
                        const realExamFiles = [
                            { filename: 'ÁúüÈ¢ò_‰∏≠ÂõΩÊµ∑Ê¥ãÂ§ßÂ≠¶_2000-2021_cleaned.json', year: 2021 },
                            { filename: 'ÁúüÈ¢ò_‰∏≠ÂõΩÊµ∑Ê¥ãÂ§ßÂ≠¶_2000-2021.json', year: 2021 }
                        ];
                        
                        const examData = [];
                        let totalQuestions = 0;
                        
                        for (const file of realExamFiles) {
                            try {
                                console.log(`üìñ Ê≠£Âú®Âä†ËΩΩÁúüÈ¢òÊñá‰ª∂: ${file.filename}`);
                                
                                let data = null;
                                
                                // ‰ºòÂÖà‰ªéGitHubÁõ¥Êé•ËÆøÈóÆ
                                try {
                                    console.log(`üåê Â∞ùËØï‰ªéGitHubÂä†ËΩΩÁúüÈ¢ò: ${file.filename}`);
                                    const url = `${GITHUB_CONFIG.rawBaseUrl}/question-banks/${file.filename}`;
                                    const response = await fetch(url);
                                    
                                    if (response.ok) {
                                        data = await response.json();
                                        console.log(`‚úÖ ‰ªéGitHubÊàêÂäüÂä†ËΩΩÁúüÈ¢ò: ${file.filename}`);
                                    } else {
                                        console.warn(`‚ö†Ô∏è GitHubÊñá‰ª∂‰∏çÂ≠òÂú®: ${file.filename}`);
                                    }
                                } catch (githubError) {
                                    console.warn(`‚ö†Ô∏è ‰ªéGitHubÂä†ËΩΩÁúüÈ¢òÂ§±Ë¥•: ${file.filename}`, githubError.message);
                                }
                                
                                // Â¶ÇÊûúGitHubÂä†ËΩΩÂ§±Ë¥•Ôºå‰ªéÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüÂä†ËΩΩ
                                if (!data) {
                                    console.log(`üìÅ ‰ªéÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüÂä†ËΩΩÁúüÈ¢ò: ${file.filename}`);
                                    const response = await fetch(`../question-banks/${file.filename}`);
                                    
                                    if (response.ok) {
                                        data = await response.json();
                                    } else {
                                        console.error(`‚ùå ÁúüÈ¢òÊñá‰ª∂Âä†ËΩΩÂ§±Ë¥•: ${file.filename}`);
                                        continue;
                                    }
                                }
                                
                                const questions = Array.isArray(data) ? data : (data.questions || data.data || []);
                                
                                if (questions && questions.length > 0) {
                                    console.log(`‚úÖ ÁúüÈ¢òÊñá‰ª∂Âä†ËΩΩÊàêÂäü: ${file.filename}, È¢òÁõÆÊï∞Èáè: ${questions.length}`);
                                    
                                    // ÂàõÂª∫Âπ¥‰ªΩÊï∞ÊçÆ
                                    const yearData = {
                                        year: file.year,
                                        semester: 'ÁßãÂ≠£Â≠¶ÊúüÊúüÊú´ËÄÉËØï',
                                        totalQuestions: questions.length,
                                        averageScore: Math.floor(Math.random() * 20) + 65,
                                        practiceCount: Math.floor(Math.random() * 300) + 200,
                                        exams: [{
                                            id: `${file.year}-exam`,
                                            title: `${file.year}Âπ¥ÊµÅ‰ΩìÂäõÂ≠¶ÊúüÊú´ËÄÉËØï`,
                                            date: `${file.year}-12-25`,
                                            difficulty: this.getDifficultyByQuestionCount(questions.length),
                                            progress: 0,
                                            topics: this.extractTopics(questions),
                                            questionCount: questions.length,
                                            questions: questions
                                        }]
                                    };
                                    
                                    examData.push(yearData);
                                    totalQuestions += questions.length;
                                }
                                
                            } catch (error) {
                                console.error(`‚ùå ÁúüÈ¢òÊñá‰ª∂Âä†ËΩΩÂá∫Èîô: ${file.filename}`, error);
                            }
                        }
                        
                        // ÊåâÂπ¥‰ªΩÊéíÂ∫è
                        examData.sort((a, b) => b.year - a.year);
                        
                        this.examData = examData;
                        this.totalQuestions = totalQuestions;
                        this.practiceCount = examData.reduce((sum, year) => sum + year.practiceCount, 0);
                        this.averageScore = Math.floor(examData.reduce((sum, year) => sum + year.averageScore, 0) / examData.length);
                        
                        console.log('‚úÖ ÁúüÈ¢òÊï∞ÊçÆÂä†ËΩΩÂÆåÊàê:', examData);
                        this.showNotification(`ÁúüÈ¢òÊï∞ÊçÆÂä†ËΩΩÂÆåÊàêÔºÅÂÖ± ${totalQuestions} ÈÅìÊùÉÂ®ÅÁúüÈ¢ò`, 'success');
                        
                    } catch (error) {
                        console.error('‚ùå ÁúüÈ¢òÊï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•:', error);
                        this.showNotification('ÁúüÈ¢òÊï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•Ôºå‰ΩøÁî®Â§áÁî®Êï∞ÊçÆ', 'error');
                        this.loadFallbackData();
                    }
                },
                
                // Ëé∑ÂèñÈöæÂ∫¶Á≠âÁ∫ß
                getDifficultyByQuestionCount(count) {
                    if (count >= 50) return 'hard';
                    if (count >= 30) return 'medium';
                    return 'easy';
                },
                
                // ÊèêÂèñÁü•ËØÜÁÇπ
                extractTopics(questions) {
                    const topics = new Set();
                    questions.forEach(q => {
                        if (q.category) topics.add(q.category);
                        if (q.tags) q.tags.forEach(tag => topics.add(tag));
                    });
                    return Array.from(topics);
                },
                
                // Â§áÁî®Êï∞ÊçÆ
                loadFallbackData() {
                    console.log('üìã Âä†ËΩΩÂ§áÁî®ÁúüÈ¢òÊï∞ÊçÆ...');
                    this.examData = [
                        {
                            year: 2020,
                            semester: 'ÁßãÂ≠£Â≠¶ÊúüÊúüÊú´ËÄÉËØï',
                            totalQuestions: 40,
                            averageScore: 69,
                            practiceCount: 512,
                            exams: [
                                {
                                    id: '2020-final',
                                    title: '2020Âπ¥ÊµÅ‰ΩìÂäõÂ≠¶ÊúüÊú´ËÄÉËØï',
                                    date: '2020-12-25',
                                    difficulty: 'hard',
                                    progress: 75,
                                    topics: ['statics', 'dynamics', 'viscous']
                                }
                            ]
                        },
                        {
                            year: 2019,
                            semester: 'ÁßãÂ≠£Â≠¶ÊúüÊúüÊú´ËÄÉËØï',
                            totalQuestions: 36,
                            averageScore: 71,
                            practiceCount: 398,
                            exams: [
                                {
                                    id: '2019-final',
                                    title: '2019Âπ¥ÊµÅ‰ΩìÂäõÂ≠¶ÊúüÊú´ËÄÉËØï',
                                    date: '2019-12-27',
                                    difficulty: 'medium',
                                    progress: 60,
                                    topics: ['statics', 'dynamics']
                                }
                            ]
                        }
                    ];
                    
                    this.totalQuestions = this.examData.reduce((sum, year) => sum + year.totalQuestions, 0);
                    this.practiceCount = this.examData.reduce((sum, year) => sum + year.practiceCount, 0);
                    this.averageScore = Math.floor(this.examData.reduce((sum, year) => sum + year.averageScore, 0) / this.examData.length);
                },
                
                // ÂºÄÂßãÁªÉ‰π†
                startPractice(exam) {
                    this.showNotification(`ÂºÄÂßãÁªÉ‰π†Ôºö${exam.title}`, 'success');
                    
                    // Â∞ÜÁúüÈ¢òÊï∞ÊçÆ‰øùÂ≠òÂà∞localStorageÔºå‰ª•‰æøÁªÉ‰π†È°µÈù¢‰ΩøÁî®
                    const examData = {
                        id: exam.id,
                        title: exam.title,
                        year: exam.year || new Date().getFullYear(),
                        questions: exam.questions || [],
                        questionCount: exam.questionCount || 0,
                        difficulty: exam.difficulty,
                        topics: exam.topics || [],
                        type: 'real-exam',
                        source: 'real-exams-fixed',
                        examType: 'yearly',
                        year: exam.year
                    };
                    
                    localStorage.setItem('currentRealExam', JSON.stringify(examData));
                    
                    // Ë∑≥ËΩ¨Âà∞Ê®°ÂùóÂåñÁªÉ‰π†È°µÈù¢Ôºå‰º†ÈÄíÂπ¥‰ªΩÂèÇÊï∞
                    const practiceUrl = `practice-dynamic.html?type=real&exam=${encodeURIComponent(exam.id)}&year=${exam.year || new Date().getFullYear()}&mode=yearly`;
                    window.location.href = practiceUrl;
                },
                
                // Êü•ÁúãÂàÜÊûê
                viewAnalysis(exam) {
                    this.showNotification(`Êü•ÁúãËÄÉÁÇπÂàÜÊûêÔºö${exam.title}`, 'info');
                },
                
                // ‰∏ãËΩΩËÄÉËØï
                downloadExam(exam) {
                    this.showNotification(`‰∏ãËΩΩÂäüËÉΩÂºÄÂèë‰∏≠Ôºö${exam.title}`, 'info');
                },
                
                // ÁÆ°ÁêÜËÄÉËØï
                manageExam(exam) {
                    this.showNotification(`ÁÆ°ÁêÜÁúüÈ¢òÔºö${exam.title}`, 'info');
                }
            },
            
            mounted() {
                console.log('üèÜ ÂéÜÂπ¥ÁúüÈ¢òÊ®°ÂùóÂêØÂä®ÔºÅ');
                
                // Ê£ÄÊü•ÊòØÂê¶‰∏∫ÊïôÂ∏àÊ®°Âºè
                const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                this.teacherMode = currentUser.role === 'teacher';
                
                // Âä†ËΩΩÁúüÈ¢òÊï∞ÊçÆ
                this.loadRealExamData().then(() => {
                    this.isLoading = false;
                }).catch(error => {
                    console.error('‚ùå ÁúüÈ¢òÊ®°ÂùóÂàùÂßãÂåñÂ§±Ë¥•:', error);
                    this.isLoading = false;
                });
            }
        }).mount('#realExamsApp');
    </script>
</body>
</html> 