<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https:; frame-ancestors 'none'; base-uri 'self';">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, notranslate">
    <title>流体力学学习平台 - 中国海洋大学</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#1e6fa8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="流体力学">
    
    <!-- External Resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous" defer></script>
    <script src="https://vjs.zencdn.net/8.7.0/video.min.js" crossorigin="anonymous" defer></script>
    <link href="https://vjs.zencdn.net/8.7.0/video-js.css" rel="stylesheet">

    <style>
        :root {
            --primary: #1e6fa8;
            --secondary: #2c9ab7;
            --accent: #4db8d6;
            --success: #27ae60;
            --warning: #f39c12;
            --error: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --border: #bdc3c7;
            --ocean-blue: #1e6fa8;
            --wave-color: #2c9ab7;
            --deep-blue: #0d4f73;
            --light-blue: #87ceeb;
            --gradient-ocean: linear-gradient(135deg, #1e6fa8, #4db8d6, #87ceeb);
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --radius-sm: 0.25rem;
            --radius-md: 0.375rem;
            --radius-lg: 0.5rem;
            --radius-xl: 0.75rem;
            --radius-2xl: 1rem;
            --radius-full: 9999px;
            --space-1: 0.25rem;
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-6: 1.5rem;
            --space-8: 2rem;
            --space-12: 3rem;
            --space-16: 4rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', 'Arial', sans-serif;
        }

        html {
            scroll-behavior: smooth;
            line-height: 1.6;
        }

        body {
            background: var(--gradient-ocean);
            color: var(--dark);
            overflow-x: hidden;
            min-height: 100vh;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        .visually-hidden {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }

        *:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary);
            color: white;
            padding: 8px;
            z-index: 10000;
            text-decoration: none;
            border-radius: var(--radius-md);
        }

        .skip-link:focus {
            top: 6px;
        }

        /* 登录系统样式 */
        .login-system {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-ocean);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.5s ease;
        }

        .login-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: var(--radius-2xl);
            padding: var(--space-12);
            width: 90%;
            max-width: 400px;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .login-header {
            text-align: center;
            margin-bottom: var(--space-8);
        }

        .login-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--space-2);
        }

        .login-subtitle {
            font-size: 1.125rem;
            color: var(--secondary);
            margin-bottom: var(--space-6);
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .form-input {
            width: 100%;
            padding: var(--space-4);
            border: 2px solid rgba(30, 111, 168, 0.2);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.8);
            transition: all var(--transition-normal);
        }

        .form-input:focus {
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 3px rgba(77, 184, 214, 0.1);
            transform: translateY(-1px);
        }

        .login-button {
            width: 100%;
            padding: var(--space-4);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .login-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 500;
            text-align: center;
            margin-bottom: var(--space-4);
            display: none;
        }

        .message.show {
            display: block;
        }

        .message.error {
            background: rgba(231, 76, 60, 0.1);
            color: var(--error);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .message.success {
            background: rgba(39, 174, 96, 0.1);
            color: var(--success);
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .forgot-password {
            text-align: center;
            margin-top: var(--space-6);
        }

        .forgot-password a {
            color: var(--accent);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color var(--transition-normal);
        }

        .forgot-password a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* 主平台样式 */
        .platform {
            display: none;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f9ff 0%, #e6f0ff 100%);
        }

        .platform.active {
            display: block;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .featured-banner {
            background: var(--deep-blue);
            color: white;
            text-align: center;
            padding: var(--space-2);
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-6);
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 70px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            cursor: pointer;
            transition: transform var(--transition-normal);
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo-icon {
            font-size: 2rem;
            color: var(--light-blue);
            background: rgba(255, 255, 255, 0.15);
            width: 50px;
            height: 50px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: var(--space-2);
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-full);
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            transform: translateY(-2px);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            background: rgba(255, 255, 255, 0.15);
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .user-info:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }

        .logout-button {
            background: transparent;
            border: none;
            color: white;
            font-size: 1.125rem;
            cursor: pointer;
            padding: var(--space-2);
            border-radius: var(--radius-md);
            transition: all var(--transition-normal);
        }

        .logout-button:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-8) var(--space-6);
            min-height: calc(100vh - 200px);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-title {
            font-size: 2.25rem;
            color: var(--primary);
            margin-bottom: var(--space-8);
            position: relative;
            padding-bottom: var(--space-4);
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 4px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: var(--radius-sm);
        }

        .section-icon {
            background: rgba(30, 111, 168, 0.15);
            width: 50px;
            height: 50px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary);
            font-size: 1.5rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-xl);
            padding: var(--space-8);
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all var(--transition-normal);
            margin-bottom: var(--space-6);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        .footer {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: var(--space-8) 0;
            text-align: center;
            margin-top: var(--space-16);
        }

        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: var(--space-2);
        }

        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--primary);
                flex-direction: column;
                padding: var(--space-4);
                box-shadow: var(--shadow-lg);
            }
            
            .nav-menu.active {
                display: flex;
            }
            
            .login-container {
                margin: var(--space-4);
                padding: var(--space-8);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @media print {
            * {
                display: none !important;
            }
            
            body::before {
                content: "此内容受版权保护，禁止打印";
                display: block !important;
                text-align: center;
                font-size: 24px;
                color: red;
                margin: 50px;
            }
        }

        /* 复习规划样式 */
        .review-planner {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-8);
            box-shadow: var(--shadow-md);
            margin-bottom: var(--space-6);
        }

        .timeline-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: var(--space-6);
            margin-top: var(--space-6);
        }

        .timeline-month {
            margin-bottom: var(--space-8);
        }

        .month-title {
            font-size: 1.25rem;
            color: var(--secondary);
            margin-bottom: var(--space-4);
            padding-left: var(--space-3);
            border-left: 3px solid var(--accent);
        }

        .plan-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: var(--space-4);
            padding: var(--space-3);
            background: rgba(236, 240, 241, 0.5);
            border-radius: var(--radius-lg);
            transition: all var(--transition-normal);
        }

        .plan-item:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateX(5px);
        }

        .week-label {
            background: var(--accent);
            color: white;
            font-weight: 600;
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-md);
            min-width: 80px;
            text-align: center;
            margin-right: var(--space-4);
        }

        .plan-content {
            flex: 1;
        }

        .plan-content h4 {
            margin-bottom: var(--space-2);
            color: var(--dark);
        }

        .plan-content p {
            font-size: 0.875rem;
            color: #5e7c9c;
        }

        .status-check {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all var(--transition-normal);
            margin-left: var(--space-3);
        }

        .status-check.completed {
            background: var(--success);
            border-color: var(--success);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .status-check.completed::before {
            content: "✓";
            color: white;
            font-size: 0.875rem;
        }

        /* 视频课程样式 */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-6);
            margin-top: var(--space-6);
        }

        .video-card {
            background: white;
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .video-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }
        
        .video-card.featured {
            border: 2px solid var(--accent);
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            position: relative;
        }
        
        .video-card.featured::before {
            content: '推荐';
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--accent);
            color: white;
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 1;
        }

        .video-preview {
            height: 160px;
            background: linear-gradient(45deg, var(--primary), #316399);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-preview i {
            font-size: 3.75rem;
            color: rgba(255, 255, 255, 0.15);
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.375rem;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .play-button:hover {
            transform: translate(-50%, -50%) scale(1.1);
            background: white;
        }

        .video-info {
            padding: var(--space-6);
        }

        .video-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: var(--space-3);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-description {
            color: #5e7c9c;
            font-size: 0.875rem;
            margin-bottom: var(--space-4);
            line-height: 1.5;
        }

        .video-duration {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: #6d8db0;
            font-size: 0.875rem;
        }

        /* 题库练习样式 */
        .exercise-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-6);
            margin-top: var(--space-6);
        }

        .exercise-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            border-left: 4px solid var(--accent);
            transition: all var(--transition-normal);
        }

        .exercise-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .exercise-title {
            font-weight: 700;
            font-size: 1.0625rem;
            margin-bottom: var(--space-4);
            color: var(--primary);
        }

        .exercise-meta {
            display: flex;
            justify-content: space-between;
            color: var(--secondary);
            font-size: 0.875rem;
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 1px solid #e3edfa;
        }

        .start-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-lg);
            cursor: pointer;
            font-size: 0.875rem;
            width: 100%;
            text-align: center;
            transition: all var(--transition-normal);
            font-weight: 500;
        }

        .start-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        /* 分数线样式 */
        .score-chart-container {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-8);
            margin-top: var(--space-6);
            box-shadow: var(--shadow-md);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
        }

        .chart-box {
            height: 400px;
            position: relative;
        }

        .score-filters {
            display: flex;
            gap: var(--space-4);
            margin-bottom: var(--space-6);
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: var(--space-2) var(--space-4);
            border: 1px solid #e3edfa;
            border-radius: var(--radius-full);
            background: white;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .filter-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* 成绩管理样式 */
        .grade-container {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-8);
            margin-top: var(--space-6);
            box-shadow: var(--shadow-md);
        }

        .grade-form {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: var(--space-4);
            margin-bottom: var(--space-8);
        }

        .grade-form input {
            padding: var(--space-3) var(--space-4);
            border: 1px solid #ddd;
            border-radius: var(--radius-lg);
            font-size: 1rem;
        }

        .add-grade-btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-normal);
            padding: 0 var(--space-6);
        }

        .add-grade-btn:hover {
            background: var(--secondary);
        }

        /* 响应式设计增强 */
        @media (max-width: 992px) {
            .timeline-container {
                grid-template-columns: 1fr;
            }
            
            .grade-form {
                grid-template-columns: 1fr;
            }
            
            .score-filters {
                flex-wrap: wrap;
                gap: var(--space-2);
            }
        }

        @media (max-width: 480px) {
            .login-title {
                font-size: 1.5rem;
            }
            
            .login-container {
                padding: var(--space-6);
            }
            
            .header-content {
                padding: var(--space-3);
            }
            
            .logo-text {
                font-size: 1.125rem;
            }
            
            .main-content {
                padding: var(--space-6) var(--space-4);
            }
        }
        
        /* 视频模态框样式 */
        .video-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .video-modal.active {
            opacity: 1;
        }
        
        .video-modal-content {
            background: white;
            border-radius: var(--radius-xl);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        
        .video-modal.active .video-modal-content {
            transform: scale(1);
        }
        
        .video-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-6);
            border-bottom: 1px solid var(--border);
        }
        
        .video-modal-header h3 {
            margin: 0;
            color: var(--primary);
            font-size: 1.25rem;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--secondary);
            cursor: pointer;
            padding: var(--space-2);
            border-radius: var(--radius-md);
            transition: all var(--transition-normal);
        }
        
        .close-btn:hover {
            background: rgba(44, 154, 183, 0.1);
            color: var(--primary);
        }
        
        .video-container {
            position: relative;
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .video-placeholder {
            text-align: center;
            color: white;
        }
        
        .video-placeholder i {
            font-size: 4rem;
            margin-bottom: var(--space-4);
            opacity: 0.8;
        }
        
        .video-placeholder p {
            font-size: 1.25rem;
            margin-bottom: var(--space-2);
        }
        
        .video-placeholder small {
            opacity: 0.8;
            font-size: 0.875rem;
        }
        
        .video-info {
            padding: var(--space-6);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-4);
        }
        
        .video-info p {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            color: var(--secondary);
            font-size: 0.875rem;
        }
        
        .video-info i {
            color: var(--accent);
        }
        
        /* 成绩列表样式 */
        .grade-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-4);
            background: rgba(255, 255, 255, 0.8);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-3);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all var(--transition-normal);
        }
        
        .grade-item:hover {
            background: rgba(255, 255, 255, 1);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .grade-info {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }
        
        .grade-name {
            font-weight: 600;
            color: var(--primary);
            font-size: 1rem;
        }
        
        .grade-score {
            color: var(--secondary);
            font-size: 0.875rem;
        }
        
        .grade-actions {
            display: flex;
            gap: var(--space-2);
        }
        
        .edit-btn, .delete-btn {
            background: none;
            border: none;
            padding: var(--space-2);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            font-size: 0.875rem;
        }
        
        .edit-btn {
            color: var(--accent);
        }
        
        .edit-btn:hover {
            background: rgba(77, 184, 214, 0.1);
        }
        
        .delete-btn {
            color: var(--error);
        }
        
        .delete-btn:hover {
            background: rgba(231, 76, 60, 0.1);
        }
    </style>
</head>
<body>
    <!-- 跳过链接，提高可访问性 -->
    <a href="#main-content" class="skip-link">跳转到主要内容</a>
    
    <!-- 登录系统 -->
    <div id="loginSystem" class="login-system">
        <div class="login-container">
            <div class="login-header">
                <h1 class="login-title">流体力学学习平台</h1>
                <p class="login-subtitle">中国海洋大学 | 803流体力学</p>
                <div style="text-align: center;">
                    <small style="color: var(--secondary); font-style: italic;">
                        探索流体世界的奥秘 · 理解自然规律的艺术
                    </small>
                </div>
            </div>
            
            <div id="loginMessage" class="message" role="alert" aria-live="polite"></div>
            
            <form id="loginForm" class="login-form" novalidate>
                <div class="form-group">
                    <label for="username" class="form-label">
                        <i class="fas fa-user" aria-hidden="true"></i>
                        用户名
                    </label>
                    <input 
                        type="text" 
                        id="username" 
                        name="username"
                        class="form-input" 
                        placeholder="请输入用户名"
                        autocomplete="username"
                        required
                        maxlength="50">
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">
                        <i class="fas fa-lock" aria-hidden="true"></i>
                        密码
                    </label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password"
                        class="form-input" 
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        required
                        minlength="6"
                        maxlength="100">
                </div>
                
                <button type="submit" id="loginButton" class="login-button">
                    <span id="loginButtonText">登录</span>
                    <div id="loginButtonSpinner" class="loading" style="display: none;"></div>
                </button>
            </form>
            
            <div class="forgot-password">
                <a href="#" onclick="showPasswordResetModal()" aria-label="找回密码">
                    忘记密码？
                </a>
            </div>
        </div>
    </div>
    
    <!-- 主平台界面 -->
    <div id="platform" class="platform">
        <header class="header">
            <div class="featured-banner">
                今日推荐：流体力学之美 - 探索流动世界的奥秘
            </div>
            
            <div class="header-content">
                <div class="logo" onclick="showSection('home')" role="button" tabindex="0" aria-label="返回首页">
                    <div class="logo-icon">
                        <i class="fas fa-water" aria-hidden="true"></i>
                    </div>
                    <h1 class="logo-text">流体力学学习平台</h1>
                </div>
                
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="切换移动端菜单">
                    <i class="fas fa-bars" aria-hidden="true"></i>
                </button>
                
                <nav id="mainNav" role="navigation" aria-label="主导航">
                    <ul class="nav-menu">
                        <li><a href="#" class="nav-link active" onclick="showSection('home')" aria-current="page">
                            <i class="fas fa-home" aria-hidden="true"></i>首页</a></li>
                        <li><a href="#" class="nav-link" onclick="showSection('review')">
                            <i class="fas fa-book" aria-hidden="true"></i>复习规划</a></li>
                        <li><a href="#" class="nav-link" onclick="showSection('videos')">
                            <i class="fas fa-video" aria-hidden="true"></i>视频课程</a></li>
                        <li><a href="#" class="nav-link" onclick="showSection('exercises')">
                            <i class="fas fa-question-circle" aria-hidden="true"></i>题库练习</a></li>
                        <li><a href="#" class="nav-link" onclick="showSection('scores')">
                            <i class="fas fa-chart-line" aria-hidden="true"></i>分数线</a></li>
                        <li><a href="#" class="nav-link" onclick="showSection('grades')">
                            <i class="fas fa-graduation-cap" aria-hidden="true"></i>成绩录入</a></li>
                    </ul>
                </nav>
                
                <div class="user-section">
                    <div class="user-info">
                        <div id="userAvatar" class="user-avatar">用</div>
                        <div>
                            <div id="displayUsername" style="font-weight: 600;">用户</div>
                            <div id="userRole" style="font-size: 0.75rem; opacity: 0.8;">学生</div>
                        </div>
                    </div>
                    
                    <button class="logout-button" onclick="logout()" aria-label="退出登录" title="退出登录">
                        <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </header>
        
        <main id="main-content" class="main-content">
            <!-- 首页 -->
            <section id="homeSection" class="content-section active">
                <div class="section-title">
                    <div class="section-icon">
                        <i class="fas fa-home" aria-hidden="true"></i>
                    </div>
                    <h2>欢迎来到流体力学学习平台</h2>
                </div>
                
                <div class="card">
                    <h3 style="margin-bottom: var(--space-4); color: var(--primary);">平台简介</h3>
                    <p style="line-height: 1.6; margin-bottom: var(--space-4);">
                        本平台是为中国海洋大学803流体力学考研学生打造的专业学习系统，
                        提供完整的复习规划、精品视频课程、全面的题库练习和详细的分数线分析。
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); margin-top: var(--space-6);">
                        <div style="text-align: center; padding: var(--space-4); border-radius: var(--radius-lg); background: rgba(30, 111, 168, 0.1);">
                            <i class="fas fa-book" style="font-size: 2rem; color: var(--primary); margin-bottom: var(--space-2);"></i>
                            <h4 style="color: var(--primary); margin-bottom: var(--space-1);">系统复习</h4>
                            <p style="font-size: 0.875rem; color: var(--secondary);">科学规划复习进度</p>
                        </div>
                        <div style="text-align: center; padding: var(--space-4); border-radius: var(--radius-lg); background: rgba(44, 154, 183, 0.1);">
                            <i class="fas fa-video" style="font-size: 2rem; color: var(--secondary); margin-bottom: var(--space-2);"></i>
                            <h4 style="color: var(--secondary); margin-bottom: var(--space-1);">精品课程</h4>
                            <p style="font-size: 0.875rem; color: var(--secondary);">高质量教学视频</p>
                        </div>
                        <div style="text-align: center; padding: var(--space-4); border-radius: var(--radius-lg); background: rgba(77, 184, 214, 0.1);">
                            <i class="fas fa-question-circle" style="font-size: 2rem; color: var(--accent); margin-bottom: var(--space-2);"></i>
                            <h4 style="color: var(--accent); margin-bottom: var(--space-1);">题库练习</h4>
                            <p style="font-size: 0.875rem; color: var(--secondary);">全面的习题训练</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 复习规划 -->
            <section id="reviewSection" class="content-section">
                <div class="section-title">
                    <div class="section-icon">
                        <i class="fas fa-book" aria-hidden="true"></i>
                    </div>
                    <h2>专业课复习规划 (803流体力学)</h2>
                </div>
                
                <div class="review-planner">
                    <h3 style="margin-bottom: var(--space-6); color: var(--primary);">
                        <i class="fas fa-calendar-alt" style="margin-right: var(--space-2);"></i>
                        专业课复习时间表
                    </h3>
                    
                    <div class="timeline-container">
                        <div class="timeline-month">
                            <h3 class="month-title">7月 - 基础巩固</h3>
                            <div class="plan-item">
                                <div class="week-label">第1周</div>
                                <div class="plan-content">
                                    <h4>流体的物理性质</h4>
                                    <p>连续介质模型、牛顿流体与非牛顿流体、流体的粘滞性</p>
                                </div>
                                <div class="status-check completed"></div>
                            </div>
                            <div class="plan-item">
                                <div class="week-label">第2周</div>
                                <div class="plan-content">
                                    <h4>本构方程和亥姆霍兹定理</h4>
                                    <p>应力张量、本构方程、速度分解定理</p>
                                </div>
                                <div class="status-check completed"></div>
                            </div>
                            <div class="plan-item">
                                <div class="week-label">第3-4周</div>
                                <div class="plan-content">
                                    <h4>理想流体动量方程</h4>
                                    <p>欧拉方程、伯努利方程及应用</p>
                                </div>
                                <div class="status-check"></div>
                            </div>
                        </div>
                        
                        <div class="timeline-month">
                            <h3 class="month-title">8月 - 核心原理</h3>
                            <div class="plan-item">
                                <div class="week-label">第1周</div>
                                <div class="plan-content">
                                    <h4>流体力学方程组</h4>
                                    <p>连续性方程、动量方程、能量方程</p>
                                </div>
                                <div class="status-check"></div>
                            </div>
                            <div class="plan-item">
                                <div class="week-label">第2周</div>
                                <div class="plan-content">
                                    <h4>涡旋运动</h4>
                                    <p>涡量、环量、涡旋运动基本定理</p>
                                </div>
                                <div class="status-check"></div>
                            </div>
                            <div class="plan-item">
                                <div class="week-label">第3-4周</div>
                                <div class="plan-content">
                                    <h4>势流理论基础</h4>
                                    <p>速度势函数、流函数、基本势流叠加原理</p>
                                </div>
                                <div class="status-check"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 视频课程 -->
            <section id="videosSection" class="content-section">
                <div class="section-title">
                    <div class="section-icon">
                        <i class="fas fa-video" aria-hidden="true"></i>
                    </div>
                    <h2>流体力学视频课程</h2>
                </div>
                
                <div class="video-grid">
                    <div class="video-card featured">
                        <div class="video-preview">
                            <i class="fas fa-water"></i>
                            <div class="play-button" onclick="playVideo('video1')">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                        <div class="video-info">
                            <h3 class="video-title">流体力学之美，太美了</h3>
                            <p class="video-description">探索流体世界的奇妙现象与科学原理，揭示自然界的流动艺术。</p>
                            <div class="video-duration">
                                <span><i class="far fa-clock"></i> 18:45</span>
                                <span><i class="far fa-eye"></i> 32,458</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="video-card">
                        <div class="video-preview">
                            <i class="fas fa-tint"></i>
                            <div class="play-button" onclick="playVideo('video2')">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                        <div class="video-info">
                            <h3 class="video-title">伯努利方程详解</h3>
                            <p class="video-description">深入讲解伯努利方程的推导过程和实际应用。</p>
                            <div class="video-duration">
                                <span><i class="far fa-clock"></i> 25:30</span>
                                <span><i class="far fa-eye"></i> 18,923</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="video-card">
                        <div class="video-preview">
                            <i class="fas fa-wind"></i>
                            <div class="play-button" onclick="playVideo('video3')">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                        <div class="video-info">
                            <h3 class="video-title">涡旋运动与环量</h3>
                            <p class="video-description">详细讲解涡旋运动的基本概念和环量的计算方法。</p>
                            <div class="video-duration">
                                <span><i class="far fa-clock"></i> 22:15</span>
                                <span><i class="far fa-eye"></i> 15,672</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="video-card">
                        <div class="video-preview">
                            <i class="fas fa-stream"></i>
                            <div class="play-button" onclick="playVideo('video4')">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                        <div class="video-info">
                            <h3 class="video-title">势流理论应用</h3>
                            <p class="video-description">势流理论在实际工程中的应用案例分析。</p>
                            <div class="video-duration">
                                <span><i class="far fa-clock"></i> 30:20</span>
                                <span><i class="far fa-eye"></i> 12,845</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 题库练习 -->
            <section id="exercisesSection" class="content-section">
                <div class="section-title">
                    <div class="section-icon">
                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                    </div>
                    <h2>题库练习系统</h2>
                </div>
                
                <div class="exercise-grid">
                    <div class="exercise-card">
                        <h3 class="exercise-title">流体静力学基础</h3>
                        <div class="exercise-meta">
                            <span><i class="fas fa-list"></i> 15题</span>
                            <span><i class="fas fa-clock"></i> 30分钟</span>
                            <span><i class="fas fa-star"></i> 基础</span>
                        </div>
                        <button class="start-btn" onclick="startExercise('static')">开始练习</button>
                    </div>
                    
                    <div class="exercise-card">
                        <h3 class="exercise-title">流体运动学</h3>
                        <div class="exercise-meta">
                            <span><i class="fas fa-list"></i> 20题</span>
                            <span><i class="fas fa-clock"></i> 45分钟</span>
                            <span><i class="fas fa-star"></i> 中等</span>
                        </div>
                        <button class="start-btn" onclick="startExercise('kinematics')">开始练习</button>
                    </div>
                    
                    <div class="exercise-card">
                        <h3 class="exercise-title">粘性流体流动</h3>
                        <div class="exercise-meta">
                            <span><i class="fas fa-list"></i> 12题</span>
                            <span><i class="fas fa-clock"></i> 40分钟</span>
                            <span><i class="fas fa-star"></i> 困难</span>
                        </div>
                        <button class="start-btn" onclick="startExercise('viscous')">开始练习</button>
                    </div>
                    
                    <div class="exercise-card">
                        <h3 class="exercise-title">伯努利方程应用</h3>
                        <div class="exercise-meta">
                            <span><i class="fas fa-list"></i> 18题</span>
                            <span><i class="fas fa-clock"></i> 35分钟</span>
                            <span><i class="fas fa-star"></i> 中等</span>
                        </div>
                        <button class="start-btn" onclick="startExercise('bernoulli')">开始练习</button>
                    </div>
                    
                    <div class="exercise-card">
                        <h3 class="exercise-title">涡旋运动理论</h3>
                        <div class="exercise-meta">
                            <span><i class="fas fa-list"></i> 16题</span>
                            <span><i class="fas fa-clock"></i> 38分钟</span>
                            <span><i class="fas fa-star"></i> 困难</span>
                        </div>
                        <button class="start-btn" onclick="startExercise('vortex')">开始练习</button>
                    </div>
                    
                    <div class="exercise-card">
                        <h3 class="exercise-title">势流理论</h3>
                        <div class="exercise-meta">
                            <span><i class="fas fa-list"></i> 14题</span>
                            <span><i class="fas fa-clock"></i> 32分钟</span>
                            <span><i class="fas fa-star"></i> 中等</span>
                        </div>
                        <button class="start-btn" onclick="startExercise('potential')">开始练习</button>
                    </div>
                </div>
            </section>

            <!-- 分数线 -->
            <section id="scoresSection" class="content-section">
                <div class="section-title">
                    <div class="section-icon">
                        <i class="fas fa-chart-line" aria-hidden="true"></i>
                    </div>
                    <h2>国家线和复试线对比分析</h2>
                </div>
                
                <div class="score-filters">
                    <button class="filter-btn active" onclick="filterScores('all')">全部年份</button>
                    <button class="filter-btn" onclick="filterScores('2023')">2023年</button>
                    <button class="filter-btn" onclick="filterScores('2024')">2024年</button>
                    <button class="filter-btn" onclick="filterScores('2025')">2025年</button>
                </div>
                
                <div class="score-chart-container">
                    <div class="chart-header">
                        <h3>803流体力学报考人数与分数线 (2023-2025)</h3>
                    </div>
                    <div class="chart-box">
                        <canvas id="scoreChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- 成绩录入 -->
            <section id="gradesSection" class="content-section">
                <div class="section-title">
                    <div class="section-icon">
                        <i class="fas fa-graduation-cap" aria-hidden="true"></i>
                    </div>
                    <h2>成绩录入管理</h2>
                </div>
                
                <div class="grade-container">
                    <form class="grade-form" onsubmit="addGrade(event)">
                        <input type="text" placeholder="学生姓名" id="studentName" required>
                        <input type="number" placeholder="成绩" id="gradeScore" min="0" max="150" required>
                        <button type="submit" class="add-grade-btn">添加成绩</button>
                    </form>
                    
                    <div id="gradesList" style="margin-top: var(--space-6);">
                        <p style="text-align: center; color: var(--secondary); padding: var(--space-8);">
                            暂无成绩记录
                        </p>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="footer">
            <div style="max-width: 1200px; margin: 0 auto; padding: 0 var(--space-6);">
                <p>© 2025 中国海洋大学流体力学学习平台 版本 9.0</p>
                <p style="margin-top: var(--space-2); font-size: 0.875rem; opacity: 0.8;">
                    探索流体世界的奥秘 · 理解自然规律的艺术
                </p>
            </div>
        </footer>
    </div>
    
    <script>
        'use strict';
        
        // 用户账号数据
        const USER_ACCOUNTS = {
            'liuguanghui6330156': { 
                name: '刘光辉', 
                role: 'teacher', 
                password: 'Ll700306', 
                avatar: '刘'
            },
            'student1': { 
                name: '学生账号', 
                role: 'student', 
                password: '123456', 
                avatar: '学'
            },
            'niwenxuan': { 
                name: '倪文轩', 
                role: 'student', 
                password: 'niwenxuan2025', 
                avatar: '倪'
            },
            'hanwenxu': { 
                name: '韩文旭', 
                role: 'student', 
                password: 'hanwenxu2025', 
                avatar: '韩'
            }
        };
        
        // 视频数据
        const videosData = [
            {
                id: 'video1',
                title: '流体力学之美，太美了',
                description: '探索流体世界的奇妙现象与科学原理，揭示自然界的流动艺术。',
                source: 'BV16T421D7k4',
                duration: '18:45',
                views: '32,458',
                category: '基础理论',
                featured: true
            },
            {
                id: 'video2',
                title: '伯努利方程详解',
                description: '深入讲解伯努利方程的推导过程和实际应用。',
                source: 'sample2',
                duration: '25:30',
                views: '18,923',
                category: '核心原理'
            },
            {
                id: 'video3',
                title: '涡旋运动与环量',
                description: '详细讲解涡旋运动的基本概念和环量的计算方法。',
                source: 'sample3',
                duration: '22:15',
                views: '15,672',
                category: '高级理论'
            },
            {
                id: 'video4',
                title: '势流理论应用',
                description: '势流理论在实际工程中的应用案例分析。',
                source: 'sample4',
                duration: '30:20',
                views: '12,845',
                category: '应用实践'
            }
        ];
        
        // 题库数据
        const exercisesData = [
            {
                id: 'exercise1',
                title: '流体静力学基础',
                description: '流体静力学的基本概念和计算方法',
                questionCount: 15,
                duration: '30分钟',
                difficulty: '基础',
                category: '静力学'
            },
            {
                id: 'exercise2',
                title: '流体运动学',
                description: '流体运动学的基本概念和计算方法',
                questionCount: 20,
                duration: '45分钟',
                difficulty: '中等',
                category: '运动学'
            },
            {
                id: 'exercise3',
                title: '粘性流体流动',
                description: '粘性流体流动的基本概念和计算方法',
                questionCount: 12,
                duration: '40分钟',
                difficulty: '困难',
                category: '动力学'
            },
            {
                id: 'exercise4',
                title: '伯努利方程应用',
                description: '伯努利方程在实际问题中的应用',
                questionCount: 18,
                duration: '35分钟',
                difficulty: '中等',
                category: '应用'
            }
        ];
        
        // 分数线数据
        const scoreData = {
            '2023': {
                national: 280,
                reexam: 320,
                applicants: 150,
                admitted: 45
            },
            '2024': {
                national: 285,
                reexam: 325,
                applicants: 180,
                admitted: 50
            },
            '2025': {
                national: 290,
                reexam: 330,
                applicants: 200,
                admitted: 55
            }
        };
        
        // 应用状态
        let currentUser = null;
        let isLoggedIn = false;
        let currentSection = 'home';
        let loginAttempts = 0;
        const MAX_LOGIN_ATTEMPTS = 5;
        const LOCKOUT_DURATION = 15 * 60 * 1000;
        let lockoutEndTime = null;
        
        // DOM元素缓存
        const DOM = {};
        
        /**
         * 防抖函数
         */
        function debounce(func, wait, immediate = false) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    timeout = null;
                    if (!immediate) func.apply(this, args);
                };
                const callNow = immediate && !timeout;
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
                if (callNow) func.apply(this, args);
            };
        }
        
        /**
         * 输入验证和清理
         */
        function sanitizeInput(input, type = 'text') {
            if (typeof input !== 'string') return '';
            input = input.trim();
            
            switch (type) {
                case 'username':
                    return input.replace(/[^a-zA-Z0-9_]/g, '').substring(0, 50);
                case 'password':
                    return input.substring(0, 100);
                default:
                    return input.substring(0, 1000);
            }
        }
        
        /**
         * 显示消息
         */
        function showMessage(message, type = 'info', duration = 5000) {
            const messageEl = DOM.loginMessage;
            if (!messageEl) return;
            
            messageEl.className = `message show ${type}`;
            messageEl.textContent = message;
            
            if (duration > 0) {
                setTimeout(() => {
                    messageEl.classList.remove('show');
                    setTimeout(() => {
                        messageEl.textContent = '';
                        messageEl.className = 'message';
                    }, 300);
                }, duration);
            }
        }
        
        /**
         * 设置按钮加载状态
         */
        function setLoginButtonLoading(loading) {
            const button = DOM.loginButton;
            const buttonText = DOM.loginButtonText;
            const spinner = DOM.loginButtonSpinner;
            
            if (!button || !buttonText || !spinner) return;
            
            if (loading) {
                button.disabled = true;
                buttonText.style.display = 'none';
                spinner.style.display = 'inline-block';
            } else {
                button.disabled = false;
                buttonText.style.display = 'inline';
                spinner.style.display = 'none';
            }
        }
        
        /**
         * 检查是否被锁定
         */
        function isLockedOut() {
            if (!lockoutEndTime) return false;
            
            const now = Date.now();
            if (now < lockoutEndTime) {
                const remainingTime = Math.ceil((lockoutEndTime - now) / 1000 / 60);
                return remainingTime;
            } else {
                lockoutEndTime = null;
                loginAttempts = 0;
                return false;
            }
        }
        
        /**
         * 验证用户凭据
         */
        function validateCredentials(username, password) {
            username = sanitizeInput(username, 'username');
            password = sanitizeInput(password, 'password');
            
            if (!username || !password) {
                return { error: '用户名和密码不能为空' };
            }
            
            if (username.length < 3) {
                return { error: '用户名长度至少3位' };
            }
            
            if (password.length < 6) {
                return { error: '密码长度至少6位' };
            }
            
            const lockoutMinutes = isLockedOut();
            if (lockoutMinutes) {
                return { error: `登录失败次数过多，请等待 ${lockoutMinutes} 分钟后重试` };
            }
            
            const user = USER_ACCOUNTS[username];
            if (!user) {
                loginAttempts++;
                return { error: '用户名或密码错误' };
            }
            
            if (user.password !== password) {
                loginAttempts++;
                
                if (loginAttempts >= MAX_LOGIN_ATTEMPTS) {
                    lockoutEndTime = Date.now() + LOCKOUT_DURATION;
                    return { error: `登录失败次数过多，账户已被锁定 ${LOCKOUT_DURATION / 60000} 分钟` };
                }
                
                const remainingAttempts = MAX_LOGIN_ATTEMPTS - loginAttempts;
                return { error: `用户名或密码错误，还有 ${remainingAttempts} 次尝试机会` };
            }
            
            loginAttempts = 0;
            lockoutEndTime = null;
            
            return { user: { ...user, username } };
        }
        
        /**
         * 执行登录
         */
        async function performLogin(username, password) {
            setLoginButtonLoading(true);
            
            try {
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const result = validateCredentials(username, password);
                
                if (result.error) {
                    showMessage(result.error, 'error', 6000);
                    
                    DOM.loginForm.style.animation = 'shake 0.5s ease-in-out';
                    setTimeout(() => {
                        DOM.loginForm.style.animation = '';
                    }, 500);
                    
                    return;
                }
                
                currentUser = result.user;
                isLoggedIn = true;
                
                showMessage(`登录成功！欢迎 ${currentUser.name}`, 'success', 2000);
                
                try {
                    sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
                    sessionStorage.setItem('loginTime', Date.now().toString());
                } catch (error) {
                    console.warn('无法保存会话状态:', error);
                }
                
                setTimeout(() => {
                    showPlatform();
                }, 1500);
                
            } catch (error) {
                console.error('登录过程中发生错误:', error);
                showMessage('登录过程中发生错误，请稍后重试', 'error');
            } finally {
                setLoginButtonLoading(false);
            }
        }
        
        /**
         * 显示主平台界面
         */
        function showPlatform() {
            if (!currentUser) return;
            
            DOM.loginSystem.style.display = 'none';
            DOM.platform.classList.add('active');
            
            updateUserDisplay();
            showSection('home');
        }
        
        /**
         * 更新用户显示信息
         */
        function updateUserDisplay() {
            if (!currentUser) return;
            
            if (DOM.userAvatar) {
                DOM.userAvatar.textContent = currentUser.avatar || currentUser.name.charAt(0);
            }
            
            if (DOM.displayUsername) {
                DOM.displayUsername.textContent = currentUser.name;
            }
            
            if (DOM.userRole) {
                DOM.userRole.textContent = currentUser.role === 'teacher' ? '教师' : '学生';
            }
        }
        
        /**
         * 显示指定的内容区域
         */
        function showSection(sectionName) {
            if (!isLoggedIn) return;
            
            currentSection = sectionName;
            
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            const targetSection = document.getElementById(`${sectionName}Section`);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                link.removeAttribute('aria-current');
            });
            
            const activeLink = document.querySelector(`[onclick="showSection('${sectionName}')"]`);
            if (activeLink) {
                activeLink.classList.add('active');
                activeLink.setAttribute('aria-current', 'page');
            }
            
            const titles = {
                home: '首页',
                review: '复习规划',
                videos: '视频课程',
                exercises: '题库练习',
                scores: '分数线分析',
                grades: '成绩录入'
            };
            
            document.title = `${titles[sectionName] || '流体力学学习平台'} - 中国海洋大学`;
        }
        
        /**
         * 切换移动端菜单
         */
        function toggleMobileMenu() {
            const navMenu = document.querySelector('.nav-menu');
            if (navMenu) {
                navMenu.classList.toggle('active');
            }
        }
        
        /**
         * 退出登录
         */
        function logout() {
            if (!confirm('确定要退出登录吗？')) return;
            
            currentUser = null;
            isLoggedIn = false;
            
            try {
                sessionStorage.removeItem('currentUser');
                sessionStorage.removeItem('loginTime');
            } catch (error) {
                console.warn('清理会话状态失败:', error);
            }
            
            DOM.platform.classList.remove('active');
            DOM.loginSystem.style.display = 'flex';
            
            if (DOM.loginForm) {
                DOM.loginForm.reset();
            }
            
            if (DOM.loginMessage) {
                DOM.loginMessage.textContent = '';
                DOM.loginMessage.className = 'message';
            }
        }
        
        /**
         * 显示密码重置模态框
         */
        function showPasswordResetModal() {
            showMessage('密码重置功能正在开发中，请联系管理员', 'info');
        }
        
        /**
         * 播放视频
         */
        function playVideo(videoId) {
            const video = videosData.find(v => v.id === videoId);
            if (video) {
                showVideoModal(video);
            } else {
                showMessage('视频未找到', 'error');
            }
        }
        
        /**
         * 显示视频模态框
         */
        function showVideoModal(video) {
            const modal = document.createElement('div');
            modal.className = 'video-modal';
            modal.innerHTML = `
                <div class="video-modal-content">
                    <div class="video-modal-header">
                        <h3>${video.title}</h3>
                        <button onclick="closeVideoModal()" class="close-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="video-container">
                        <div class="video-placeholder">
                            <i class="fas fa-play-circle"></i>
                            <p>视频播放器</p>
                            <small>${video.description}</small>
                        </div>
                    </div>
                    <div class="video-info">
                        <p><i class="far fa-clock"></i> ${video.duration}</p>
                        <p><i class="far fa-eye"></i> ${video.views} 次观看</p>
                        <p><i class="fas fa-tag"></i> ${video.category}</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('active'), 10);
        }
        
        /**
         * 关闭视频模态框
         */
        function closeVideoModal() {
            const modal = document.querySelector('.video-modal');
            if (modal) {
                modal.classList.remove('active');
                setTimeout(() => modal.remove(), 300);
            }
        }
        
        /**
         * 开始练习
         */
        function startExercise(type) {
            showMessage(`${type}练习功能正在开发中`, 'info');
        }
        
        /**
         * 筛选分数线
         */
        function filterScores(year) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
            showMessage(`显示${year}年分数线数据`, 'info');
            
            // 更新图表
            updateScoreChart(year);
        }
        
        /**
         * 更新分数线图表
         */
        function updateScoreChart(year) {
            const ctx = document.getElementById('scoreChart');
            if (!ctx) return;
            
            const data = scoreData[year] || scoreData['2024'];
            
            if (window.scoreChart) {
                window.scoreChart.destroy();
            }
            
            window.scoreChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['国家线', '复试线'],
                    datasets: [{
                        label: `${year}年分数线`,
                        data: [data.national, data.reexam],
                        backgroundColor: [
                            'rgba(231, 76, 60, 0.8)',
                            'rgba(52, 152, 219, 0.8)'
                        ],
                        borderColor: [
                            'rgba(231, 76, 60, 1)',
                            'rgba(52, 152, 219, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 400,
                            ticks: {
                                stepSize: 50
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        /**
         * 添加成绩
         */
        function addGrade(event) {
            event.preventDefault();
            
            const studentName = document.getElementById('studentName').value;
            const gradeScore = document.getElementById('gradeScore').value;
            
            if (!studentName || !gradeScore) {
                showMessage('请填写完整信息', 'error');
                return;
            }
            
            // 验证成绩范围
            const score = parseInt(gradeScore);
            if (score < 0 || score > 150) {
                showMessage('成绩必须在0-150分之间', 'error');
                return;
            }
            
            // 添加到成绩列表
            addGradeToList(studentName, score);
            
            showMessage(`已添加 ${studentName} 的成绩：${gradeScore}分`, 'success');
            
            document.getElementById('studentName').value = '';
            document.getElementById('gradeScore').value = '';
        }
        
        /**
         * 添加成绩到列表
         */
        function addGradeToList(name, score) {
            const gradesList = document.getElementById('gradesList');
            
            // 如果是第一次添加，清除"暂无成绩记录"的提示
            if (gradesList.querySelector('p')) {
                gradesList.innerHTML = '';
            }
            
            const gradeItem = document.createElement('div');
            gradeItem.className = 'grade-item';
            gradeItem.innerHTML = `
                <div class="grade-info">
                    <span class="grade-name">${name}</span>
                    <span class="grade-score">${score}分</span>
                </div>
                <div class="grade-actions">
                    <button onclick="editGrade(this)" class="edit-btn">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button onclick="deleteGrade(this)" class="delete-btn">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            gradesList.appendChild(gradeItem);
        }
        
        /**
         * 编辑成绩
         */
        function editGrade(button) {
            const gradeItem = button.closest('.grade-item');
            const nameSpan = gradeItem.querySelector('.grade-name');
            const scoreSpan = gradeItem.querySelector('.score');
            
            const newName = prompt('请输入新的姓名:', nameSpan.textContent);
            const newScore = prompt('请输入新的成绩:', scoreSpan.textContent.replace('分', ''));
            
            if (newName && newScore) {
                nameSpan.textContent = newName;
                scoreSpan.textContent = newScore + '分';
                showMessage('成绩已更新', 'success');
            }
        }
        
        /**
         * 删除成绩
         */
        function deleteGrade(button) {
            if (confirm('确定要删除这条成绩记录吗？')) {
                const gradeItem = button.closest('.grade-item');
                gradeItem.remove();
                showMessage('成绩已删除', 'success');
            }
        }
        
        /**
         * 缓存DOM元素
         */
        function cacheDOM() {
            DOM.loginSystem = document.getElementById('loginSystem');
            DOM.platform = document.getElementById('platform');
            DOM.loginForm = document.getElementById('loginForm');
            DOM.loginMessage = document.getElementById('loginMessage');
            DOM.loginButton = document.getElementById('loginButton');
            DOM.loginButtonText = document.getElementById('loginButtonText');
            DOM.loginButtonSpinner = document.getElementById('loginButtonSpinner');
            DOM.usernameInput = document.getElementById('username');
            DOM.passwordInput = document.getElementById('password');
            DOM.userAvatar = document.getElementById('userAvatar');
            DOM.displayUsername = document.getElementById('displayUsername');
            DOM.userRole = document.getElementById('userRole');
        }
        
        /**
         * 绑定事件监听器
         */
        function bindEvents() {
            DOM.loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const username = DOM.usernameInput.value;
                const password = DOM.passwordInput.value;
                
                await performLogin(username, password);
            });
            
            DOM.usernameInput.addEventListener('input', debounce((e) => {
                const value = e.target.value;
                const isValid = value.length >= 3;
                e.target.classList.toggle('invalid', !isValid);
            }, 300));
            
            DOM.passwordInput.addEventListener('input', debounce((e) => {
                const value = e.target.value;
                const isValid = value.length >= 6;
                e.target.classList.toggle('invalid', !isValid);
            }, 300));
        }
        
        /**
         * 尝试恢复会话
         */
        function tryRestoreSession() {
            try {
                const savedUser = sessionStorage.getItem('currentUser');
                const loginTime = sessionStorage.getItem('loginTime');
                
                if (savedUser && loginTime) {
                    const user = JSON.parse(savedUser);
                    const loginTimestamp = parseInt(loginTime, 10);
                    const now = Date.now();
                    
                    const SESSION_DURATION = 24 * 60 * 60 * 1000;
                    if (user && (now - loginTimestamp) < SESSION_DURATION) {
                        currentUser = user;
                        isLoggedIn = true;
                        showPlatform();
                        return true;
                    } else {
                        sessionStorage.removeItem('currentUser');
                        sessionStorage.removeItem('loginTime');
                    }
                }
            } catch (error) {
                console.warn('会话恢复失败:', error);
                sessionStorage.removeItem('currentUser');
                sessionStorage.removeItem('loginTime');
            }
            
            return false;
        }
        
        /**
         * 应用程序初始化
         */
        function initializeApp() {
            try {
                console.info('正在初始化流体力学学习平台...');
                
                cacheDOM();
                bindEvents();
                
                if (!tryRestoreSession()) {
                    console.info('显示登录界面');
                } else {
                    // 如果已登录，初始化图表
                    setTimeout(() => {
                        updateScoreChart('2024');
                    }, 500);
                }
                
                console.info('流体力学学习平台初始化完成！');
                
            } catch (error) {
                console.error('应用程序初始化失败:', error);
                
                document.body.innerHTML = `
                    <div style="padding: 2rem; text-align: center; background: rgba(231, 76, 60, 0.1); margin: 2rem; border-radius: 1rem;">
                        <h2 style="color: var(--error); margin-bottom: 1rem;">系统初始化失败</h2>
                        <p style="margin-bottom: 2rem;">应用程序无法正常启动，请刷新页面重试。</p>
                        <button onclick="location.reload()" style="padding: 0.5rem 2rem; background: var(--primary); color: white; border: none; border-radius: 0.5rem; cursor: pointer;">刷新页面</button>
                    </div>
                `;
            }
        }
        
        // 暴露全局函数
        window.showSection = showSection;
        window.toggleMobileMenu = toggleMobileMenu;
        window.logout = logout;
        window.showPasswordResetModal = showPasswordResetModal;
        window.playVideo = playVideo;
        window.startExercise = startExercise;
        window.filterScores = filterScores;
        window.addGrade = addGrade;
        window.closeVideoModal = closeVideoModal;
        window.editGrade = editGrade;
        window.deleteGrade = deleteGrade;
        
        // 应用程序启动
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
        
    </script>
</body>
</html> 