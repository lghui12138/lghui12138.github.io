<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIåŠ©æ‰‹LaTeXä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .test-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }
        
        .test-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #fff;
        }
        
        .latex-test {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 1.2em;
        }
        
        .ai-test {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        
        button {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .result {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            min-height: 50px;
        }
        
        .vector-perfect {
            position: relative;
            font-weight: bold;
            display: inline-block;
            margin: 0 2px;
        }
        
        .vector-perfect::after {
            content: 'â†’';
            position: absolute;
            top: -0.4em;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em;
            font-weight: normal;
            line-height: 1;
            color: currentColor;
            z-index: 1;
        }
        
        .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 3px;
        }
        
        .numerator {
            display: block;
            border-bottom: 1px solid currentColor;
            padding-bottom: 2px;
            font-size: 0.9em;
        }
        
        .denominator {
            display: block;
            padding-top: 2px;
            font-size: 0.9em;
        }
        
        .sqrt {
            position: relative;
            display: inline-block;
            margin: 0 2px;
        }
        
        .sqrt-content {
            border-top: 1px solid currentColor;
            padding-left: 3px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª AIåŠ©æ‰‹LaTeXç¬¦å·ä¿®å¤æµ‹è¯•</h1>
    
    <div class="test-container">
        <div class="test-title">ğŸ“ LaTeXç¬¦å·æ¸²æŸ“æµ‹è¯•</div>
        
        <div class="latex-test" id="latex-test-1">
            æµ‹è¯•å¸Œè…Šå­—æ¯ï¼š\alpha, \beta, \gamma, \delta, \lambda, \mu, \rho, \sigma, \omega
        </div>
        
        <div class="latex-test" id="latex-test-2">
            æµ‹è¯•ç‚¹ç¬¦å·ï¼š\dot{Î³}, \ddot{x}, \hat{y}, \tilde{z}, \bar{u}
        </div>
        
        <div class="latex-test" id="latex-test-3">
            æµ‹è¯•å‘é‡ï¼š\vec{v}, \vec{F}, \nabla \cdot \vec{v} = 0
        </div>
        
        <div class="latex-test" id="latex-test-4">
            æµ‹è¯•åˆ†æ•°ï¼š\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \vec{v}) = 0
        </div>
        
        <button onclick="processLatexTests()">ğŸ”„ å¤„ç†LaTeXç¬¦å·</button>
    </div>
    
    <div class="test-container">
        <div class="test-title">ğŸ¤– AIè°ƒç”¨æµ‹è¯•</div>
        
        <div class="ai-test">
            <button onclick="testSimpleAI()">æµ‹è¯•ç®€å•é—®ç­”</button>
            <button onclick="testComplexMath()">æµ‹è¯•æ•°å­¦æ¨å¯¼</button>
            <button onclick="testLatexResponse()">æµ‹è¯•LaTeXå“åº”</button>
        </div>
        
        <div class="result" id="ai-result">
            ç‚¹å‡»æŒ‰é’®æµ‹è¯•AIåŠŸèƒ½...
        </div>
    </div>
    
    <script src="js/core/smart-model-selector.js"></script>
    <script>
        // LaTeXç¬¦å·å¤„ç†å‡½æ•°
        function processLatexSymbols(text) {
            return text
                // å¸Œè…Šå­—æ¯
                .replace(/\\alpha/g, 'Î±').replace(/\\beta/g, 'Î²').replace(/\\gamma/g, 'Î³')
                .replace(/\\delta/g, 'Î´').replace(/\\lambda/g, 'Î»').replace(/\\mu/g, 'Î¼')
                .replace(/\\rho/g, 'Ï').replace(/\\sigma/g, 'Ïƒ').replace(/\\omega/g, 'Ï‰')
                // ç‚¹ç¬¦å·
                .replace(/\\dot\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">Ë™</span></span>')
                .replace(/\\ddot\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">Â¨</span></span>')
                .replace(/\\hat\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">^</span></span>')
                .replace(/\\tilde\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.5em;left:50%;transform:translateX(-50%);font-size:0.8em;">~</span></span>')
                .replace(/\\bar\{([^}]+)\}/g, '<span style="position:relative;">$1<span style="position:absolute;top:-0.3em;left:0;right:0;height:1px;background:currentColor;"></span></span>')
                // å‘é‡
                .replace(/\\vec\{([^}]+)\}/g, '<span class="vector-perfect">$1</span>')
                // æ•°å­¦ç¬¦å·
                .replace(/\\nabla/g, 'âˆ‡').replace(/\\partial/g, 'âˆ‚').replace(/\\cdot/g, 'Â·')
                // åˆ†æ•°
                .replace(/\\frac\{([^}]+)\}\{([^}]+)\}/g, '<span class="fraction"><span class="numerator">$1</span><span class="denominator">$2</span></span>');
        }
        
        function processLatexTests() {
            console.log('ğŸ”„ å¼€å§‹å¤„ç†LaTeXç¬¦å·...');
            
            for (let i = 1; i <= 4; i++) {
                const element = document.getElementById(`latex-test-${i}`);
                const originalText = element.textContent;
                const processedText = processLatexSymbols(originalText);
                element.innerHTML = processedText;
                console.log(`âœ… å¤„ç†æµ‹è¯•${i}:`, originalText, '->', processedText);
            }
        }
        
        async function testSimpleAI() {
            const resultDiv = document.getElementById('ai-result');
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•ç®€å•AIé—®ç­”...';
            
            try {
                const response = await window.SmartModelSelector.callAI('ä»€ä¹ˆæ˜¯æµä½“åŠ›å­¦ï¼Ÿ', {
                    maxTokens: 200,
                    temperature: 0.7,
                    requestTimeout: 60000
                });
                
                resultDiv.innerHTML = `âœ… ç®€å•é—®ç­”æˆåŠŸï¼š<br>${response}`;
            } catch (error) {
                resultDiv.innerHTML = `âŒ ç®€å•é—®ç­”å¤±è´¥ï¼š${error.message}`;
                console.error('ç®€å•AIæµ‹è¯•å¤±è´¥:', error);
            }
        }
        
        async function testComplexMath() {
            const resultDiv = document.getElementById('ai-result');
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•æ•°å­¦æ¨å¯¼ï¼ˆDeepSeek-R1ï¼‰...';
            
            try {
                const response = await window.SmartModelSelector.callAI('è¯·æ¨å¯¼çº³ç»´-æ–¯æ‰˜å…‹æ–¯æ–¹ç¨‹', {
                    strategy: 'reasoning',
                    features: ['reasoning', 'math', 'derivation'],
                    maxTokens: 1000,
                    temperature: 0.3,
                    preferredModel: 'deepseek-r1',
                    requestTimeout: 180000,
                    systemPrompt: 'ä½ æ˜¯æµä½“åŠ›å­¦ä¸“å®¶ï¼Œè¯·ç”¨LaTeXè¯­æ³•è¡¨ç¤ºæ•°å­¦å…¬å¼ã€‚'
                });
                
                resultDiv.innerHTML = `âœ… æ•°å­¦æ¨å¯¼æˆåŠŸï¼š<br>${response}`;
            } catch (error) {
                resultDiv.innerHTML = `âŒ æ•°å­¦æ¨å¯¼å¤±è´¥ï¼š${error.message}`;
                console.error('æ•°å­¦æ¨å¯¼æµ‹è¯•å¤±è´¥:', error);
            }
        }
        
        async function testLatexResponse() {
            const resultDiv = document.getElementById('ai-result');
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•LaTeXå“åº”å¤„ç†...';
            
            try {
                const response = await window.SmartModelSelector.callAI('ç”¨LaTeXæ ¼å¼å†™å‡ºè¿ç»­æ€§æ–¹ç¨‹', {
                    maxTokens: 300,
                    temperature: 0.5,
                    requestTimeout: 60000,
                    systemPrompt: 'è¯·ç”¨LaTeXè¯­æ³•å›ç­”ï¼Œä½¿ç”¨$$åŒ…å›´å…¬å¼ã€‚'
                });
                
                // å¤„ç†å“åº”ä¸­çš„LaTeXç¬¦å·
                const processedResponse = processLatexSymbols(response);
                resultDiv.innerHTML = `âœ… LaTeXå“åº”æˆåŠŸï¼š<br>${processedResponse}`;
            } catch (error) {
                resultDiv.innerHTML = `âŒ LaTeXå“åº”å¤±è´¥ï¼š${error.message}`;
                console.error('LaTeXå“åº”æµ‹è¯•å¤±è´¥:', error);
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ğŸš€ åˆå§‹åŒ–æµ‹è¯•é¡µé¢...');
            
            try {
                await window.SmartModelSelector.init({
                    apiKey: "sk-dhseqxecuwwotodiskfdgwdjahnbexcgdotkfsovbgajxnis",
                    apiUrl: "https://api.siliconflow.cn/v1/chat/completions",
                    maxRetries: 3,
                    requestTimeout: 120000
                });
                console.log('âœ… SmartModelSelectoråˆå§‹åŒ–å®Œæˆ');
            } catch (error) {
                console.error('âŒ SmartModelSelectoråˆå§‹åŒ–å¤±è´¥:', error);
            }
        });
    </script>
</body>
</html>
