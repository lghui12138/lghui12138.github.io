<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ é¢˜åº“ç³»ç»Ÿ - å¯å·¥ä½œé›†æˆç‰ˆ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .main-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 40px;
        }
        
        .btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(67, 233, 123, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .status-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            text-align: center;
        }
        
        .status-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .status-label {
            opacity: 0.8;
            font-size: 0.9em;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .log-panel {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 20px;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-success { color: #51cf66; }
        .log-error { color: #ff6b6b; }
        .log-info { color: #4facfe; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ æµä½“åŠ›å­¦é¢˜åº“ç³»ç»Ÿ</h1>
            <p>å¯å·¥ä½œçš„é›†æˆç‰ˆæœ¬ - åŸºäº practice-fullscreen-fixed-final.html çš„æˆåŠŸé€»è¾‘</p>
        </div>

        <div class="status-panel">
            <div class="status-grid">
                <div>
                    <div class="status-value" id="total-questions">0</div>
                    <div class="status-label">é¢˜ç›®æ€»æ•°</div>
                </div>
                <div>
                    <div class="status-value" id="loaded-banks">0</div>
                    <div class="status-label">å·²åŠ è½½é¢˜åº“</div>
                </div>
                <div>
                    <div class="status-value" id="load-status">å¾…æœº</div>
                    <div class="status-label">åŠ è½½çŠ¶æ€</div>
                </div>
                <div>
                    <div class="status-value" id="system-status">åˆå§‹åŒ–ä¸­</div>
                    <div class="status-label">ç³»ç»ŸçŠ¶æ€</div>
                </div>
            </div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary" onclick="loadAllQuestions()" id="load-btn">
                <i class="fas fa-download"></i> ä»GitHubåŠ è½½é¢˜åº“
            </button>
            <button class="btn" onclick="startPractice()" id="practice-btn" disabled>
                <i class="fas fa-play"></i> å¼€å§‹ç»ƒä¹ 
            </button>
            <button class="btn" onclick="openFullscreen()" id="fullscreen-btn" disabled>
                <i class="fas fa-expand"></i> å…¨å±æ¨¡å¼
            </button>
        </div>

        <div class="status-panel">
            <h3>åŠ è½½æ—¥å¿—</h3>
            <div class="log-panel" id="log-panel">
                <div class="log-entry log-info">[åˆå§‹åŒ–] ç³»ç»Ÿå‡†å¤‡å°±ç»ª</div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        // ============ å…¨å±€å˜é‡ ============
        let questions = [];
        let currentIndex = 0;
        let loadedBankCount = 0;
        let isLoading = false;
        
        // GitHubé…ç½®
        const GITHUB_CONFIG = {
            owner: 'lghui12138',
            repo: 'lghui12138.github.io',
            branch: 'main',
            rawBaseUrl: 'https://raw.githubusercontent.com/lghui12138/lghui12138.github.io/main'
        };
        
        // é¢˜åº“æ–‡ä»¶åˆ—è¡¨ (ä»å¯å·¥ä½œçš„ç‰ˆæœ¬å¤åˆ¶)
        const questionBankFiles = [
            'æ˜“é”™é¢˜é›†.json',
            'çœŸé¢˜_ä¸­å›½æµ·æ´‹å¤§å­¦_2000-2021_cleaned.json',
            'çœŸé¢˜_ä¸­å›½æµ·æ´‹å¤§å­¦_2000-2021.json',
            'åˆ†ç±»_åŠ¨é‡æ–¹ç¨‹.json',
            'åˆ†ç±»_åŠ¿æµ.json',
            'åˆ†ç±»_å‹åŠ›.json',
            'åˆ†ç±»_å®éªŒä¸é‡çº².json',
            'åˆ†ç±»_æµä½“åŠ›å­¦åŸºç¡€.json',
            'åˆ†ç±»_æµä½“æ€§è´¨.json',
            'åˆ†ç±»_æµçº¿è½¨è¿¹.json',
            'åˆ†ç±»_æ¶¡åº¦.json',
            'åˆ†ç±»_æ¹æµ.json',
            'åˆ†ç±»_ç®¡é“æµåŠ¨.json',
            'åˆ†ç±»_ç²˜æ€§.json',
            'åˆ†ç±»_èƒ½é‡æ–¹ç¨‹.json',
            'åˆ†ç±»_è‡ªç”±é¢.json',
            'åˆ†ç±»_è¾¹ç•Œå±‚.json',
            'åˆ†ç±»_é›·è¯ºæ•°.json'
        ];
        
        // ============ æ—¥å¿—åŠŸèƒ½ ============
        function addLog(message, type = 'info') {
            const logPanel = document.getElementById('log-panel');
            const time = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `[${time}] ${message}`;
            logPanel.appendChild(logEntry);
            logPanel.scrollTop = logPanel.scrollHeight;
        }
        
        // ============ çŠ¶æ€æ›´æ–° ============
        function updateStatus() {
            document.getElementById('total-questions').textContent = questions.length;
            document.getElementById('loaded-banks').textContent = loadedBankCount;
            document.getElementById('load-status').textContent = isLoading ? 'åŠ è½½ä¸­' : 'å®Œæˆ';
            document.getElementById('system-status').textContent = questions.length > 0 ? 'å°±ç»ª' : 'å¾…åŠ è½½';
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const practiceBtn = document.getElementById('practice-btn');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const canPractice = questions.length > 0 && !isLoading;
            
            practiceBtn.disabled = !canPractice;
            fullscreenBtn.disabled = !canPractice;
        }
        
        // ============ é¢˜åº“åŠ è½½ (å¤åˆ¶å¯å·¥ä½œçš„é€»è¾‘) ============
        async function loadAllQuestions() {
            if (isLoading) {
                addLog('é¢˜åº“æ­£åœ¨åŠ è½½ä¸­...', 'info');
                return;
            }
            
            isLoading = true;
            loadedBankCount = 0;
            questions = [];
            
            addLog('å¼€å§‹ä»GitHubæ‰¹é‡åŠ è½½é¢˜åº“...', 'info');
            updateStatus();
            
            let totalLoaded = 0;
            
            for (const file of questionBankFiles) {
                try {
                    addLog(`æ­£åœ¨åŠ è½½: ${file}`, 'info');
                    const url = `${GITHUB_CONFIG.rawBaseUrl}/question-banks/${file}`;
                    const response = await fetch(url);
                    
                    if (response.ok) {
                        const data = await response.json();
                        const questionData = Array.isArray(data) ? data : (data.questions ? data.questions : []);
                        
                        if (questionData && questionData.length > 0) {
                            const convertedQuestions = questionData.map((q, index) => ({
                                id: totalLoaded + index + 1,
                                title: q.title || q.question || `é¢˜ç›®${totalLoaded + index + 1}`,
                                options: q.options || ['A', 'B', 'C', 'D'],
                                answer: typeof q.answer === 'number' ? q.answer : (q.correctAnswer || 0),
                                explanation: q.explanation || 'æš‚æ— è§£æ',
                                category: q.category || 'æµä½“åŠ›å­¦',
                                difficulty: q.difficulty || 'medium',
                                year: q.year || null,
                                school: q.school || 'ä¸­å›½æµ·æ´‹å¤§å­¦',
                                bank: file.replace('.json', ''),
                                bankId: file
                            }));
                            
                            questions = questions.concat(convertedQuestions);
                            totalLoaded += convertedQuestions.length;
                            loadedBankCount++;
                            
                            addLog(`âœ… ${file}: +${convertedQuestions.length}é¢˜`, 'success');
                        }
                    } else {
                        addLog(`âš ï¸ æ–‡ä»¶ä¸å­˜åœ¨: ${file}`, 'error');
                    }
                } catch (error) {
                    addLog(`âŒ åŠ è½½å¤±è´¥: ${file} - ${error.message}`, 'error');
                }
                
                updateStatus();
                // ç»™UIä¸€ç‚¹æ—¶é—´æ›´æ–°
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            isLoading = false;
            updateStatus();
            
            if (questions.length > 0) {
                addLog(`ğŸ‰ åŠ è½½å®Œæˆï¼æ€»å…±: ${questions.length} é“é¢˜ç›®`, 'success');
                
                // æ‰“ä¹±é¢˜ç›®é¡ºåº
                questions = shuffleArray(questions);
                addLog('é¢˜ç›®é¡ºåºå·²æ‰“ä¹±', 'info');
            } else {
                addLog('âŒ æ²¡æœ‰åŠ è½½åˆ°ä»»ä½•é¢˜ç›®', 'error');
            }
        }
        
        // æ‰“ä¹±æ•°ç»„
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // ============ ç»ƒä¹ åŠŸèƒ½ ============
        function startPractice() {
            if (questions.length === 0) {
                alert('è¯·å…ˆåŠ è½½é¢˜åº“');
                return;
            }
            
            // åˆ›å»ºç®€å•çš„ç»ƒä¹ ç•Œé¢
            createPracticeInterface();
        }
        
        function openFullscreen() {
            if (questions.length === 0) {
                alert('è¯·å…ˆåŠ è½½é¢˜åº“');
                return;
            }
            
            // åˆ›å»ºå…¨å±ç»ƒä¹ ç•Œé¢
            createFullscreenInterface();
        }
        
        function createPracticeInterface() {
            const practiceModal = document.createElement('div');
            practiceModal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; color: #333; border-radius: 15px; padding: 30px; max-width: 600px; width: 90%;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3>é¢˜åº“ç»ƒä¹  - ç¬¬ ${currentIndex + 1} é¢˜ / ${questions.length}</h3>
                            <button onclick="closePractice()" style="background: #ff6b6b; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">å…³é—­</button>
                        </div>
                        <div style="margin-bottom: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px; font-size: 1.1em; line-height: 1.6;">
                            ${questions[currentIndex].title}
                        </div>
                        <div id="options-container">
                            ${questions[currentIndex].options.map((option, index) => 
                                `<div onclick="selectAnswer(${index})" style="padding: 15px; margin: 10px 0; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s;" id="option-${index}">
                                    <strong>${String.fromCharCode(65 + index)}.</strong> ${option}
                                </div>`
                            ).join('')}
                        </div>
                        <div style="margin-top: 20px; text-align: center;">
                            <button onclick="previousQuestion()" ${currentIndex === 0 ? 'disabled' : ''} style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin: 0 10px; cursor: pointer;">ä¸Šä¸€é¢˜</button>
                            <button onclick="nextQuestion()" style="background: #51cf66; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin: 0 10px; cursor: pointer;">ä¸‹ä¸€é¢˜</button>
                        </div>
                    </div>
                </div>
            `;
            practiceModal.id = 'practice-modal';
            document.body.appendChild(practiceModal);
        }
        
        function createFullscreenInterface() {
            const fullscreenModal = document.createElement('div');
            fullscreenModal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); z-index: 10000; color: white; padding: 20px; overflow-y: auto;">
                    <div style="max-width: 1200px; margin: 0 auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                            <h2><i class="fas fa-expand"></i> å…¨å±ç»ƒä¹ æ¨¡å¼</h2>
                            <button onclick="closeFullscreen()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-times"></i> é€€å‡ºå…¨å±
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                                <div style="font-size: 2em; font-weight: bold;">${questions.length}</div>
                                <div>æ€»é¢˜æ•°</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                                <div style="font-size: 2em; font-weight: bold;">${currentIndex + 1}</div>
                                <div>å½“å‰é¢˜ç›®</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                                <div style="font-size: 2em; font-weight: bold;">${((currentIndex + 1) / questions.length * 100).toFixed(1)}%</div>
                                <div>è¿›åº¦</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
                                <div style="font-size: 2em; font-weight: bold;">${questions[currentIndex].bank}</div>
                                <div>é¢˜åº“æ¥æº</div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 30px; margin-bottom: 20px;">
                            <div style="font-size: 1.3em; line-height: 1.6; margin-bottom: 30px;">
                                ${questions[currentIndex].title}
                            </div>
                            <div id="fullscreen-options">
                                ${questions[currentIndex].options.map((option, index) => 
                                    `<div onclick="selectFullscreenAnswer(${index})" style="padding: 20px; margin: 15px 0; background: rgba(255,255,255,0.1); border: 2px solid transparent; border-radius: 12px; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 15px;" id="fs-option-${index}">
                                        <div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                            ${String.fromCharCode(65 + index)}
                                        </div>
                                        <div style="flex: 1;">${option}</div>
                                    </div>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="previousQuestion()" ${currentIndex === 0 ? 'disabled' : ''} style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 15px 30px; border-radius: 8px; margin: 0 10px; cursor: pointer; font-size: 16px;">
                                <i class="fas fa-chevron-left"></i> ä¸Šä¸€é¢˜
                            </button>
                            <button onclick="nextQuestion()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 15px 30px; border-radius: 8px; margin: 0 10px; cursor: pointer; font-size: 16px;">
                                ä¸‹ä¸€é¢˜ <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            fullscreenModal.id = 'fullscreen-modal';
            document.body.appendChild(fullscreenModal);
        }
        
        // ============ å¯¼èˆªåŠŸèƒ½ ============
        function nextQuestion() {
            if (currentIndex < questions.length - 1) {
                currentIndex++;
                updatePracticeInterface();
            }
        }
        
        function previousQuestion() {
            if (currentIndex > 0) {
                currentIndex--;
                updatePracticeInterface();
            }
        }
        
        function updatePracticeInterface() {
            const practiceModal = document.getElementById('practice-modal');
            const fullscreenModal = document.getElementById('fullscreen-modal');
            
            if (practiceModal) {
                closePractice();
                createPracticeInterface();
            }
            
            if (fullscreenModal) {
                closeFullscreen();
                createFullscreenInterface();
            }
        }
        
        function selectAnswer(index) {
            // é‡ç½®æ‰€æœ‰é€‰é¡¹æ ·å¼
            questions[currentIndex].options.forEach((_, i) => {
                const option = document.getElementById(`option-${i}`);
                if (option) {
                    option.style.background = '#f8f9fa';
                    option.style.borderColor = '#e9ecef';
                    option.style.color = '#333';
                }
            });
            
            // é«˜äº®é€‰ä¸­çš„é€‰é¡¹
            const selectedOption = document.getElementById(`option-${index}`);
            if (selectedOption) {
                selectedOption.style.background = '#667eea';
                selectedOption.style.borderColor = '#667eea';
                selectedOption.style.color = 'white';
            }
        }
        
        function selectFullscreenAnswer(index) {
            // é‡ç½®æ‰€æœ‰é€‰é¡¹æ ·å¼
            questions[currentIndex].options.forEach((_, i) => {
                const option = document.getElementById(`fs-option-${i}`);
                if (option) {
                    option.style.background = 'rgba(255,255,255,0.1)';
                    option.style.borderColor = 'transparent';
                }
            });
            
            // é«˜äº®é€‰ä¸­çš„é€‰é¡¹
            const selectedOption = document.getElementById(`fs-option-${index}`);
            if (selectedOption) {
                selectedOption.style.background = 'rgba(255,255,255,0.3)';
                selectedOption.style.borderColor = 'rgba(255,255,255,0.5)';
            }
        }
        
        function closePractice() {
            const modal = document.getElementById('practice-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function closeFullscreen() {
            const modal = document.getElementById('fullscreen-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        // ============ åˆå§‹åŒ– ============
        document.addEventListener('DOMContentLoaded', function() {
            addLog('é¡µé¢åŠ è½½å®Œæˆï¼Œå¯ä»¥å¼€å§‹åŠ è½½é¢˜åº“', 'success');
            updateStatus();
        });
    </script>
</body>
</html> 