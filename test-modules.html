<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡å—æµ‹è¯• - æµä½“åŠ›å­¦å­¦ä¹ å¹³å°</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            margin: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .module-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 8px;
            border-left: 4px solid #4facfe;
        }
        
        .module-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 15px;
        }
        
        .status-loaded { background: #10b981; }
        .status-missing { background: #ef4444; }
        
        .module-info {
            flex: 1;
        }
        
        .module-name {
            font-weight: bold;
            color: #4facfe;
        }
        
        .module-desc {
            font-size: 0.9rem;
            color: #6c7b7f;
            margin-top: 4px;
        }
        
        button {
            background: #4facfe;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        
        button:hover {
            background: #0084ff;
        }
        
        .log {
            background: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 20px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ¨¡å—æµ‹è¯•å·¥å…·</h1>
        
        <div class="test-section">
            <h3>æ¨¡å—åŠ è½½çŠ¶æ€</h3>
            <div id="module-list"></div>
        </div>
        
        <div class="test-section">
            <h3>åŠŸèƒ½æµ‹è¯•</h3>
            <button onclick="testAuth()">æµ‹è¯•è®¤è¯ç³»ç»Ÿ</button>
            <button onclick="testEventBus()">æµ‹è¯•äº‹ä»¶æ€»çº¿</button>
            <button onclick="testUtils()">æµ‹è¯•å·¥å…·å‡½æ•°</button>
            <button onclick="testConfig()">æµ‹è¯•é…ç½®ç³»ç»Ÿ</button>
            <button onclick="testApp()">æµ‹è¯•åº”ç”¨åˆå§‹åŒ–</button>
        </div>
        
        <div class="test-section">
            <h3>æ§åˆ¶å°æ—¥å¿—</h3>
            <div id="log" class="log"></div>
        </div>
    </div>

    <!-- åŠ è½½æ‰€æœ‰æ¨¡å— -->
    <script src="js/core/config.js"></script>
    <script src="js/core/utils.js"></script>
    <script src="js/core/eventBus.js"></script>
    <script src="js/auth/auth.js"></script>
    <script src="js/storage/githubStorage.js"></script>
    <script src="js/components/questionBank.js"></script>
    <script src="js/components/aiAssistant.js"></script>
    <script src="js/app.js"></script>

    <script>
        const logElement = document.getElementById('log');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }
        
        function checkModules() {
            const modules = [
                { name: 'AppConfig', desc: 'åº”ç”¨é…ç½®ç³»ç»Ÿ' },
                { name: 'Utils', desc: 'å·¥å…·å‡½æ•°åº“' },
                { name: 'EventBus', desc: 'äº‹ä»¶æ€»çº¿ç³»ç»Ÿ' },
                { name: 'SystemEvents', desc: 'ç³»ç»Ÿäº‹ä»¶å®šä¹‰' },
                { name: 'AuthSystem', desc: 'è®¤è¯ç³»ç»Ÿ' },
                { name: 'GitHubStorage', desc: 'GitHubå­˜å‚¨ç³»ç»Ÿ' },
                { name: 'LocalQuestionBank', desc: 'æœ¬åœ°é¢˜åº“ç³»ç»Ÿ' },
                { name: 'IntelligentAIAssistant', desc: 'AIåŠ©æ‰‹ç³»ç»Ÿ' },
                { name: 'App', desc: 'ä¸»åº”ç”¨ç³»ç»Ÿ' }
            ];
            
            const moduleList = document.getElementById('module-list');
            let html = '';
            
            modules.forEach(module => {
                const isLoaded = !!window[module.name];
                const statusClass = isLoaded ? 'status-loaded' : 'status-missing';
                const statusText = isLoaded ? 'å·²åŠ è½½' : 'æœªåŠ è½½';
                
                html += `
                    <div class="module-item">
                        <span class="module-status ${statusClass}"></span>
                        <div class="module-info">
                            <div class="module-name">${module.name}</div>
                            <div class="module-desc">${module.desc} - ${statusText}</div>
                        </div>
                    </div>
                `;
                
                log(`${module.name}: ${statusText}`);
            });
            
            moduleList.innerHTML = html;
        }
        
        function testAuth() {
            log('ğŸ§ª æµ‹è¯•è®¤è¯ç³»ç»Ÿ...');
            if (window.AuthSystem) {
                log('âœ… AuthSystem å·²åŠ è½½');
                log(`è®¤è¯çŠ¶æ€: ${AuthSystem.isAuthenticated()}`);
                
                // æµ‹è¯•ç™»å½•
                AuthSystem.login('admin', 'Admin123!').then(result => {
                    log(`ç™»å½•æµ‹è¯•ç»“æœ: ${JSON.stringify(result)}`);
                }).catch(error => {
                    log(`ç™»å½•æµ‹è¯•é”™è¯¯: ${error.message}`);
                });
            } else {
                log('âŒ AuthSystem æœªåŠ è½½');
            }
        }
        
        function testEventBus() {
            log('ğŸ§ª æµ‹è¯•äº‹ä»¶æ€»çº¿...');
            if (window.EventBus) {
                log('âœ… EventBus å·²åŠ è½½');
                
                // æµ‹è¯•äº‹ä»¶ç›‘å¬
                EventBus.on('test-event', (data) => {
                    log(`æ”¶åˆ°æµ‹è¯•äº‹ä»¶: ${JSON.stringify(data)}`);
                });
                
                // æµ‹è¯•äº‹ä»¶å‘é€
                EventBus.emit('test-event', { message: 'Hello from test!' });
            } else {
                log('âŒ EventBus æœªåŠ è½½');
            }
        }
        
        function testUtils() {
            log('ğŸ§ª æµ‹è¯•å·¥å…·å‡½æ•°...');
            if (window.Utils) {
                log('âœ… Utils å·²åŠ è½½');
                log(`å­˜å‚¨æµ‹è¯•: ${Utils.storage.set('test', 'value')}`);
                log(`è¯»å–æµ‹è¯•: ${Utils.storage.get('test')}`);
            } else {
                log('âŒ Utils æœªåŠ è½½');
            }
        }
        
        function testConfig() {
            log('ğŸ§ª æµ‹è¯•é…ç½®ç³»ç»Ÿ...');
            if (window.AppConfig) {
                log('âœ… AppConfig å·²åŠ è½½');
                log(`APIé…ç½®: ${JSON.stringify(AppConfig.api)}`);
            } else {
                log('âŒ AppConfig æœªåŠ è½½');
            }
        }
        
        function testApp() {
            log('ğŸ§ª æµ‹è¯•åº”ç”¨åˆå§‹åŒ–...');
            if (window.App) {
                log('âœ… App å·²åŠ è½½');
                log(`AppçŠ¶æ€: ${JSON.stringify(App.getAppState ? App.getAppState() : 'getAppStateæ–¹æ³•ä¸å­˜åœ¨')}`);
            } else {
                log('âŒ App æœªåŠ è½½');
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ¨¡å—
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸ”§ æ¨¡å—æµ‹è¯•å·¥å…·å·²åŠ è½½');
            log('å½“å‰URL: ' + window.location.href);
            
            // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å®Œæˆ
            setTimeout(() => {
                checkModules();
                log('ğŸ“‹ æ¨¡å—æ£€æŸ¥å®Œæˆ');
            }, 1000);
        });
        
        // ç›‘å¬é”™è¯¯
        window.addEventListener('error', (event) => {
            log(`âŒ è„šæœ¬é”™è¯¯: ${event.message} at ${event.filename}:${event.lineno}`);
        });
        
        // ç›‘å¬æœªå¤„ç†çš„Promiseæ‹’ç»
        window.addEventListener('unhandledrejection', (event) => {
            log(`âŒ Promiseé”™è¯¯: ${event.reason}`);
        });
    </script>
</body>
</html> 